module.exports=[210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},48319,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(30118),f=a.i(91119),g=a.i(86304),h=a.i(99570),i=a.i(96221),j=a.i(210),k=a.i(3314),l=a.i(6015),m=a.i(80701),n=a.i(38246),o=a.i(56711),p=a.i(35249);let q=["Critical","High","Medium","Low"],r=["LingeringOAuthGrant","LingeringASP","PostOffboardLogin","PostOffboardSuspiciousLogin","AdminMFAWeak","DWDHighRisk","OffboardingNotEnforced"],s={Critical:"destructive",High:"outline",Medium:"default",Low:"secondary"};function t({severity:a}){let c=s[a]??"secondary";return(0,b.jsx)(g.Badge,{variant:c,className:"High"===a?"bg-orange-500/90 text-white border-orange-600":"Medium"===a?"bg-yellow-500/90 text-black border-yellow-600":"Low"===a?"bg-gray-500/90 text-white border-gray-600":void 0,children:a})}function u({findingId:a}){let{data:c,isLoading:d}=(0,e.useFindingDetail)(a),m=(0,e.useRemediateFinding)();return d?(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(i.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):c?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(n.default,{href:"/findings",children:(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(j.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back to Findings"]})}),!c.closed_at&&(0,b.jsxs)(h.Button,{variant:"destructive",onClick:()=>m.mutate(c.name),disabled:m.isPending,children:[m.isPending?(0,b.jsx)(i.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(k.Shield,{className:"mr-2 h-4 w-4"}),"Remediate Finding"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:c.name}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Finding detail"})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Finding Info"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Type"}),(0,b.jsx)("p",{className:"font-medium",children:c.finding_type})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Severity"}),(0,b.jsx)("p",{children:(0,b.jsx)(t,{severity:c.severity})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Status"}),(0,b.jsx)("p",{children:(0,b.jsx)(g.Badge,{variant:c.closed_at?"secondary":"default",children:c.closed_at?"Closed":"Open"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Case"}),(0,b.jsx)("p",{children:(0,b.jsx)(n.default,{href:`/cases/${c.case}`,className:"text-primary hover:underline",children:c.case})})]})]})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Summary"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("p",{className:"text-sm leading-relaxed",children:c.summary})})]}),c.recommended_action&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Recommended Action"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("p",{className:"text-sm leading-relaxed",children:c.recommended_action})})]}),c.evidence&&c.evidence.length>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Evidence"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{children:(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableHead,{children:"Type"}),(0,b.jsx)(l.TableHead,{children:"Detail"})]})}),(0,b.jsx)(l.TableBody,{children:c.evidence.map(a=>(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableCell,{className:"font-medium",children:a.evidence_type}),(0,b.jsx)(l.TableCell,{children:a.detail})]},a.name))})]})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Metadata"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Created"}),(0,b.jsx)("p",{children:c.creation?(0,o.format)(new Date(c.creation),"PPp"):"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Last Modified"}),(0,b.jsx)("p",{children:c.modified?(0,o.format)(new Date(c.modified),"PPp"):"-"})]}),c.closed_at&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Closed At"}),(0,b.jsx)("p",{children:(0,o.format)(new Date(c.closed_at),"PPp")})]})]})})]})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(n.default,{href:"/findings",children:(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(j.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back to Findings"]})}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Finding not found: ",a]})]})}function v(){let a=(0,d.useRouter)(),{sortConfig:h,onSort:j,sortData:k}=(0,p.useSort)(),s=(0,d.useSearchParams)(),v=s.get("finding"),[w,x]=(0,c.useState)(s.get("severity")??"all"),[y,z]=(0,c.useState)(s.get("type")??"all"),A=(0,c.useMemo)(()=>{let a={};return w&&"all"!==w&&(a.severity=w),y&&"all"!==y&&(a.finding_type=y),Object.keys(a).length?a:void 0},[w,y]),{data:B,isLoading:C}=(0,e.useFindings)(A);return v?(0,b.jsx)(u,{findingId:v}):C?(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(i.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Findings"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Policy violations and security gaps from scans"})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsx)(f.CardTitle,{className:"text-base",children:"All Findings"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(m.Select,{value:w,onValueChange:x,children:[(0,b.jsx)(m.SelectTrigger,{className:"w-[120px]",children:(0,b.jsx)(m.SelectValue,{placeholder:"Severity"})}),(0,b.jsxs)(m.SelectContent,{children:[(0,b.jsx)(m.SelectItem,{value:"all",children:"All severity"}),q.map(a=>(0,b.jsx)(m.SelectItem,{value:a,children:a},a))]})]}),(0,b.jsxs)(m.Select,{value:y,onValueChange:z,children:[(0,b.jsx)(m.SelectTrigger,{className:"w-[180px]",children:(0,b.jsx)(m.SelectValue,{placeholder:"Type"})}),(0,b.jsxs)(m.SelectContent,{children:[(0,b.jsx)(m.SelectItem,{value:"all",children:"All types"}),r.map(a=>(0,b.jsx)(m.SelectItem,{value:a,children:a},a))]})]})]})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{children:(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(p.SortableTableHead,{column:"name",label:"Name",sortConfig:h,onSort:j}),(0,b.jsx)(p.SortableTableHead,{column:"case",label:"Case",sortConfig:h,onSort:j}),(0,b.jsx)(p.SortableTableHead,{column:"finding_type",label:"Type",sortConfig:h,onSort:j}),(0,b.jsx)(p.SortableTableHead,{column:"severity",label:"Severity",sortConfig:h,onSort:j}),(0,b.jsx)(p.SortableTableHead,{column:"summary",label:"Summary",sortConfig:h,onSort:j}),(0,b.jsx)(p.SortableTableHead,{column:"closed_at",label:"Status",sortConfig:h,onSort:j}),(0,b.jsx)(p.SortableTableHead,{column:"creation",label:"Created",sortConfig:h,onSort:j})]})}),(0,b.jsx)(l.TableBody,{children:(B?k(B):[]).map(c=>(0,b.jsxs)(l.TableRow,{className:"cursor-pointer",onClick:()=>a.push(`/findings?finding=${encodeURIComponent(c.name)}`),children:[(0,b.jsx)(l.TableCell,{className:"font-medium",children:(0,b.jsx)(n.default,{href:`/findings?finding=${encodeURIComponent(c.name)}`,className:"text-primary hover:underline",onClick:a=>a.stopPropagation(),children:c.name})}),(0,b.jsx)(l.TableCell,{children:(0,b.jsx)(n.default,{href:`/cases/${c.case}`,className:"text-primary hover:underline",onClick:a=>a.stopPropagation(),children:c.case})}),(0,b.jsx)(l.TableCell,{children:c.finding_type}),(0,b.jsx)(l.TableCell,{children:(0,b.jsx)(t,{severity:c.severity})}),(0,b.jsx)(l.TableCell,{className:"max-w-md truncate",children:c.summary}),(0,b.jsx)(l.TableCell,{children:(0,b.jsx)(g.Badge,{variant:c.closed_at?"secondary":"default",children:c.closed_at?"Closed":"Open"})}),(0,b.jsx)(l.TableCell,{children:c.creation?(0,o.format)(new Date(c.creation),"PP"):"-"})]},c.name))})]})})]})]})}function w(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(i.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),children:(0,b.jsx)(v,{})})}a.s(["default",()=>w])}];

//# sourceMappingURL=_7e8990b1._.js.map