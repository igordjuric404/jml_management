module.exports=[22063,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(30118),g=a.i(91119),h=a.i(99570),i=a.i(86304),j=a.i(6015),k=a.i(187),l=a.i(7554),m=a.i(50104),n=a.i(24050),o=a.i(77192),p=a.i(30553),q=a.i(7827),r=a.i(25152),s=a.i(92843),t="Tabs",[u,v]=(0,m.createContextScope)(t,[n.createRovingFocusGroupScope]),w=(0,n.createRovingFocusGroupScope)(),[x,y]=u(t),z=c.forwardRef((a,c)=>{let{__scopeTabs:d,value:e,onValueChange:f,defaultValue:g,orientation:h="horizontal",dir:i,activationMode:j="automatic",...k}=a,l=(0,q.useDirection)(i),[m,n]=(0,r.useControllableState)({prop:e,onChange:f,defaultProp:g??"",caller:t});return(0,b.jsx)(x,{scope:d,baseId:(0,s.useId)(),value:m,onValueChange:n,orientation:h,dir:l,activationMode:j,children:(0,b.jsx)(p.Primitive.div,{dir:l,"data-orientation":h,...k,ref:c})})});z.displayName=t;var A="TabsList",B=c.forwardRef((a,c)=>{let{__scopeTabs:d,loop:e=!0,...f}=a,g=y(A,d),h=w(d);return(0,b.jsx)(n.Root,{asChild:!0,...h,orientation:g.orientation,dir:g.dir,loop:e,children:(0,b.jsx)(p.Primitive.div,{role:"tablist","aria-orientation":g.orientation,...f,ref:c})})});B.displayName=A;var C="TabsTrigger",D=c.forwardRef((a,c)=>{let{__scopeTabs:d,value:e,disabled:f=!1,...g}=a,h=y(C,d),i=w(d),j=G(h.baseId,e),k=H(h.baseId,e),m=e===h.value;return(0,b.jsx)(n.Item,{asChild:!0,...i,focusable:!f,active:m,children:(0,b.jsx)(p.Primitive.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":k,"data-state":m?"active":"inactive","data-disabled":f?"":void 0,disabled:f,id:j,...g,ref:c,onMouseDown:(0,l.composeEventHandlers)(a.onMouseDown,a=>{f||0!==a.button||!1!==a.ctrlKey?a.preventDefault():h.onValueChange(e)}),onKeyDown:(0,l.composeEventHandlers)(a.onKeyDown,a=>{[" ","Enter"].includes(a.key)&&h.onValueChange(e)}),onFocus:(0,l.composeEventHandlers)(a.onFocus,()=>{let a="manual"!==h.activationMode;m||f||!a||h.onValueChange(e)})})})});D.displayName=C;var E="TabsContent",F=c.forwardRef((a,d)=>{let{__scopeTabs:e,value:f,forceMount:g,children:h,...i}=a,j=y(E,e),k=G(j.baseId,f),l=H(j.baseId,f),m=f===j.value,n=c.useRef(m);return c.useEffect(()=>{let a=requestAnimationFrame(()=>n.current=!1);return()=>cancelAnimationFrame(a)},[]),(0,b.jsx)(o.Presence,{present:g||m,children:({present:c})=>(0,b.jsx)(p.Primitive.div,{"data-state":m?"active":"inactive","data-orientation":j.orientation,role:"tabpanel","aria-labelledby":k,hidden:!c,id:l,tabIndex:0,...i,ref:d,style:{...a.style,animationDuration:n.current?"0s":void 0},children:c&&h})})});function G(a,b){return`${a}-trigger-${b}`}function H(a,b){return`${a}-content-${b}`}F.displayName=E,a.s(["Content",()=>F,"List",()=>B,"Root",()=>z,"Tabs",()=>z,"TabsContent",()=>F,"TabsList",()=>B,"TabsTrigger",()=>D,"Trigger",()=>D,"createTabsScope",()=>v],44135);var I=a.i(44135),I=I,J=a.i(68114);function K({className:a,orientation:c="horizontal",...d}){return(0,b.jsx)(I.Root,{"data-slot":"tabs","data-orientation":c,orientation:c,className:(0,J.cn)("group/tabs flex gap-2 data-[orientation=horizontal]:flex-col",a),...d})}let L=(0,k.cva)("rounded-lg p-[3px] group-data-[orientation=horizontal]/tabs:h-9 data-[variant=line]:rounded-none group/tabs-list text-muted-foreground inline-flex w-fit items-center justify-center group-data-[orientation=vertical]/tabs:h-fit group-data-[orientation=vertical]/tabs:flex-col",{variants:{variant:{default:"bg-muted",line:"gap-1 bg-transparent"}},defaultVariants:{variant:"default"}});function M({className:a,variant:c="default",...d}){return(0,b.jsx)(I.List,{"data-slot":"tabs-list","data-variant":c,className:(0,J.cn)(L({variant:c}),a),...d})}function N({className:a,...c}){return(0,b.jsx)(I.Trigger,{"data-slot":"tabs-trigger",className:(0,J.cn)("focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring text-foreground/60 hover:text-foreground dark:text-muted-foreground dark:hover:text-foreground relative inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-all group-data-[orientation=vertical]/tabs:w-full group-data-[orientation=vertical]/tabs:justify-start focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 group-data-[variant=default]/tabs-list:data-[state=active]:shadow-sm group-data-[variant=line]/tabs-list:data-[state=active]:shadow-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4","group-data-[variant=line]/tabs-list:bg-transparent group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:border-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent","data-[state=active]:bg-background dark:data-[state=active]:text-foreground dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 data-[state=active]:text-foreground","after:bg-foreground after:absolute after:opacity-0 after:transition-opacity group-data-[orientation=horizontal]/tabs:after:inset-x-0 group-data-[orientation=horizontal]/tabs:after:bottom-[-5px] group-data-[orientation=horizontal]/tabs:after:h-0.5 group-data-[orientation=vertical]/tabs:after:inset-y-0 group-data-[orientation=vertical]/tabs:after:-right-1 group-data-[orientation=vertical]/tabs:after:w-0.5 group-data-[variant=line]/tabs-list:data-[state=active]:after:opacity-100",a),...c})}function O({className:a,...c}){return(0,b.jsx)(I.Content,{"data-slot":"tabs-content",className:(0,J.cn)("flex-1 outline-none",a),...c})}var P=a.i(15055),Q=a.i(96221),R=a.i(87532),S=a.i(3314);let T=(0,a.i(70106).default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);var U=a.i(43108),V=a.i(56711);let W={Active:"destructive",Revoked:"secondary",Deleted:"secondary",Hidden:"secondary",Acknowledged:"secondary"},X={Critical:"destructive",High:"destructive",Medium:"default",Low:"secondary"},Y={Critical:"destructive",High:"destructive",Medium:"default",Low:"secondary"};function Z(){let a=(0,d.useParams)().id,{data:k,isLoading:l}=(0,f.useCaseDetail)(a),m=(0,f.useTriggerScan)(a),n=(0,f.useRemediation)(a),o=(0,f.useRunScheduledRemediation)(a),p=(0,f.useBulkRemediate)(a),[q,r]=(0,c.useState)(new Set),s=(0,c.useMemo)(()=>{var a;return k?.artifacts?[...(a=k.artifacts).tokens??[],...a.asps??[],...a.login_events??[],...a.other??[]]:[]},[k]).filter(a=>"Active"===a.status);if(l||!k)return(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(Q.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})});let{case:t,artifacts:u,findings:v,audit_logs:w}=k;return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:t.name}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Case detail"})]})}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{className:"text-base",children:"Case Info"})}),(0,b.jsxs)(g.CardContent,{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Employee"}),(0,b.jsx)("p",{children:(0,b.jsx)(e.default,{href:`/employees?employee=${encodeURIComponent(t.employee)}`,className:"text-primary hover:underline",children:t.employee_name})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Email"}),(0,b.jsx)("p",{children:(0,b.jsx)(e.default,{href:`/employees?email=${encodeURIComponent(t.primary_email)}`,className:"text-primary hover:underline",children:t.primary_email})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Status"}),(0,b.jsx)("p",{children:(0,b.jsx)(i.Badge,{variant:"secondary",children:t.status})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Effective Date"}),(0,b.jsx)("p",{children:t.effective_date?(0,V.format)(new Date(t.effective_date),"PP"):"-"})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 pt-4",children:[(0,b.jsxs)(h.Button,{size:"sm",variant:"outline",onClick:()=>m.mutate(),disabled:m.isPending,children:[m.isPending?(0,b.jsx)(Q.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(R.Search,{className:"mr-2 h-4 w-4"}),"Scan"]}),(0,b.jsxs)(h.Button,{size:"sm",variant:"destructive",onClick:()=>{confirm("Execute full remediation bundle? (Revoke tokens, delete ASPs, sign out)")&&n.mutate({action:"full_bundle"})},disabled:n.isPending,children:[n.isPending?(0,b.jsx)(Q.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(S.Shield,{className:"mr-2 h-4 w-4"}),"Remediate (full bundle)"]}),(0,b.jsxs)(h.Button,{size:"sm",variant:"outline",onClick:()=>o.mutate(),disabled:o.isPending,children:[o.isPending?(0,b.jsx)(Q.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(T,{className:"mr-2 h-4 w-4"}),"Run Scheduled Now"]})]})]})]}),(0,b.jsxs)(K,{defaultValue:"artifacts",children:[(0,b.jsxs)(M,{children:[(0,b.jsxs)(N,{value:"artifacts",children:["Artifacts (",u.total??0,")"]}),(0,b.jsxs)(N,{value:"findings",children:["Findings (",v?.length??0,")"]}),(0,b.jsx)(N,{value:"audit",children:"Audit Log"})]}),(0,b.jsxs)(O,{value:"artifacts",className:"space-y-4",children:[s.length>0&&(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)(h.Button,{size:"sm",variant:"destructive",onClick:()=>{let a=Array.from(q);0!==a.length&&p.mutate(a,{onSuccess:()=>r(new Set)})},disabled:0===q.size||p.isPending,children:[p.isPending?(0,b.jsx)(Q.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(U.Lock,{className:"mr-2 h-4 w-4"}),"Bulk Remediate (",q.size," selected)"]})}),(0,b.jsx)($,{artifacts:u,selectedArtifacts:q,onToggle:a=>{r(b=>{let c=new Set(b);return c.has(a)?c.delete(a):c.add(a),c})},onToggleAllInGroup:a=>{let b=a.every(a=>q.has(a));r(c=>{let d=new Set(c);return b?a.forEach(a=>d.delete(a)):a.forEach(a=>d.add(a)),d})}})]}),(0,b.jsx)(O,{value:"findings",children:(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"Name"}),(0,b.jsx)(j.TableHead,{children:"Type"}),(0,b.jsx)(j.TableHead,{children:"Severity"}),(0,b.jsx)(j.TableHead,{children:"Status"}),(0,b.jsx)(j.TableHead,{children:"Summary"})]})}),(0,b.jsx)(j.TableBody,{children:v?.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{className:"font-medium",children:(0,b.jsx)(e.default,{href:`/findings?finding=${encodeURIComponent(a.name)}`,className:"text-primary hover:underline",children:a.name})}),(0,b.jsx)(j.TableCell,{children:a.finding_type}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(i.Badge,{variant:X[a.severity]??"secondary",children:a.severity})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(i.Badge,{variant:a.closed_at?"secondary":"default",children:a.closed_at?"Closed":"Open"})}),(0,b.jsx)(j.TableCell,{className:"max-w-xs truncate",children:a.summary})]},a.name))})]})})})}),(0,b.jsx)(O,{value:"audit",children:(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"Name"}),(0,b.jsx)(j.TableHead,{children:"Action Type"}),(0,b.jsx)(j.TableHead,{children:"Actor"}),(0,b.jsx)(j.TableHead,{children:"Result"}),(0,b.jsx)(j.TableHead,{children:"Timestamp"})]})}),(0,b.jsx)(j.TableBody,{children:w?.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{className:"font-medium",children:a.name}),(0,b.jsx)(j.TableCell,{children:a.action_type}),(0,b.jsx)(j.TableCell,{children:a.actor_user}),(0,b.jsx)(j.TableCell,{children:a.result}),(0,b.jsx)(j.TableCell,{children:a.timestamp?(0,V.format)(new Date(a.timestamp),"PPp"):"-"})]},a.name))})]})})})})]})]})}function $({artifacts:a,selectedArtifacts:c,onToggle:d,onToggleAllInGroup:f}){let h=[{key:"tokens",label:"Tokens",list:a.tokens??[]},{key:"asps",label:"ASPs",list:a.asps??[]},{key:"logins",label:"Login Events",list:a.login_events??[]},{key:"other",label:"Other",list:a.other??[]}];return(0,b.jsx)("div",{className:"space-y-4",children:h.map(({key:a,label:h,list:k})=>{let l=k.filter(a=>"Active"===a.status);return k.length>0?(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{className:"text-base",children:h})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{className:"w-10",children:l.length>0&&(0,b.jsx)(P.Checkbox,{checked:l.every(a=>c.has(a.name)),onCheckedChange:()=>f(l.map(a=>a.name))})}),(0,b.jsx)(j.TableHead,{children:"Name"}),(0,b.jsx)(j.TableHead,{children:"Type"}),(0,b.jsx)(j.TableHead,{children:"Status"}),(0,b.jsx)(j.TableHead,{children:"App"}),(0,b.jsx)(j.TableHead,{children:"Risk"})]})}),(0,b.jsx)(j.TableBody,{children:k.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{children:"Active"===a.status&&(0,b.jsx)(P.Checkbox,{checked:c.has(a.name),onCheckedChange:()=>d(a.name)})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(e.default,{href:`/artifacts?artifact=${encodeURIComponent(a.name)}`,className:"text-primary hover:underline font-medium",children:a.name})}),(0,b.jsx)(j.TableCell,{children:a.artifact_type}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(i.Badge,{variant:W[a.status]??"secondary",children:a.status})}),(0,b.jsx)(j.TableCell,{children:a.client_id?(0,b.jsx)(e.default,{href:`/apps?client_id=${encodeURIComponent(a.client_id)}`,className:"text-primary hover:underline",children:a.app_display_name||a.client_id}):a.app_display_name||"-"}),(0,b.jsx)(j.TableCell,{children:a.risk_level?(0,b.jsx)(i.Badge,{variant:Y[a.risk_level]??"secondary",children:a.risk_level}):"-"})]},a.name))})]})})]},a):null})})}a.s(["default",()=>Z],22063)}];

//# sourceMappingURL=src_app_%28app%29_cases_%5Bid%5D_page_tsx_2903fa94._.js.map