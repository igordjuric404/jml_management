module.exports=[43108,a=>{"use strict";let b=(0,a.i(70106).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);a.s(["Lock",()=>b],43108)},15055,a=>{"use strict";var b=a.i(87924),c=a.i(6406),d=a.i(72131),e=a.i(70121),f=a.i(50104),g=a.i(7554),h=a.i(25152),i=a.i(77994),j=a.i(3688),k=a.i(77192),l=a.i(30553),m="Checkbox",[n,o]=(0,f.createContextScope)(m),[p,q]=n(m);function r(a){let{__scopeCheckbox:c,checked:e,children:f,defaultChecked:g,disabled:i,form:j,name:k,onCheckedChange:l,required:n,value:o="on",internal_do_not_use_render:q}=a,[r,s]=(0,h.useControllableState)({prop:e,defaultProp:g??!1,onChange:l,caller:m}),[t,u]=d.useState(null),[v,w]=d.useState(null),x=d.useRef(!1),y=!t||!!j||!!t.closest("form"),A={checked:r,disabled:i,setChecked:s,control:t,setControl:u,name:k,form:j,value:o,hasConsumerStoppedPropagationRef:x,required:n,defaultChecked:!z(g)&&g,isFormControl:y,bubbleInput:v,setBubbleInput:w};return(0,b.jsx)(p,{scope:c,...A,children:"function"==typeof q?q(A):f})}var s="CheckboxTrigger",t=d.forwardRef(({__scopeCheckbox:a,onKeyDown:c,onClick:f,...h},i)=>{let{control:j,value:k,disabled:m,checked:n,required:o,setControl:p,setChecked:r,hasConsumerStoppedPropagationRef:t,isFormControl:u,bubbleInput:v}=q(s,a),w=(0,e.useComposedRefs)(i,p),x=d.useRef(n);return d.useEffect(()=>{let a=j?.form;if(a){let b=()=>r(x.current);return a.addEventListener("reset",b),()=>a.removeEventListener("reset",b)}},[j,r]),(0,b.jsx)(l.Primitive.button,{type:"button",role:"checkbox","aria-checked":z(n)?"mixed":n,"aria-required":o,"data-state":A(n),"data-disabled":m?"":void 0,disabled:m,value:k,...h,ref:w,onKeyDown:(0,g.composeEventHandlers)(c,a=>{"Enter"===a.key&&a.preventDefault()}),onClick:(0,g.composeEventHandlers)(f,a=>{r(a=>!!z(a)||!a),v&&u&&(t.current=a.isPropagationStopped(),t.current||a.stopPropagation())})})});t.displayName=s;var u=d.forwardRef((a,c)=>{let{__scopeCheckbox:d,name:e,checked:f,defaultChecked:g,required:h,disabled:i,value:j,onCheckedChange:k,form:l,...m}=a;return(0,b.jsx)(r,{__scopeCheckbox:d,checked:f,defaultChecked:g,disabled:i,required:h,onCheckedChange:k,name:e,form:l,value:j,internal_do_not_use_render:({isFormControl:a})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(t,{...m,ref:c,__scopeCheckbox:d}),a&&(0,b.jsx)(y,{__scopeCheckbox:d})]})})});u.displayName=m;var v="CheckboxIndicator",w=d.forwardRef((a,c)=>{let{__scopeCheckbox:d,forceMount:e,...f}=a,g=q(v,d);return(0,b.jsx)(k.Presence,{present:e||z(g.checked)||!0===g.checked,children:(0,b.jsx)(l.Primitive.span,{"data-state":A(g.checked),"data-disabled":g.disabled?"":void 0,...f,ref:c,style:{pointerEvents:"none",...a.style}})})});w.displayName=v;var x="CheckboxBubbleInput",y=d.forwardRef(({__scopeCheckbox:a,...c},f)=>{let{control:g,hasConsumerStoppedPropagationRef:h,checked:k,defaultChecked:m,required:n,disabled:o,name:p,value:r,form:s,bubbleInput:t,setBubbleInput:u}=q(x,a),v=(0,e.useComposedRefs)(f,u),w=(0,i.usePrevious)(k),y=(0,j.useSize)(g);d.useEffect(()=>{if(!t)return;let a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,b=!h.current;if(w!==k&&a){let c=new Event("click",{bubbles:b});t.indeterminate=z(k),a.call(t,!z(k)&&k),t.dispatchEvent(c)}},[t,w,k,h]);let A=d.useRef(!z(k)&&k);return(0,b.jsx)(l.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:m??A.current,required:n,disabled:o,name:p,value:r,form:s,...c,tabIndex:-1,ref:v,style:{...c.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function z(a){return"indeterminate"===a}function A(a){return z(a)?"indeterminate":a?"checked":"unchecked"}y.displayName=x,a.s(["Checkbox",()=>u,"CheckboxIndicator",()=>w,"Indicator",()=>w,"Root",()=>u,"createCheckboxScope",()=>o,"unstable_BubbleInput",()=>y,"unstable_CheckboxBubbleInput",()=>y,"unstable_CheckboxProvider",()=>r,"unstable_CheckboxTrigger",()=>t,"unstable_Provider",()=>r,"unstable_Trigger",()=>t],62882);var B=a.i(62882),B=B,C=a.i(68114);function D({className:a,...d}){return(0,b.jsx)(B.Root,{"data-slot":"checkbox",className:(0,C.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...d,children:(0,b.jsx)(B.Indicator,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:(0,b.jsx)(c.CheckIcon,{className:"size-3.5"})})})}a.s(["Checkbox",()=>D],15055)},210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},39405,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(30118),f=a.i(91119),g=a.i(99570),h=a.i(86304),i=a.i(6015),j=a.i(80701),k=a.i(15055),l=a.i(96221),m=a.i(43108),n=a.i(210),o=a.i(38246),p=a.i(56711),q=a.i(35249);let r=["OAuthToken","ASP","LoginEvent","AdminMFA","DWDChange"],s=["Active","Hidden","Revoked","Deleted","Acknowledged"],t={Active:"destructive",Revoked:"secondary",Deleted:"secondary",Hidden:"secondary",Acknowledged:"secondary"},u={Critical:"destructive",High:"destructive",Medium:"default",Low:"secondary"};function v({artifactId:a}){let{data:c,isLoading:d}=(0,e.useArtifactDetail)(a);if(d)return(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(l.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(!c)return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(o.default,{href:"/artifacts",children:(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(n.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back to Artifacts"]})}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Artifact not found: ",a]})]});let i=c.scopes_json?JSON.parse(c.scopes_json):[],j=c.metadata_json?JSON.parse(c.metadata_json):null;return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsx)(o.default,{href:"/artifacts",children:(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(n.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back to Artifacts"]})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:c.name}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Artifact detail"})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Artifact Info"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Type"}),(0,b.jsx)("p",{className:"font-medium",children:c.artifact_type})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Status"}),(0,b.jsx)("p",{children:(0,b.jsx)(h.Badge,{variant:t[c.status]??"secondary",children:c.status})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Risk Level"}),(0,b.jsx)("p",{children:c.risk_level?(0,b.jsx)(h.Badge,{variant:u[c.risk_level]??"secondary",children:c.risk_level}):"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Case"}),(0,b.jsx)("p",{children:c.case?(0,b.jsx)(o.default,{href:`/cases/${c.case}`,className:"text-primary hover:underline",children:c.case}):"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Subject Email"}),(0,b.jsx)("p",{children:(0,b.jsx)(o.default,{href:`/employees?email=${encodeURIComponent(c.subject_email)}`,className:"text-primary hover:underline",children:c.subject_email})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"App"}),(0,b.jsx)("p",{children:c.client_id?(0,b.jsx)(o.default,{href:`/apps?client_id=${encodeURIComponent(c.client_id)}`,className:"text-primary hover:underline",children:c.app_display_name||c.client_id}):c.app_display_name||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Created"}),(0,b.jsx)("p",{children:c.creation?(0,p.format)(new Date(c.creation),"PPp"):"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Last Modified"}),(0,b.jsx)("p",{children:c.modified?(0,p.format)(new Date(c.modified),"PPp"):"-"})]})]})})]}),i.length>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"OAuth Scopes"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:i.map(a=>(0,b.jsx)(h.Badge,{variant:"outline",className:"text-xs font-mono",children:a},a))})})]}),j&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Metadata"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("pre",{className:"text-sm bg-muted rounded-md p-4 overflow-x-auto",children:JSON.stringify(j,null,2)})})]})]})}function w(){let a=(0,d.useRouter)(),{sortConfig:n,onSort:w,sortData:x}=(0,q.useSort)(),y=(0,d.useSearchParams)(),z=y.get("artifact"),[A,B]=(0,c.useState)(y.get("type")??"all"),[C,D]=(0,c.useState)(y.get("status")??"all"),[E,F]=(0,c.useState)(new Set),G=(0,c.useMemo)(()=>{let a={};return A&&"all"!==A&&(a.artifact_type=A),C&&"all"!==C&&(a.status=C),Object.keys(a).length?a:void 0},[A,C]),{data:H,isLoading:I}=(0,e.useArtifacts)(G),J=(0,e.useRemediateArtifacts)(),K=(0,c.useMemo)(()=>H?.filter(a=>"Active"===a.status)??[],[H]);return z?(0,b.jsx)(v,{artifactId:z}):I?(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(l.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Access Artifacts"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"OAuth tokens, ASPs, login events, and other access mechanisms"})]}),E.size>0&&(0,b.jsxs)(g.Button,{variant:"destructive",onClick:()=>{let a=Array.from(E);0!==a.length&&J.mutate(a,{onSuccess:()=>F(new Set)})},disabled:J.isPending,children:[J.isPending?(0,b.jsx)(l.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(m.Lock,{className:"mr-2 h-4 w-4"}),"Remediate (",E.size," selected)"]})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Artifacts"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(j.Select,{value:A,onValueChange:B,children:[(0,b.jsx)(j.SelectTrigger,{className:"w-[140px]",children:(0,b.jsx)(j.SelectValue,{placeholder:"Type"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"all",children:"All types"}),r.map(a=>(0,b.jsx)(j.SelectItem,{value:a,children:a},a))]})]}),(0,b.jsxs)(j.Select,{value:C,onValueChange:D,children:[(0,b.jsx)(j.SelectTrigger,{className:"w-[120px]",children:(0,b.jsx)(j.SelectValue,{placeholder:"Status"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"all",children:"All status"}),s.map(a=>(0,b.jsx)(j.SelectItem,{value:a,children:a},a))]})]})]})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{className:"w-10",children:(0,b.jsx)(k.Checkbox,{checked:K.length>0&&K.every(a=>E.has(a.name)),onCheckedChange:()=>{E.size===K.length?F(new Set):F(new Set(K.map(a=>a.name)))}})}),(0,b.jsx)(q.SortableTableHead,{column:"name",label:"Name",sortConfig:n,onSort:w}),(0,b.jsx)(q.SortableTableHead,{column:"case",label:"Case",sortConfig:n,onSort:w}),(0,b.jsx)(q.SortableTableHead,{column:"artifact_type",label:"Type",sortConfig:n,onSort:w}),(0,b.jsx)(q.SortableTableHead,{column:"subject_email",label:"Subject Email",sortConfig:n,onSort:w}),(0,b.jsx)(q.SortableTableHead,{column:"status",label:"Status",sortConfig:n,onSort:w}),(0,b.jsx)(q.SortableTableHead,{column:"app_display_name",label:"App Name",sortConfig:n,onSort:w}),(0,b.jsx)(q.SortableTableHead,{column:"risk_level",label:"Risk Level",sortConfig:n,onSort:w}),(0,b.jsx)(q.SortableTableHead,{column:"creation",label:"Created",sortConfig:n,onSort:w})]})}),(0,b.jsx)(i.TableBody,{children:(H?x(H):[]).map(c=>(0,b.jsxs)(i.TableRow,{className:"cursor-pointer",onClick:()=>a.push(`/artifacts?artifact=${encodeURIComponent(c.name)}`),children:[(0,b.jsx)(i.TableCell,{onClick:a=>a.stopPropagation(),children:"Active"===c.status&&(0,b.jsx)(k.Checkbox,{checked:E.has(c.name),onCheckedChange:()=>{var a;return a=c.name,void F(b=>{let c=new Set(b);return c.has(a)?c.delete(a):c.add(a),c})}})}),(0,b.jsx)(i.TableCell,{className:"font-medium",children:(0,b.jsx)(o.default,{href:`/artifacts?artifact=${encodeURIComponent(c.name)}`,className:"text-primary hover:underline",onClick:a=>a.stopPropagation(),children:c.name})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(o.default,{href:`/cases/${c.case}`,className:"text-primary hover:underline",onClick:a=>a.stopPropagation(),children:c.case})}),(0,b.jsx)(i.TableCell,{children:c.artifact_type}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(o.default,{href:`/employees?email=${encodeURIComponent(c.subject_email)}`,className:"text-primary hover:underline",onClick:a=>a.stopPropagation(),children:c.subject_email})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(h.Badge,{variant:t[c.status]??"secondary",children:c.status})}),(0,b.jsx)(i.TableCell,{children:c.client_id?(0,b.jsx)(o.default,{href:`/apps?client_id=${encodeURIComponent(c.client_id)}`,className:"text-primary hover:underline",onClick:a=>a.stopPropagation(),children:c.app_display_name||c.client_id}):c.app_display_name||"-"}),(0,b.jsx)(i.TableCell,{children:c.risk_level?(0,b.jsx)(h.Badge,{variant:u[c.risk_level]??"secondary",children:c.risk_level}):"-"}),(0,b.jsx)(i.TableCell,{children:c.creation?(0,p.format)(new Date(c.creation),"PP"):"-"})]},c.name))})]})})]})]})}function x(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(l.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),children:(0,b.jsx)(w,{})})}a.s(["default",()=>x])}];

//# sourceMappingURL=_725c804b._.js.map