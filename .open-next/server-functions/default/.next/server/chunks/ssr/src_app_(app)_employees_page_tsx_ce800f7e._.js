module.exports=[36701,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(30118),f=a.i(91119),g=a.i(99570),h=a.i(86304),i=a.i(6015),j=a.i(35732),k=a.i(15055),l=a.i(96221),m=a.i(210),n=a.i(3314),o=a.i(43108);let p=(0,a.i(70106).default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);var q=a.i(5784),r=a.i(46842),s=a.i(38246),t=a.i(11619),u=a.i(35249);function v(){let a=(0,d.useRouter)(),{sortConfig:v,onSort:w,sortData:x}=(0,u.useSort)(),y=(0,d.useSearchParams)(),z=y.get("employee"),A=y.get("email"),{data:B,isLoading:C}=(0,e.useEmployees)(),D=(0,c.useMemo)(()=>{if(z)return z;if(A&&B){let a=B.find(a=>a.company_email?.toLowerCase()===A.toLowerCase());return a?.employee_id??null}return null},[z,A,B]),{data:E,isLoading:F}=(0,e.useEmployeeDetail)(D??""),G=(0,e.useRevokeEmployeeAccess)(D??""),[H,I]=(0,c.useState)(new Set),J=!!D&&(F||E);return C&&!J?(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(l.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):J&&E?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(s.default,{href:"/employees",children:(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(m.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back to Employees"]})}),(0,b.jsxs)(g.Button,{variant:"destructive",onClick:()=>{(0,t.confirmAction)({title:"Revoke All Access",description:`Revoke all access for ${E.employee.name}? This will remediate all cases and close all findings. This action cannot be undone.`,confirmLabel:"Revoke All Access",onConfirm:()=>G.mutate("all")})},disabled:G.isPending,children:[G.isPending?(0,b.jsx)(l.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(n.Shield,{className:"mr-2 h-4 w-4"}),"Revoke All Access"]})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Employee Info"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Name"}),(0,b.jsx)("p",{className:"font-medium",children:E.employee.name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Email"}),(0,b.jsx)("p",{children:(0,b.jsx)(s.default,{href:`/employees?email=${encodeURIComponent(E.employee.email)}`,className:"text-primary hover:underline",children:E.employee.email})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Status"}),(0,b.jsx)("p",{children:(0,b.jsx)(h.Badge,{variant:"Active"===E.employee.status?"default":"destructive",className:"Active"===E.employee.status?"bg-green-600 text-white":void 0,children:E.employee.status})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Department"}),(0,b.jsx)("p",{children:E.employee.department||"-"})]})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"pt-6",children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:E.summary.total_cases}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cases"})]})}),(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"pt-6",children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:E.summary.active_artifacts}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Active Artifacts"})]})}),(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"pt-6",children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:E.summary.open_findings}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Open Findings"})]})}),(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"pt-6",children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:E.summary.apps_used}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Apps Used"})]})})]}),(E.cases?.length??0)>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Associated Cases"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{children:"Case"}),(0,b.jsx)(i.TableHead,{children:"Status"}),(0,b.jsx)(i.TableHead,{children:"Effective Date"})]})}),(0,b.jsx)(i.TableBody,{children:E.cases?.map(a=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(s.default,{href:`/cases/${a.name}`,className:"text-primary hover:underline font-medium",children:a.name})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(h.Badge,{variant:"secondary",children:a.status})}),(0,b.jsx)(i.TableCell,{children:a.effective_date?new Date(a.effective_date).toLocaleDateString():"-"})]},a.name))})]})})]}),(E.findings?.length??0)>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Findings"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{children:"Name"}),(0,b.jsx)(i.TableHead,{children:"Type"}),(0,b.jsx)(i.TableHead,{children:"Severity"}),(0,b.jsx)(i.TableHead,{children:"Status"}),(0,b.jsx)(i.TableHead,{children:"Summary"})]})}),(0,b.jsx)(i.TableBody,{children:E.findings?.map(a=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(s.default,{href:`/findings?finding=${encodeURIComponent(a.name)}`,className:"text-primary hover:underline font-medium",children:a.name})}),(0,b.jsx)(i.TableCell,{children:a.finding_type}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(h.Badge,{variant:"destructive",children:a.severity})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(h.Badge,{variant:a.closed_at?"secondary":"default",children:a.closed_at?"Closed":"Open"})}),(0,b.jsx)(i.TableCell,{className:"max-w-xs truncate",children:a.summary})]},a.name))})]})})]}),(E.artifacts?.length??0)>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Access Artifacts"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{children:"Name"}),(0,b.jsx)(i.TableHead,{children:"Type"}),(0,b.jsx)(i.TableHead,{children:"App"}),(0,b.jsx)(i.TableHead,{children:"Status"}),(0,b.jsx)(i.TableHead,{children:"Risk"})]})}),(0,b.jsx)(i.TableBody,{children:E.artifacts?.map(a=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(s.default,{href:`/artifacts?artifact=${encodeURIComponent(a.name)}`,className:"text-primary hover:underline font-medium",children:a.name})}),(0,b.jsx)(i.TableCell,{children:a.artifact_type}),(0,b.jsx)(i.TableCell,{children:a.app_display_name||"-"}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(h.Badge,{variant:"Active"===a.status?"destructive":"secondary",children:a.status})}),(0,b.jsx)(i.TableCell,{children:a.risk_level?(0,b.jsx)(h.Badge,{variant:"Critical"===a.risk_level||"High"===a.risk_level?"destructive":"default",children:a.risk_level}):"-"})]},a.name))})]})})]}),(E.apps?.length??0)>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Applications"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{children:"App"}),(0,b.jsx)(i.TableHead,{children:"Client ID"}),(0,b.jsx)(i.TableHead,{children:"Status"}),(0,b.jsx)(i.TableHead,{children:"Risk"})]})}),(0,b.jsx)(i.TableBody,{children:E.apps?.map(a=>(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(s.default,{href:`/apps?client_id=${encodeURIComponent(a.client_id)}`,className:"text-primary hover:underline",children:a.app_name})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)("code",{className:"text-xs",children:a.client_id})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(h.Badge,{variant:"secondary",children:a.status})}),(0,b.jsx)(i.TableCell,{children:a.risk_level?(0,b.jsx)(h.Badge,{variant:"destructive",children:a.risk_level}):"-"})]},a.artifact_name))})]})})]})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Employee Access Overview"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"View and manage employee access across cases and apps"})]}),(0,b.jsxs)(j.DropdownMenu,{children:[(0,b.jsx)(j.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(g.Button,{variant:"outline",disabled:0===H.size,children:[(0,b.jsx)(q.ChevronDown,{className:"mr-2 h-4 w-4"}),"Bulk Revoke (",H.size,")"]})}),(0,b.jsxs)(j.DropdownMenuContent,{children:[(0,b.jsxs)(j.DropdownMenuItem,{onClick:()=>{(0,t.confirmAction)({title:"Revoke All Access",description:`This will revoke all access for ${H.size} selected employee(s). Please use the employee detail view for per-employee control.`,confirmLabel:"Revoke All",onConfirm:()=>{H.forEach(()=>{G.mutate("all")}),I(new Set)}})},children:[(0,b.jsx)(n.Shield,{className:"mr-2 h-4 w-4"}),"Revoke All"]}),(0,b.jsxs)(j.DropdownMenuItem,{children:[(0,b.jsx)(o.Lock,{className:"mr-2 h-4 w-4"}),"Revoke Tokens"]}),(0,b.jsxs)(j.DropdownMenuItem,{children:[(0,b.jsx)(p,{className:"mr-2 h-4 w-4"}),"Delete ASPs"]})]})]})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{className:"text-base",children:"Employees"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{className:"w-10",children:(0,b.jsx)(k.Checkbox,{checked:B&&B.length>0&&B.every(a=>H.has(a.employee_id)),onCheckedChange:()=>{B&&(H.size===B.length?I(new Set):I(new Set(B.map(a=>a.employee_id))))}})}),(0,b.jsx)(u.SortableTableHead,{column:"employee_name",label:"Employee",sortConfig:v,onSort:w}),(0,b.jsx)(u.SortableTableHead,{column:"company_email",label:"Email",sortConfig:v,onSort:w}),(0,b.jsx)(u.SortableTableHead,{column:"emp_status",label:"Status",sortConfig:v,onSort:w}),(0,b.jsx)(u.SortableTableHead,{column:"case_count",label:"Cases",sortConfig:v,onSort:w}),(0,b.jsx)(u.SortableTableHead,{column:"active_artifacts",label:"Active Artifacts",sortConfig:v,onSort:w}),(0,b.jsx)(u.SortableTableHead,{column:"open_findings",label:"Open Findings",sortConfig:v,onSort:w}),(0,b.jsx)(i.TableHead,{})]})}),(0,b.jsx)(i.TableBody,{children:(B?x(B):[]).map(c=>(0,b.jsxs)(i.TableRow,{className:"cursor-pointer",onClick:()=>a.push(`/employees?employee=${encodeURIComponent(c.employee_id)}`),children:[(0,b.jsx)(i.TableCell,{onClick:a=>a.stopPropagation(),children:(0,b.jsx)(k.Checkbox,{checked:H.has(c.employee_id),onCheckedChange:()=>{var a;return a=c.employee_id,void I(b=>{let c=new Set(b);return c.has(a)?c.delete(a):c.add(a),c})}})}),(0,b.jsx)(i.TableCell,{className:"font-medium",children:(0,b.jsx)(s.default,{href:`/employees?employee=${encodeURIComponent(c.employee_id)}`,className:"text-primary hover:underline",children:c.employee_name})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(s.default,{href:`/employees?email=${encodeURIComponent(c.company_email)}`,className:"text-primary hover:underline",children:c.company_email})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(h.Badge,{variant:"Active"===c.emp_status?"default":"destructive",className:"Active"===c.emp_status?"bg-green-600 text-white":void 0,children:c.emp_status})}),(0,b.jsx)(i.TableCell,{children:c.case_count??0}),(0,b.jsx)(i.TableCell,{children:c.active_artifacts??0}),(0,b.jsx)(i.TableCell,{children:c.open_findings??0}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(s.default,{href:`/employees?employee=${encodeURIComponent(c.employee_id)}`,children:(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(r.User,{className:"mr-2 h-4 w-4"}),"Details"]})})})]},c.employee_id))})]})})]})]})}function w(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(l.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),children:(0,b.jsx)(v,{})})}a.s(["default",()=>w],36701)}];

//# sourceMappingURL=src_app_%28app%29_employees_page_tsx_ce800f7e._.js.map