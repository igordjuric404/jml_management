module.exports=[24223,e=>{"use strict";let t="http://localhost:8000",a=null;async function i(e,s={}){let{method:n="POST",body:o,params:r}=s,c=`${t}/api/method/${e}`;if(r){let e=new URLSearchParams(r);c+=`?${e.toString()}`}let l={"Content-Type":"application/json",Accept:"application/json"},m=process.env.FRAPPE_API_KEY,_=process.env.FRAPPE_API_SECRET;m&&_?l.Authorization=`token ${m}:${_}`:a&&(l.Cookie=a);let p={method:n,headers:l};o&&"GET"!==n&&(p.body=JSON.stringify(o));let d=await fetch(c,p);if(!d.ok){let e=await d.text().catch(()=>"Unknown error");throw Error(`Frappe API error (${d.status}): ${e}`)}let u=await d.json();if(u.exc_type)throw Error(u.exc||u.exc_type);return u.message}async function s(e,i,s){let n={Accept:"application/json"},o=process.env.FRAPPE_API_KEY,r=process.env.FRAPPE_API_SECRET;o&&r?n.Authorization=`token ${o}:${r}`:a&&(n.Cookie=a);let c=`${t}/api/resource/${encodeURIComponent(e)}/${encodeURIComponent(i)}`;s&&(c+=`?fields=${JSON.stringify(s)}`);let l=await fetch(c,{headers:n});if(!l.ok)throw Error(`Frappe resource error (${l.status})`);return(await l.json()).data}async function n(e,i={}){let s={Accept:"application/json"},o=process.env.FRAPPE_API_KEY,r=process.env.FRAPPE_API_SECRET;o&&r?s.Authorization=`token ${o}:${r}`:a&&(s.Cookie=a);let c=new URLSearchParams;i.filters&&c.set("filters",JSON.stringify(i.filters)),i.fields&&c.set("fields",JSON.stringify(i.fields)),i.order_by&&c.set("order_by",i.order_by),void 0!==i.limit_page_length&&c.set("limit_page_length",String(i.limit_page_length)),void 0!==i.limit_start&&c.set("limit_start",String(i.limit_start));let l=`${t}/api/resource/${encodeURIComponent(e)}?${c.toString()}`,m=await fetch(l,{headers:s});if(!m.ok)throw Error(`Frappe list error (${m.status})`);return(await m.json()).data}async function o(e,a){let i=await fetch(`${t}/api/method/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usr:e,pwd:a})});if(!i.ok)throw Error("Login failed");let s=i.headers.get("set-cookie")||"",n=await i.json();return{cookies:s,user:n.message||e,full_name:n.full_name||e}}class r{name="frappe";async authenticate(e,t){let i=await o(e,t);return a=i.cookies,{user:i.user,full_name:i.full_name,roles:["System Manager"]}}async logout(){await i("logout"),a=""}async getSession(){try{let e=await i("frappe.auth.get_logged_user");if(e&&"Guest"!==e)return{user:e,full_name:e,roles:["System Manager"]};return null}catch{return null}}async getDashboardStats(){let[e,t]=await Promise.all([i("oauth_gap_monitor.api.get_dashboard_stats"),n("Access Artifact",{filters:{artifact_type:"OAuthToken",status:"Active"},fields:["name"],limit_page_length:0})]),a=e.kpis;return a.oauth_grants=t.length,a.post_offboard_logins=a.post_offboard_logins??a.post_offboard_logins_30d??a.post_offboard_logins_7d??0,e}async getStatistics(){return i("oauth_gap_monitor.api.get_statistics")}async listCases(e){return n("Offboarding Case",{filters:e,fields:["name","employee","employee_name","primary_email","event_type","effective_date","status","scheduled_remediation_date","notes","creation","modified"],order_by:"modified desc",limit_page_length:0})}async getCaseDetail(e){return i("oauth_gap_monitor.api.get_case_detail",{body:{case_name:e}})}async createCase(e){let t={doctype:"Offboarding Case",...e};return await i("frappe.client.insert",{body:{doc:t}})}async createCaseFromEmployee(e){return i("oauth_gap_monitor.api.create_case_from_employee",{body:{employee:e}})}async updateCase(e,t){return i("frappe.client.set_value",{body:{doctype:"Offboarding Case",name:e,fieldname:t}})}async triggerScan(e){return i("oauth_gap_monitor.api.trigger_scan",{body:{case_name:e}})}async systemScan(){return i("oauth_gap_monitor.api.system_scan")}async getScanHistory(){return i("oauth_gap_monitor.api.get_scan_history")}async executeRemediation(e,t,a){return i("oauth_gap_monitor.api.execute_remediation",{body:{case_name:e,action:t,...a}})}async bulkRemediate(e,t){return i("oauth_gap_monitor.api.bulk_remediate",{body:{case_name:e,artifact_names:JSON.stringify(t)}})}async remediateArtifacts(e){return i("oauth_gap_monitor.api.remediate_artifacts",{body:{docnames:JSON.stringify(e)}})}async runScheduledRemediationNow(e){return i("oauth_gap_monitor.api.run_scheduled_remediation_now",{body:{case_name:e}})}async listArtifacts(e){return n("Access Artifact",{filters:e,fields:["name","case","artifact_type","subject_email","status","app_display_name","client_id","risk_level","scopes_json","metadata_json","creation","modified"],order_by:"modified desc",limit_page_length:0})}async getArtifact(e){return s("Access Artifact",e)}async listFindings(e){return n("Finding",{filters:e,fields:["name","case","finding_type","severity","summary","recommended_action","closed_at","creation","modified"],order_by:"severity desc, creation desc",limit_page_length:0})}async getFinding(e){return s("Finding",e)}async remediateFinding(e){return i("oauth_gap_monitor.api.remediate_finding",{body:{finding_name:e}})}async getEmployeeList(){let[e,t,a]=await Promise.all([i("oauth_gap_monitor.api.get_employee_list"),n("Employee",{fields:["name","employee_name","company_email","status","department","designation","date_of_joining","relieving_date","company"],order_by:"modified desc",limit_page_length:0}),n("Access Artifact",{filters:{status:"Active"},fields:["subject_email"],limit_page_length:0})]),s=new Map;for(let e of a)s.set(e.subject_email,(s.get(e.subject_email)||0)+1);let o=new Date().toISOString().slice(0,10),r=(e,t)=>"Left"===e&&t&&t>o?"To Leave":"Left"===e?"Left":"Suspended"===e?"Suspended":"Active",c=new Map(e.map(e=>[e.employee_id,e])),l=[];for(let e of t){let t=c.get(e.name);if(t){t.emp_status=r(e.status,e.relieving_date);let a=s.get(e.company_email)||0;a>(t.active_artifacts??0)&&(t.active_artifacts=a),l.push(t),c.delete(e.name)}else l.push({employee_id:e.name,employee_name:e.employee_name||"",company_email:e.company_email||"",emp_status:r(e.status,e.relieving_date),date_of_joining:e.date_of_joining||void 0,relieving_date:e.relieving_date||void 0,department:e.department||void 0,designation:e.designation||void 0,company:e.company||void 0,case_count:0,active_artifacts:s.get(e.company_email)||0,open_findings:0})}for(let e of c.values())l.push(e);return l.filter(e=>"Active"===e.emp_status||"To Leave"===e.emp_status||(e.case_count??0)>0||(e.active_artifacts??0)>0||(e.open_findings??0)>0)}async getEmployeeDetail(e){return i("oauth_gap_monitor.api.get_employee_detail",{body:{employee_id:e}})}async revokeEmployeeAccess(e,t){return i("oauth_gap_monitor.api.revoke_employee_access",{body:{employee_id:e,scope:t}})}async getAllActiveOAuthApps(){return i("oauth_gap_monitor.api.get_all_active_oauth_apps")}async getAppDetail(e){return i("oauth_gap_monitor.api.get_app_detail",{body:{client_id:e}})}async globalAppRemoval(e,t){return i("oauth_gap_monitor.api.global_app_removal",{body:{client_id:e,app_name:t}})}async revokeAppForUsers(e,t){return i("oauth_gap_monitor.api.revoke_app_for_users",{body:{client_id:e,artifact_names:JSON.stringify(t)}})}async restoreAppForUsers(e,t){return i("oauth_gap_monitor.api.restore_app_for_users",{body:{client_id:e,artifact_names:JSON.stringify(t)}})}async updateUserScopes(e,t){return i("oauth_gap_monitor.api.update_user_scopes",{body:{artifact_name:e,scopes:JSON.stringify(t)}})}async listAuditLogs(e){return n("Unified Audit Log Entry",{filters:e,fields:["name","actor_user","action_type","target_email","result","remediation_type","request_json","response_json","timestamp","creation"],order_by:"creation desc",limit_page_length:100})}async getSettings(){return s("OGM Settings","OGM Settings")}async updateSettings(e){return i("frappe.client.set_value",{body:{doctype:"OGM Settings",name:"OGM Settings",fieldname:e}})}async chat(e){return i("oauth_gap_monitor.chatbot.chat",{body:{message:e}})}}let c=new Date(Date.now()-6048e5).toISOString(),l=new Date(Date.now()-2592e6).toISOString(),m=[{employee_id:"HR-EMP-TEST-00025",employee_name:"Alex Rivera",company_email:"alex.rivera@testcorp.com",emp_status:"Active",date_of_joining:"2023-06-01",department:"Engineering",designation:"Senior Backend Developer",company:"HUB201",case_count:0,active_artifacts:4,open_findings:0},{employee_id:"HR-EMP-TEST-00026",employee_name:"Maya Patel",company_email:"maya.patel@testcorp.com",emp_status:"To Leave",date_of_joining:"2023-06-01",relieving_date:"2026-03-15",department:"Product",designation:"Product Manager",company:"HUB201",case_count:1,active_artifacts:3,open_findings:0},{employee_id:"HR-EMP-TEST-00027",employee_name:"James O'Brien",company_email:"james.obrien@testcorp.com",emp_status:"Active",date_of_joining:"2023-06-01",department:"Security",designation:"Security Analyst",company:"HUB201",case_count:0,active_artifacts:3,open_findings:0},{employee_id:"HR-EMP-TEST-00028",employee_name:"Yuki Tanaka",company_email:"yuki.tanaka@testcorp.com",emp_status:"Active",date_of_joining:"2023-06-01",department:"Data",designation:"Data Engineer",company:"HUB201",case_count:0,active_artifacts:2,open_findings:0},{employee_id:"HR-EMP-TEST-00029",employee_name:"Sofia Martinez",company_email:"sofia.martinez@testcorp.com",emp_status:"Active",date_of_joining:"2023-06-01",department:"DevOps",designation:"DevOps Lead",company:"HUB201",case_count:0,active_artifacts:3,open_findings:0},{employee_id:"HR-EMP-00011",employee_name:"Henry Check",company_email:"henry.check@example.com",emp_status:"Active",date_of_joining:"2022-01-15",department:"Engineering",company:"HUB201",case_count:1,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00013",employee_name:"John Active",company_email:"john.active@example.com",emp_status:"Active",date_of_joining:"2021-03-10",department:"Engineering",company:"HUB201",case_count:0,active_artifacts:2,open_findings:0},{employee_id:"HR-EMP-00014",employee_name:"Sarah Active",company_email:"sarah.active@example.com",emp_status:"Active",date_of_joining:"2021-06-20",department:"Marketing",company:"HUB201",case_count:0,active_artifacts:3,open_findings:0},{employee_id:"HR-EMP-00015",employee_name:"Mike Active",company_email:"mike.active@example.com",emp_status:"Active",date_of_joining:"2022-02-01",department:"Sales",company:"HUB201",case_count:0,active_artifacts:2,open_findings:0},{employee_id:"HR-EMP-00016",employee_name:"Lisa Active",company_email:"lisa.active@example.com",emp_status:"Active",date_of_joining:"2021-09-15",department:"Finance",company:"HUB201",case_count:0,active_artifacts:2,open_findings:0},{employee_id:"HR-EMP-00018",employee_name:"Emma Active",company_email:"emma.active@example.com",emp_status:"Active",date_of_joining:"2022-04-01",department:"HR",company:"HUB201",case_count:0,active_artifacts:4,open_findings:0},{employee_id:"HR-EMP-TEST-00030",employee_name:"Carlos Mendez",company_email:"carlos.mendez@testcorp.com",emp_status:"Left",date_of_joining:"2021-03-01",relieving_date:"2026-02-13",department:"Engineering",designation:"Staff Engineer",company:"HUB201",case_count:1,active_artifacts:5,open_findings:4},{employee_id:"HR-EMP-TEST-00031",employee_name:"Nina Kowalski",company_email:"nina.kowalski@testcorp.com",emp_status:"Left",date_of_joining:"2021-03-01",relieving_date:"2026-02-13",department:"Finance",designation:"Finance Manager",company:"HUB201",case_count:1,active_artifacts:3,open_findings:2},{employee_id:"HR-EMP-TEST-00032",employee_name:"Raj Sharma",company_email:"raj.sharma@testcorp.com",emp_status:"Left",date_of_joining:"2021-03-01",relieving_date:"2026-02-13",department:"IT",designation:"IT Admin",company:"HUB201",case_count:1,active_artifacts:3,open_findings:2}],_=[{name:"OBC-MOCK-00000",employee:"HR-EMP-TEST-00026",employee_name:"Maya Patel",primary_email:"maya.patel@testcorp.com",event_type:"Offboard",effective_date:"2026-03-15T00:00:00",status:"Scheduled",scheduled_remediation_date:"2026-03-15T00:00:00",notes:"Scheduled offboarding â€” tokens active until leaving date",notify_user_1w:!1,notify_user_1d:!1,creation:c},{name:"OBC-MOCK-00001",employee:"HR-EMP-TEST-00030",employee_name:"Carlos Mendez",primary_email:"carlos.mendez@testcorp.com",event_type:"Offboard",effective_date:"2026-02-13T00:00:00",status:"Gaps Found",notes:"Post-offboard login detected",notify_user_1w:!1,notify_user_1d:!1,creation:c},{name:"OBC-MOCK-00002",employee:"HR-EMP-TEST-00031",employee_name:"Nina Kowalski",primary_email:"nina.kowalski@testcorp.com",event_type:"Offboard",effective_date:"2026-02-13T00:00:00",status:"Gaps Found",notes:"Post-offboard login detected",notify_user_1w:!1,notify_user_1d:!1,creation:c},{name:"OBC-MOCK-00003",employee:"HR-EMP-TEST-00032",employee_name:"Raj Sharma",primary_email:"raj.sharma@testcorp.com",event_type:"Offboard",effective_date:"2026-02-13T00:00:00",status:"Gaps Found",notes:"Lingering OAuth and ASP access",notify_user_1w:!1,notify_user_1d:!1,creation:c}],p=[{name:"ART-M-001",case:"",artifact_type:"OAuthToken",subject_email:"alex.rivera@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive",risk_level:"High",scopes_json:'["https://www.googleapis.com/auth/drive"]',creation:c},{name:"ART-M-002",case:"",artifact_type:"OAuthToken",subject_email:"alex.rivera@testcorp.com",status:"Active",app_display_name:"GitHub",client_id:"client-github",risk_level:"Critical",scopes_json:'["https://www.googleapis.com/auth/admin.directory.user"]',creation:c},{name:"ART-M-003",case:"",artifact_type:"OAuthToken",subject_email:"alex.rivera@testcorp.com",status:"Active",app_display_name:"Slack",client_id:"client-slack",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/gmail.readonly"]',creation:c},{name:"ART-M-004",case:"",artifact_type:"ASP",subject_email:"alex.rivera@testcorp.com",status:"Active",app_display_name:"Thunderbird Mail",risk_level:"Medium",creation:c},{name:"ART-M-005",case:"",artifact_type:"OAuthToken",subject_email:"maya.patel@testcorp.com",status:"Active",app_display_name:"Notion",client_id:"client-notion",risk_level:"Low",creation:c},{name:"ART-M-006",case:"",artifact_type:"OAuthToken",subject_email:"maya.patel@testcorp.com",status:"Active",app_display_name:"Figma",client_id:"client-figma",risk_level:"Medium",creation:c},{name:"ART-M-007",case:"",artifact_type:"OAuthToken",subject_email:"maya.patel@testcorp.com",status:"Active",app_display_name:"Zoom",client_id:"client-zoom",risk_level:"Low",creation:c},{name:"ART-M-008",case:"",artifact_type:"OAuthToken",subject_email:"james.obrien@testcorp.com",status:"Active",app_display_name:"Salesforce",client_id:"client-salesforce",risk_level:"High",creation:c},{name:"ART-M-009",case:"",artifact_type:"OAuthToken",subject_email:"james.obrien@testcorp.com",status:"Active",app_display_name:"Jira",client_id:"client-jira",risk_level:"Medium",creation:c},{name:"ART-M-010",case:"",artifact_type:"ASP",subject_email:"james.obrien@testcorp.com",status:"Active",app_display_name:"Outlook Desktop",risk_level:"Medium",creation:c},{name:"ART-M-011",case:"",artifact_type:"OAuthToken",subject_email:"yuki.tanaka@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive",risk_level:"High",creation:c},{name:"ART-M-012",case:"",artifact_type:"OAuthToken",subject_email:"yuki.tanaka@testcorp.com",status:"Active",app_display_name:"ChatGPT",client_id:"client-chatgpt",risk_level:"Medium",creation:c},{name:"ART-M-013",case:"",artifact_type:"OAuthToken",subject_email:"sofia.martinez@testcorp.com",status:"Active",app_display_name:"GitHub",client_id:"client-github",risk_level:"Critical",creation:c},{name:"ART-M-014",case:"",artifact_type:"OAuthToken",subject_email:"sofia.martinez@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive",risk_level:"High",creation:c},{name:"ART-M-015",case:"",artifact_type:"ASP",subject_email:"sofia.martinez@testcorp.com",status:"Active",app_display_name:"K-9 Mail",risk_level:"Low",creation:c},{name:"ART-M-016",case:"OBC-MOCK-00001",artifact_type:"OAuthToken",subject_email:"carlos.mendez@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive",risk_level:"High",creation:c},{name:"ART-M-017",case:"OBC-MOCK-00001",artifact_type:"OAuthToken",subject_email:"carlos.mendez@testcorp.com",status:"Active",app_display_name:"GitHub",client_id:"client-github",risk_level:"Critical",creation:c},{name:"ART-M-018",case:"OBC-MOCK-00001",artifact_type:"OAuthToken",subject_email:"carlos.mendez@testcorp.com",status:"Active",app_display_name:"Slack",client_id:"client-slack",risk_level:"Medium",creation:c},{name:"ART-M-019",case:"OBC-MOCK-00001",artifact_type:"ASP",subject_email:"carlos.mendez@testcorp.com",status:"Active",app_display_name:"Thunderbird Mail",risk_level:"Medium",creation:c},{name:"ART-M-020",case:"OBC-MOCK-00001",artifact_type:"LoginEvent",subject_email:"carlos.mendez@testcorp.com",status:"Active",app_display_name:"Google Login",risk_level:"High",metadata_json:'{"ip":"203.0.113.77","login_time":"2026-02-18T14:30:00","user_agent":"Chrome/122"}',creation:c},{name:"ART-M-021",case:"OBC-MOCK-00002",artifact_type:"OAuthToken",subject_email:"nina.kowalski@testcorp.com",status:"Active",app_display_name:"Salesforce",client_id:"client-salesforce",risk_level:"High",creation:c},{name:"ART-M-022",case:"OBC-MOCK-00002",artifact_type:"OAuthToken",subject_email:"nina.kowalski@testcorp.com",status:"Active",app_display_name:"Notion",client_id:"client-notion",risk_level:"Low",creation:c},{name:"ART-M-023",case:"OBC-MOCK-00002",artifact_type:"LoginEvent",subject_email:"nina.kowalski@testcorp.com",status:"Active",app_display_name:"Google Login",risk_level:"High",metadata_json:'{"ip":"198.51.100.42","login_time":"2026-02-19T09:15:00","user_agent":"Firefox/121"}',creation:c},{name:"ART-M-024",case:"OBC-MOCK-00003",artifact_type:"OAuthToken",subject_email:"raj.sharma@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive",risk_level:"High",creation:c},{name:"ART-M-025",case:"OBC-MOCK-00003",artifact_type:"OAuthToken",subject_email:"raj.sharma@testcorp.com",status:"Active",app_display_name:"Jira",client_id:"client-jira",risk_level:"Medium",creation:c},{name:"ART-M-026",case:"OBC-MOCK-00003",artifact_type:"ASP",subject_email:"raj.sharma@testcorp.com",status:"Active",app_display_name:"Outlook Desktop",risk_level:"Medium",creation:c},{name:"ART-M-027",case:"",artifact_type:"OAuthToken",subject_email:"john.active@example.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive",risk_level:"Low",creation:l},{name:"ART-M-028",case:"",artifact_type:"OAuthToken",subject_email:"john.active@example.com",status:"Active",app_display_name:"Slack",client_id:"client-slack",risk_level:"Low",creation:l},{name:"ART-M-029",case:"",artifact_type:"OAuthToken",subject_email:"sarah.active@example.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive",risk_level:"Low",creation:l},{name:"ART-M-030",case:"",artifact_type:"OAuthToken",subject_email:"sarah.active@example.com",status:"Active",app_display_name:"Figma",client_id:"client-figma",risk_level:"Low",creation:l},{name:"ART-M-031",case:"",artifact_type:"OAuthToken",subject_email:"sarah.active@example.com",status:"Active",app_display_name:"Zoom",client_id:"client-zoom",risk_level:"Low",creation:l},{name:"ART-M-032",case:"",artifact_type:"OAuthToken",subject_email:"mike.active@example.com",status:"Active",app_display_name:"Salesforce",client_id:"client-salesforce",risk_level:"Medium",creation:l},{name:"ART-M-033",case:"",artifact_type:"OAuthToken",subject_email:"mike.active@example.com",status:"Active",app_display_name:"Jira",client_id:"client-jira",risk_level:"Low",creation:l},{name:"ART-M-034",case:"",artifact_type:"OAuthToken",subject_email:"lisa.active@example.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive",risk_level:"Low",creation:l},{name:"ART-M-035",case:"",artifact_type:"OAuthToken",subject_email:"lisa.active@example.com",status:"Active",app_display_name:"Notion",client_id:"client-notion",risk_level:"Low",creation:l},{name:"ART-M-036",case:"",artifact_type:"OAuthToken",subject_email:"emma.active@example.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive",risk_level:"Low",creation:l},{name:"ART-M-037",case:"",artifact_type:"OAuthToken",subject_email:"emma.active@example.com",status:"Active",app_display_name:"GitHub",client_id:"client-github",risk_level:"Medium",creation:l},{name:"ART-M-038",case:"",artifact_type:"OAuthToken",subject_email:"emma.active@example.com",status:"Active",app_display_name:"Figma",client_id:"client-figma",risk_level:"Low",creation:l},{name:"ART-M-039",case:"",artifact_type:"OAuthToken",subject_email:"emma.active@example.com",status:"Active",app_display_name:"Slack",client_id:"client-slack",risk_level:"Low",creation:l}],d=[{name:"FND-M-001",case:"OBC-MOCK-00001",finding_type:"LingeringOAuthGrant",severity:"Critical",summary:"OAuth grant for GitHub with admin scope persists after offboarding.",recommended_action:"Revoke the GitHub OAuth token.",creation:c},{name:"FND-M-002",case:"OBC-MOCK-00001",finding_type:"LingeringOAuthGrant",severity:"High",summary:"OAuth grant for Google Drive with full drive access.",recommended_action:"Revoke the Google Drive token.",creation:c},{name:"FND-M-003",case:"OBC-MOCK-00001",finding_type:"LingeringASP",severity:"Medium",summary:"App-Specific Password for Thunderbird still active.",recommended_action:"Delete the ASP.",creation:c},{name:"FND-M-004",case:"OBC-MOCK-00001",finding_type:"PostOffboardLogin",severity:"High",summary:"Post-offboard login detected from IP 203.0.113.77 via Chrome.",recommended_action:"Sign out all sessions and investigate.",creation:c},{name:"FND-M-005",case:"OBC-MOCK-00002",finding_type:"LingeringOAuthGrant",severity:"High",summary:"OAuth grant for Salesforce with contacts access persists.",recommended_action:"Revoke Salesforce token.",creation:c},{name:"FND-M-006",case:"OBC-MOCK-00002",finding_type:"PostOffboardLogin",severity:"High",summary:"Post-offboard login detected from IP 198.51.100.42 via Firefox.",recommended_action:"Sign out all sessions.",creation:c},{name:"FND-M-007",case:"OBC-MOCK-00003",finding_type:"LingeringOAuthGrant",severity:"High",summary:"OAuth grant for Google Drive with full drive access from former IT admin.",recommended_action:"Revoke the Google Drive token.",creation:c},{name:"FND-M-008",case:"OBC-MOCK-00003",finding_type:"LingeringASP",severity:"Medium",summary:"ASP for Outlook Desktop still active after offboarding.",recommended_action:"Delete ASP.",creation:c}],u=[{name:"AUD-M-001",actor_user:"Administrator",action_type:"CaseCreated",target_email:"carlos.mendez@testcorp.com",result:"Success",request_json:'{"case":"OBC-MOCK-00001"}',timestamp:c,creation:c},{name:"AUD-M-002",actor_user:"Administrator",action_type:"CaseCreated",target_email:"nina.kowalski@testcorp.com",result:"Success",request_json:'{"case":"OBC-MOCK-00002"}',timestamp:c,creation:c},{name:"AUD-M-003",actor_user:"Administrator",action_type:"CaseCreated",target_email:"raj.sharma@testcorp.com",result:"Success",request_json:'{"case":"OBC-MOCK-00003"}',timestamp:c,creation:c},{name:"AUD-M-004",actor_user:"Administrator",action_type:"ScanFinished",target_email:"carlos.mendez@testcorp.com",result:"Success",request_json:'{"case":"OBC-MOCK-00001","active_artifacts":5}',timestamp:c,creation:c}];var f=e.i(92749);function g(e){return JSON.parse(JSON.stringify(e))}let y="http://localhost:8000",h=process.env.FRAPPE_ADMIN_USER||"Administrator",v=process.env.FRAPPE_ADMIN_PASS||"admin",A={data:null,ts:0};async function k(){if("u">typeof process&&process.env?.VITEST)return null;if(A.data&&Date.now()-A.ts<6e4)return A.data;try{let e=await fetch(`${y}/api/method/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usr:h,pwd:v})});if(!e.ok)return null;let t=e.headers.getSetCookie?.()??[],a=t.length?t.map(e=>e.split(";")[0]).join("; "):e.headers.get("set-cookie")?.split(",").map(e=>e.trim().split(";")[0]).join("; ")??"",i=new URLSearchParams({fields:JSON.stringify(["name","employee_name","company_email","status","department","designation","date_of_joining","relieving_date","company"]),limit_page_length:"0"}),s=await fetch(`${y}/api/resource/Employee?${i}`,{headers:{Accept:"application/json",Cookie:a}});if(!s.ok)return null;let n=((await s.json()).data||[]).map(e=>({employee_id:e.name,employee_name:e.employee_name||"",company_email:e.company_email||"",emp_status:"Left"===e.status?"Left":"Suspended"===e.status?"Suspended":"Active",date_of_joining:e.date_of_joining||void 0,relieving_date:e.relieving_date||void 0,department:e.department||void 0,designation:e.designation||void 0,company:e.company||void 0}));return A={data:n,ts:Date.now()},n}catch{return null}}async function S(){return await k()??g(m)}let O=g(_),b=g(p),C=g(d),w=g(u),M=g({auto_scan_on_offboard:!0,auto_remediate_on_offboard:!0,background_scan_enabled:!0,auto_create_case_on_leave:!0,background_scan_interval:"Every 15 Minutes",remediation_check_interval:"Every 5 Minutes",notify_on_new_findings:!0,notify_on_remediation:!0,notification_email:"igordjuric404@gmail.com",default_remediation_action:"full_bundle"}),T=0;function R(e,t,a){T++,w.unshift({name:`AUD-MOCK-${Date.now()}-${T}`,actor_user:"Administrator",action_type:e,target_email:t,result:"Success",request_json:JSON.stringify(a||{}),timestamp:new Date().toISOString(),creation:new Date().toISOString()})}class j{name="mock";async authenticate(e,t){if("Administrator"===e&&"admin"===t)return{user:"Administrator",full_name:"Admin User",roles:["System Manager","HR Manager"]};if("hr@testcorp.com"===e&&"admin"===t)return{user:"hr@testcorp.com",full_name:"HR Manager",roles:["HR Manager"]};throw Error("Invalid credentials. Use Administrator/admin or hr@testcorp.com/admin")}async logout(){}async getSession(){return{user:"Administrator",full_name:"Admin User",roles:["System Manager","HR Manager"]}}async getDashboardStats(){this._checkOverdueRemediations();let e=O.filter(e=>["Draft","Scheduled"].includes(e.status)).length,t=new Set(C.filter(e=>"Critical"===e.severity&&!e.closed_at).map(e=>e.case)),a=b.filter(e=>"OAuthToken"===e.artifact_type&&"Active"===e.status).length,i=C.filter(e=>["PostOffboardLogin","PostOffboardSuspiciousLogin"].includes(e.finding_type)&&!e.closed_at).length,s=this._getTopApps(),n=O.filter(e=>!["Closed","Remediated"].includes(e.status)).map(e=>{let t=C.filter(t=>t.case===e.name);return{case_name:e.name,primary_email:e.primary_email,employee_name:e.employee_name,status:e.status,effective_date:e.effective_date,finding_count:t.length,critical_count:t.filter(e=>"Critical"===e.severity).length}}).sort((e,t)=>t.critical_count-e.critical_count||t.finding_count-e.finding_count).slice(0,10);return{kpis:{pending_scan:e,critical_gaps:t.size,oauth_grants:a,post_offboard_logins:i,total_cases:O.length,total_findings:C.length,total_artifacts:b.length},top_oauth_apps:s,risky_cases:n}}async getStatistics(){return{mean_time_to_enforce_hours:48.5,top_apps_by_exposure:this._getTopApps(),scope_heatmap:[{scope:"googleapis.com/auth/drive",count:8},{scope:"googleapis.com/auth/gmail",count:5},{scope:"googleapis.com/auth/calendar",count:4},{scope:"googleapis.com/auth/admin",count:3}],residual_access_trend:[{week:"202548",finding_count:2},{week:"202549",finding_count:4},{week:"202550",finding_count:3},{week:"202551",finding_count:5}]}}async listCases(e){return this._checkOverdueRemediations(),g(O)}async getCaseDetail(e){this._checkOverdueRemediations();let t=O.find(t=>t.name===e);if(!t)throw Error(`Case not found: ${e}`);let a=b.filter(t=>t.case===e&&"Hidden"!==t.status),i=C.filter(t=>t.case===e),s=w.filter(e=>e.target_email===t.primary_email);return{case:g(t),artifacts:{tokens:a.filter(e=>"OAuthToken"===e.artifact_type),asps:a.filter(e=>"ASP"===e.artifact_type),login_events:a.filter(e=>"LoginEvent"===e.artifact_type),other:a.filter(e=>!["OAuthToken","ASP","LoginEvent"].includes(e.artifact_type)),total:a.length},findings:i,audit_logs:s}}async createCase(e){let t={name:`OBC-MOCK-${Date.now()}`,employee:e.employee||"",employee_name:e.employee_name||"",primary_email:e.primary_email||"",event_type:e.event_type||"Offboard",effective_date:e.effective_date||new Date().toISOString(),status:"Draft",notify_user_1w:!1,notify_user_1d:!1,notes:e.notes,creation:new Date().toISOString()};return O.unshift(t),R("CaseCreated",t.primary_email,{case:t.name}),g(t)}async createCaseFromEmployee(e){let t=(await S()).find(t=>t.employee_id===e);if(!t)throw Error(`Employee not found: ${e}`);return this.createCase({employee:e,employee_name:t.employee_name,primary_email:t.company_email,event_type:"Offboard"})}async updateCase(e,t){let a=O.findIndex(t=>t.name===e);if(-1===a)throw Error(`Case not found: ${e}`);return O[a]={...O[a],...t},g(O[a])}async triggerScan(e){let t=O.find(t=>t.name===e);if(!t)throw Error(`Case not found: ${e}`);R("ScanStarted",t.primary_email,{case:e});let a=b.filter(t=>t.case===e&&"Active"===t.status).length,i=C.filter(t=>t.case===e&&!t.closed_at).length;return t.status=a>0||i>0?"Gaps Found":"All Clear",R("ScanFinished",t.primary_email,{case:e,active_artifacts:a,open_findings:i,new_status:t.status}),{status:"success",message:`Scan completed for ${t.primary_email}`}}async systemScan(){R("ScanStarted","SYSTEM",{scan_type:"system_scan"});let e=b.filter(e=>"Hidden"===e.status),t=0;for(let a of e){let e=O.find(e=>e.primary_email===a.subject_email&&!["Closed"].includes(e.status));if(!e){let t=(await S()).find(e=>e.company_email===a.subject_email);e={name:`OBC-MOCK-${Date.now()}-${Math.random().toString(36).slice(2,7)}`,employee:t?.employee_id||"",employee_name:t?.employee_name||"",primary_email:a.subject_email,event_type:"Offboard",effective_date:new Date().toISOString(),status:"Gaps Found",notify_user_1w:!1,notify_user_1d:!1,creation:new Date().toISOString()},O.push(e)}a.status="Active",a.case=e.name,e.status="Gaps Found";let i={OAuthToken:"LingeringOAuthGrant",ASP:"LingeringASP",LoginEvent:"PostOffboardLogin",AdminMFA:"AdminMFAWeak",DWDChange:"DWDHighRisk"}[a.artifact_type]||"LingeringOAuthGrant";C.push({name:`FND-MOCK-${Date.now()}-${t}`,case:e.name,finding_type:i,severity:a.risk_level||"Medium",summary:`${a.app_display_name||"Unknown"} discovered during system scan for ${a.subject_email}.`,recommended_action:"Review and remediate.",creation:new Date().toISOString()}),t++}if(R("ScanFinished","SYSTEM",{scan_type:"system_scan",discoveries:t}),M.notify_on_new_findings&&t>0)for(let e of C.filter(e=>!e.closed_at&&("Critical"===e.severity||"High"===e.severity)).slice(-t)){let t=O.find(t=>t.name===e.case);(0,f.sendFindingAlert)({findingName:e.name,severity:e.severity,findingType:e.finding_type,summary:e.summary,caseName:e.case,employeeEmail:t?.primary_email||"unknown"},M.notification_email||void 0).catch(()=>{})}return{status:"success",message:`System scan found ${t} new issue(s).`}}async getScanHistory(){let e=w.filter(e=>["ScanStarted","ScanFinished"].includes(e.action_type)),t=[];for(let a of e){if("ScanStarted"!==a.action_type)continue;let i=JSON.parse(a.request_json||"{}"),s=e.find(e=>"ScanFinished"===e.action_type&&e.target_email===a.target_email),n=s?JSON.parse(s.request_json||"{}"):{};t.push({scan_id:a.name,case:i.case||"",target_email:a.target_email,trigger:a.actor_user?.includes("Scheduler")?"automatic":"manual",actor:a.actor_user,started_at:a.timestamp,result:s?"Completed":"Pending",new_status:n.new_status||"",active_artifacts:n.active_artifacts||0,open_findings:n.open_findings,findings_link:i.case?`/findings?case=${i.case}`:""})}return t}async executeRemediation(e,t,a){let i=O.find(t=>t.name===e);if(!i)throw Error(`Case not found: ${e}`);if(R("RemediationStarted",i.primary_email,{case:e,action:t}),"full_bundle"===t){let a=b.filter(t=>t.case===e&&"Active"===t.status);for(let e of a)e.status="ASP"===e.artifact_type?"Deleted":"Revoked";let s=C.filter(t=>t.case===e&&!t.closed_at);for(let e of s)e.closed_at=new Date().toISOString();return i.status="Remediated",R("RemediationCompleted",i.primary_email,{case:e,action:t,artifacts_remediated:a.length}),{status:"success",action:t,artifacts_remediated:a.length,findings_closed:s.length}}if("revoke_token"===t){let a=b.filter(t=>t.case===e&&"OAuthToken"===t.artifact_type&&"Active"===t.status);for(let e of a)e.status="Revoked";return this._closeFindingsForCase(e,["LingeringOAuthGrant"]),this._rescanCase(e),{status:"success",action:t,revoked:a.length}}if("delete_asp"===t){let a=b.filter(t=>t.case===e&&"ASP"===t.artifact_type&&"Active"===t.status);for(let e of a)e.status="Deleted";return this._closeFindingsForCase(e,["LingeringASP"]),this._rescanCase(e),{status:"success",action:t,deleted:a.length}}if("sign_out"===t){for(let t of b.filter(t=>t.case===e&&"LoginEvent"===t.artifact_type&&"Active"===t.status))t.status="Acknowledged";return this._closeFindingsForCase(e,["PostOffboardLogin","PostOffboardSuspiciousLogin"]),this._rescanCase(e),{status:"success",action:t}}throw Error(`Unknown action: ${t}`)}async bulkRemediate(e,t){let a=0,i=0;for(let e of t){let t=b.find(t=>t.name===e);t&&("OAuthToken"===t.artifact_type?(t.status="Revoked",a++):"ASP"===t.artifact_type&&(t.status="Deleted",i++))}return this._rescanCase(e),{status:"success",revoked:a,deleted:i}}async remediateArtifacts(e){let t=0,a=0,i=new Set;for(let s of e){let e=b.find(e=>e.name===s);e&&"Active"===e.status&&("OAuthToken"===e.artifact_type?(e.status="Revoked",t++):"ASP"===e.artifact_type?(e.status="Deleted",a++):e.status="Acknowledged",e.case&&i.add(e.case))}for(let e of i)this._rescanCase(e);return{status:"success",revoked:t,deleted:a}}async runScheduledRemediationNow(e){return this.executeRemediation(e,"full_bundle")}async listArtifacts(e){let t=g(b);return e&&(e.status&&(t=t.filter(t=>t.status===e.status)),e.case&&(t=t.filter(t=>t.case===e.case)),e.artifact_type&&(t=t.filter(t=>t.artifact_type===e.artifact_type))),t}async getArtifact(e){let t=b.find(t=>t.name===e);if(!t)throw Error(`Artifact not found: ${e}`);return g(t)}async listFindings(e){let t=g(C);return e&&(e.case&&(t=t.filter(t=>t.case===e.case)),e.severity&&(t=t.filter(t=>t.severity===e.severity)),e.finding_type&&(t=t.filter(t=>t.finding_type===e.finding_type))),t}async getFinding(e){let t=C.find(t=>t.name===e);if(!t)throw Error(`Finding not found: ${e}`);return g(t)}async remediateFinding(e){let t=C.find(t=>t.name===e);if(!t)throw Error(`Finding not found: ${e}`);if(t.closed_at)throw Error(`Finding already closed: ${e}`);t.closed_at=new Date().toISOString();let a=b.filter(e=>e.case===t.case&&"Active"===e.status),i={LingeringOAuthGrant:["OAuthToken"],LingeringASP:["ASP"],PostOffboardLogin:["LoginEvent"],PostOffboardSuspiciousLogin:["LoginEvent"],AdminMFAWeak:["AdminMFA"],DWDHighRisk:["DWDChange"]}[t.finding_type]||[],s=0;for(let e of a)i.includes(e.artifact_type)&&(e.status="ASP"===e.artifact_type?"Deleted":"Revoked",s++);return R("RemediationCompleted",t.case,{finding:e,artifacts_remediated:s}),this._rescanCase(t.case),{status:"success",artifacts_remediated:s,findings_closed:1}}async getEmployeeList(){return(await S()).map(e=>{let t=O.filter(t=>t.employee===e.employee_id),a=t.map(e=>e.name),i=[...b.filter(e=>a.includes(e.case)),...b.filter(t=>t.subject_email===e.company_email&&!t.case)],s=C.filter(e=>a.includes(e.case));return{...e,case_count:t.length,active_artifacts:i.filter(e=>"Active"===e.status).length,open_findings:s.filter(e=>!e.closed_at).length}})}async getEmployeeDetail(e){let t=(await S()).find(t=>t.employee_id===e);if(!t)throw Error(`Employee not found: ${e}`);let a=O.filter(t=>t.employee===e),i=a.map(e=>e.name),s=[...b.filter(e=>i.includes(e.case)),...b.filter(e=>e.subject_email===t.company_email&&!e.case)],n=C.filter(e=>i.includes(e.case)),o={};for(let e of s)if("OAuthToken"===e.artifact_type&&e.app_display_name){let t=e.client_id||e.app_display_name;o[t]||(o[t]={app_name:e.app_display_name,client_id:e.client_id||"",status:e.status,risk_level:e.risk_level,artifact_name:e.name})}return{employee:{id:t.employee_id,name:t.employee_name,email:t.company_email,status:t.emp_status,date_of_joining:t.date_of_joining,relieving_date:t.relieving_date,department:t.department,designation:t.designation,company:t.company},cases:a,artifacts:s,findings:n,apps:Object.values(o),summary:{total_cases:a.length,active_artifacts:s.filter(e=>"Active"===e.status).length,open_findings:n.filter(e=>!e.closed_at).length,apps_used:Object.keys(o).length}}}async revokeEmployeeAccess(e,t){let a=O.filter(t=>t.employee===e&&!["Closed","Remediated"].includes(t.status)),i=0,s=0;for(let e of a){let a=await this.executeRemediation(e.name,"tokens"===t?"revoke_token":"asps"===t?"delete_asp":"full_bundle");i+=a.artifacts_remediated||a.revoked||a.deleted||0,s+=a.findings_closed||0}return{status:"success",artifacts_remediated:i,findings_closed:s}}async getAllActiveOAuthApps(){let e={};for(let t of b)"OAuthToken"===t.artifact_type&&"Active"===t.status&&t.client_id&&(e[t.client_id]||(e[t.client_id]={client_id:t.client_id,app_display_name:t.app_display_name||"Unknown",grant_count:0,user_count:0,case_count:0}),e[t.client_id].grant_count++);for(let t of Object.keys(e)){let a=b.filter(e=>e.client_id===t&&"Active"===e.status);e[t].user_count=new Set(a.map(e=>e.subject_email)).size,e[t].case_count=new Set(a.map(e=>e.case).filter(Boolean)).size}return Object.values(e).sort((e,t)=>t.grant_count-e.grant_count)}async getAppDetail(e){let t=b.filter(t=>t.client_id===e&&"OAuthToken"===t.artifact_type),a=t[0]?.app_display_name||e,i=new Set,s=t.map(e=>{let t=JSON.parse(e.scopes_json||"[]");return t.forEach(e=>{let t=e.split("/");i.add(t[t.length-1]||e)}),{email:e.subject_email,status:e.status,risk_level:e.risk_level,case:e.case||"",artifact_name:e.name,granted:e.creation||"",scopes:t.map(e=>{let t=e.split("/"),a=t[t.length-1]||e;return{scope:a,full:e,level:/send|modify|compose|write|admin|manage/i.test(a)?"write":"read"}}),raw_scopes:t}});return{client_id:e,app_name:a,total_grants:t.length,active_grants:t.filter(e=>"Active"===e.status).length,revoked_grants:t.filter(e=>"Revoked"===e.status).length,cases_affected:[...new Set(t.map(e=>e.case).filter(Boolean))],scopes:[...i].sort(),users:s}}async globalAppRemoval(e,t){let a=b.filter(t=>t.client_id===e&&"Active"===t.status&&"OAuthToken"===t.artifact_type),i=new Set;for(let e of a)e.status="Revoked",e.case&&i.add(e.case);for(let e of i)this._rescanCase(e);return R("GlobalAppRemoval","",{client_id:e,app_name:t,revoked:a.length}),{status:"success",revoked:a.length}}async revokeAppForUsers(e,t){let a=0,i=new Set;for(let e of t){let t=b.find(t=>t.name===e);t&&"Active"===t.status&&"OAuthToken"===t.artifact_type&&(t.status="Revoked",a++,t.case&&i.add(t.case))}for(let e of i)this._rescanCase(e);return{status:"success",revoked:a}}async restoreAppForUsers(e,t){let a=0,i=new Set;for(let e of t){let t=b.find(t=>t.name===e);t&&"Revoked"===t.status&&"OAuthToken"===t.artifact_type&&(t.status="Active",a++,t.case&&i.add(t.case))}for(let e of i)this._rescanCase(e);return{status:"success",artifacts_remediated:a}}async updateUserScopes(e,t){let a=b.find(t=>t.name===e);if(!a)throw Error(`Artifact not found: ${e}`);let i=JSON.parse(a.scopes_json||"[]");a.scopes_json=JSON.stringify(t),t.length||"Active"!==a.status?t.length&&"Revoked"===a.status&&(a.status="Active"):a.status="Revoked";let s=i.filter(e=>!t.includes(e)).length,n=t.filter(e=>!i.includes(e)).length;return a.case&&this._rescanCase(a.case),{removed:s,added:n}}async listAuditLogs(e){return g(w)}async getSettings(){return g(M)}async updateSettings(e){return g(M={...M,...e})}async chat(t){let{chat:a}=await e.A(54006);return a(t,{apiKey:process.env.OPENROUTER_API_KEY,liveDataProvider:{getCaseCounts:async()=>{let e={};for(let t of["Draft","Scheduled","All Clear","Gaps Found","Remediated","Closed"]){let a=O.filter(e=>e.status===t).length;a>0&&(e[t]=a)}return e},getTotalCases:async()=>O.length,getOpenFindings:async()=>C.filter(e=>!e.closed_at).length,getTotalFindings:async()=>C.length,getCriticalFindings:async()=>C.filter(e=>"Critical"===e.severity&&!e.closed_at).length,getActiveArtifacts:async()=>b.filter(e=>"Active"===e.status).length,getTotalArtifacts:async()=>b.length,getHiddenArtifacts:async()=>b.filter(e=>"Hidden"===e.status).length,getOffboardedEmployees:async()=>(await S()).filter(e=>"Left"===e.emp_status).length}})}_getTopApps(){let e={};for(let t of b)"OAuthToken"===t.artifact_type&&"Active"===t.status&&t.client_id&&(e[t.client_id]||(e[t.client_id]={client_id:t.client_id,app_display_name:t.app_display_name||"Unknown",grant_count:0}),e[t.client_id].grant_count++);return Object.values(e).sort((e,t)=>t.grant_count-e.grant_count).slice(0,10)}_closeFindingsForCase(e,t){for(let a of C)a.case===e&&t.includes(a.finding_type)&&!a.closed_at&&(a.closed_at=new Date().toISOString())}_checkOverdueRemediations(){let e=new Date;for(let t of O)if("Scheduled"===t.status&&t.scheduled_remediation_date&&new Date(t.scheduled_remediation_date)<=e){let a=b.filter(e=>e.case===t.name&&"Active"===e.status);for(let e of a)e.status="ASP"===e.artifact_type?"Deleted":"Revoked";let i=C.filter(e=>e.case===t.name&&!e.closed_at);for(let t of i)t.closed_at=e.toISOString();t.status="Remediated",R("ScheduledRemediationExecuted",t.primary_email,{case:t.name,scheduled_for:t.scheduled_remediation_date,artifacts_remediated:a.length,findings_closed:i.length})}}_rescanCase(e){let t=O.find(t=>t.name===e);if(!t)return;let a=b.filter(t=>t.case===e&&"Active"===t.status).length,i=C.filter(t=>t.case===e&&!t.closed_at).length;0===a&&0===i?["Gaps Found","Draft","Scheduled"].includes(t.status)&&(t.status="Remediated"):t.status="Gaps Found"}}class E{name="fallback";frappe=new r;mock=new j;frappeHealthy=!0;async try(e,t){if(!this.frappeHealthy)return t();try{return await e()}catch{return this.frappeHealthy=!1,setTimeout(()=>{this.frappeHealthy=!0},3e4),t()}}authenticate=(e,t)=>this.try(()=>this.frappe.authenticate(e,t),()=>this.mock.authenticate(e,t));logout=()=>this.try(()=>this.frappe.logout(),()=>this.mock.logout());getSession=()=>this.try(()=>this.frappe.getSession(),()=>this.mock.getSession());getDashboardStats=()=>this.try(()=>this.frappe.getDashboardStats(),()=>this.mock.getDashboardStats());getStatistics=()=>this.try(()=>this.frappe.getStatistics(),()=>this.mock.getStatistics());listCases=e=>this.try(()=>this.frappe.listCases(e),()=>this.mock.listCases(e));getCaseDetail=e=>this.try(()=>this.frappe.getCaseDetail(e),()=>this.mock.getCaseDetail(e));createCase=e=>this.try(()=>this.frappe.createCase(e),()=>this.mock.createCase(e));createCaseFromEmployee=e=>this.try(()=>this.frappe.createCaseFromEmployee(e),()=>this.mock.createCaseFromEmployee(e));updateCase=(e,t)=>this.try(()=>this.frappe.updateCase(e,t),()=>this.mock.updateCase(e,t));triggerScan=e=>this.try(()=>this.frappe.triggerScan(e),()=>this.mock.triggerScan(e));systemScan=()=>this.try(()=>this.frappe.systemScan(),()=>this.mock.systemScan());getScanHistory=()=>this.try(()=>this.frappe.getScanHistory(),()=>this.mock.getScanHistory());executeRemediation=(e,t,a)=>this.try(()=>this.frappe.executeRemediation(e,t,a),()=>this.mock.executeRemediation(e,t,a));bulkRemediate=(e,t)=>this.try(()=>this.frappe.bulkRemediate(e,t),()=>this.mock.bulkRemediate(e,t));remediateArtifacts=e=>this.try(()=>this.frappe.remediateArtifacts(e),()=>this.mock.remediateArtifacts(e));runScheduledRemediationNow=e=>this.try(()=>this.frappe.runScheduledRemediationNow(e),()=>this.mock.runScheduledRemediationNow(e));listArtifacts=e=>this.try(()=>this.frappe.listArtifacts(e),()=>this.mock.listArtifacts(e));getArtifact=e=>this.try(()=>this.frappe.getArtifact(e),()=>this.mock.getArtifact(e));listFindings=e=>this.try(()=>this.frappe.listFindings(e),()=>this.mock.listFindings(e));getFinding=e=>this.try(()=>this.frappe.getFinding(e),()=>this.mock.getFinding(e));remediateFinding=e=>this.try(()=>this.frappe.remediateFinding(e),()=>this.mock.remediateFinding(e));getEmployeeList=()=>this.try(()=>this.frappe.getEmployeeList(),()=>this.mock.getEmployeeList());getEmployeeDetail=e=>this.try(()=>this.frappe.getEmployeeDetail(e),()=>this.mock.getEmployeeDetail(e));revokeEmployeeAccess=(e,t)=>this.try(()=>this.frappe.revokeEmployeeAccess(e,t),()=>this.mock.revokeEmployeeAccess(e,t));getAllActiveOAuthApps=()=>this.try(()=>this.frappe.getAllActiveOAuthApps(),()=>this.mock.getAllActiveOAuthApps());getAppDetail=e=>this.try(()=>this.frappe.getAppDetail(e),()=>this.mock.getAppDetail(e));globalAppRemoval=(e,t)=>this.try(()=>this.frappe.globalAppRemoval(e,t),()=>this.mock.globalAppRemoval(e,t));revokeAppForUsers=(e,t)=>this.try(()=>this.frappe.revokeAppForUsers(e,t),()=>this.mock.revokeAppForUsers(e,t));restoreAppForUsers=(e,t)=>this.try(()=>this.frappe.restoreAppForUsers(e,t),()=>this.mock.restoreAppForUsers(e,t));updateUserScopes=(e,t)=>this.try(()=>this.frappe.updateUserScopes(e,t),()=>this.mock.updateUserScopes(e,t));listAuditLogs=e=>this.try(()=>this.frappe.listAuditLogs(e),()=>this.mock.listAuditLogs(e));getSettings=()=>this.try(()=>this.frappe.getSettings(),()=>this.mock.getSettings());updateSettings=e=>this.try(()=>this.frappe.updateSettings(e),()=>this.mock.updateSettings(e));chat=e=>this.try(()=>this.frappe.chat(e),()=>this.mock.chat(e))}let D=null;function P(){return D||(D=new E)}e.s(["getProvider",()=>P],24223)}];

//# sourceMappingURL=src_lib_providers_index_ts_b0ab9515._.js.map