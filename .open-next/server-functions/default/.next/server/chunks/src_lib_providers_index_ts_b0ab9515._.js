module.exports=[24223,e=>{"use strict";let t=new Date(Date.now()-6048e5).toISOString(),a=new Date(Date.now()-2592e6).toISOString(),i=new Date(Date.now()-36e5).toISOString(),n=[{employee_id:"HR-EMP-00001",employee_name:"Alice Johnson",company_email:"alice.johnson@testcorp.com",emp_status:"Left",date_of_joining:"2020-03-15",relieving_date:"2025-12-01",department:"Engineering",designation:"Senior Developer",company:"Test Corp",case_count:1,active_artifacts:3,open_findings:3},{employee_id:"HR-EMP-00002",employee_name:"Bob Smith",company_email:"bob.smith@testcorp.com",emp_status:"Left",date_of_joining:"2019-06-01",relieving_date:"2025-11-15",department:"Marketing",designation:"Marketing Manager",company:"Test Corp",case_count:1,active_artifacts:2,open_findings:2},{employee_id:"HR-EMP-00003",employee_name:"Charlie Brown",company_email:"charlie.brown@testcorp.com",emp_status:"Left",date_of_joining:"2021-01-10",relieving_date:"2025-10-20",department:"Sales",designation:"Sales Rep",company:"Test Corp",case_count:1,active_artifacts:1,open_findings:1},{employee_id:"HR-EMP-00004",employee_name:"Diana Prince",company_email:"diana.prince@testcorp.com",emp_status:"Left",date_of_joining:"2018-09-01",relieving_date:"2025-09-30",department:"IT",designation:"IT Admin",company:"Test Corp",case_count:1,active_artifacts:2,open_findings:2},{employee_id:"HR-EMP-00005",employee_name:"Eve Wilson",company_email:"eve.wilson@testcorp.com",emp_status:"Left",date_of_joining:"2020-07-15",relieving_date:"2025-08-15",department:"HR",designation:"HR Specialist",company:"Test Corp",case_count:1,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00006",employee_name:"Frank Castle",company_email:"frank.castle@testcorp.com",emp_status:"Left",date_of_joining:"2017-04-20",relieving_date:"2025-07-01",department:"Engineering",designation:"DevOps Engineer",company:"Test Corp",case_count:1,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00007",employee_name:"Grace Lee",company_email:"grace.lee@testcorp.com",emp_status:"Left",date_of_joining:"2021-11-01",relieving_date:"2025-12-15",department:"Finance",designation:"Accountant",company:"Test Corp",case_count:1,active_artifacts:4,open_findings:4},{employee_id:"HR-EMP-00008",employee_name:"Henry Ford",company_email:"henry.ford@testcorp.com",emp_status:"Left",date_of_joining:"2019-02-14",relieving_date:"2025-06-30",department:"Legal",designation:"Legal Counsel",company:"Test Corp",case_count:1,active_artifacts:1,open_findings:1},{employee_id:"HR-EMP-00009",employee_name:"Ivy Chen",company_email:"ivy.chen@testcorp.com",emp_status:"Left",date_of_joining:"2022-05-01",relieving_date:"2025-11-30",department:"Engineering",designation:"Backend Developer",company:"Test Corp",case_count:1,active_artifacts:6,open_findings:6},{employee_id:"HR-EMP-00010",employee_name:"Jack Daniels",company_email:"jack.daniels@testcorp.com",emp_status:"Left",date_of_joining:"2020-08-01",relieving_date:"2025-10-15",department:"Support",designation:"Support Lead",company:"Test Corp",case_count:1,active_artifacts:1,open_findings:1},{employee_id:"HR-EMP-00011",employee_name:"Karen White",company_email:"karen.white@testcorp.com",emp_status:"Active",date_of_joining:"2021-03-10",department:"Engineering",designation:"Frontend Developer",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00012",employee_name:"Liam Neeson",company_email:"liam.neeson@testcorp.com",emp_status:"Active",date_of_joining:"2019-11-20",department:"Marketing",designation:"Content Writer",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00013",employee_name:"Monica Geller",company_email:"monica.geller@testcorp.com",emp_status:"Active",date_of_joining:"2020-01-05",department:"Operations",designation:"Operations Manager",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00014",employee_name:"Nathan Drake",company_email:"nathan.drake@testcorp.com",emp_status:"Active",date_of_joining:"2022-06-15",department:"Engineering",designation:"QA Engineer",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00015",employee_name:"Olivia Pope",company_email:"olivia.pope@testcorp.com",emp_status:"Active",date_of_joining:"2018-12-01",department:"Executive",designation:"VP Operations",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00016",employee_name:"Peter Parker",company_email:"peter.parker@testcorp.com",emp_status:"Active",date_of_joining:"2023-01-20",department:"Engineering",designation:"Intern",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00017",employee_name:"Quinn Hughes",company_email:"quinn.hughes@testcorp.com",emp_status:"Active",date_of_joining:"2021-08-30",department:"Design",designation:"UI Designer",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00018",employee_name:"Rachel Green",company_email:"rachel.green@testcorp.com",emp_status:"Active",date_of_joining:"2020-04-15",department:"Sales",designation:"Account Executive",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0}],s=[{name:"OBC-2025-00001",employee:"HR-EMP-00001",employee_name:"Alice Johnson",primary_email:"alice.johnson@testcorp.com",event_type:"Offboard",effective_date:"2025-12-01T00:00:00",status:"Gaps Found",notes:"Scenario A: Multiple OAuth tokens lingering",notify_user_1w:!1,notify_user_1d:!1,creation:a},{name:"OBC-2025-00002",employee:"HR-EMP-00002",employee_name:"Bob Smith",primary_email:"bob.smith@testcorp.com",event_type:"Offboard",effective_date:"2025-11-15T00:00:00",status:"Gaps Found",notes:"Scenario B: ASPs still active",notify_user_1w:!1,notify_user_1d:!1,creation:a},{name:"OBC-2025-00003",employee:"HR-EMP-00003",employee_name:"Charlie Brown",primary_email:"charlie.brown@testcorp.com",event_type:"Offboard",effective_date:"2025-10-20T00:00:00",status:"Gaps Found",notes:"Scenario C: Post-offboard login detected",notify_user_1w:!1,notify_user_1d:!1,creation:a},{name:"OBC-2025-00004",employee:"HR-EMP-00004",employee_name:"Diana Prince",primary_email:"diana.prince@testcorp.com",event_type:"Security Review",effective_date:"2025-09-30T00:00:00",status:"Gaps Found",notes:"Scenario D: Admin MFA weak + DWD risk",notify_user_1w:!1,notify_user_1d:!1,creation:a},{name:"OBC-2025-00005",employee:"HR-EMP-00005",employee_name:"Eve Wilson",primary_email:"eve.wilson@testcorp.com",event_type:"Offboard",effective_date:"2025-08-15T00:00:00",status:"Scheduled",scheduled_remediation_date:i,notes:"Scenario E: Scheduled remediation",notify_user_1w:!0,notify_user_1d:!1,creation:a},{name:"OBC-2025-00006",employee:"HR-EMP-00006",employee_name:"Frank Castle",primary_email:"frank.castle@testcorp.com",event_type:"Offboard",effective_date:"2025-07-01T00:00:00",status:"Remediated",notes:"Scenario F: Already remediated",notify_user_1w:!1,notify_user_1d:!1,creation:a},{name:"OBC-2025-00007",employee:"HR-EMP-00007",employee_name:"Grace Lee",primary_email:"grace.lee@testcorp.com",event_type:"Offboard",effective_date:"2025-12-15T00:00:00",status:"Gaps Found",notes:"Scenario G: All clear after scan",notify_user_1w:!1,notify_user_1d:!1,creation:t},{name:"OBC-2025-00008",employee:"HR-EMP-00008",employee_name:"Henry Ford",primary_email:"henry.ford@testcorp.com",event_type:"Manual Check",effective_date:"2025-06-30T00:00:00",status:"Gaps Found",notes:"Scenario H: Mixed artifacts",notify_user_1w:!1,notify_user_1d:!1,creation:t},{name:"OBC-2025-00009",employee:"HR-EMP-00009",employee_name:"Ivy Chen",primary_email:"ivy.chen@testcorp.com",event_type:"Offboard",effective_date:"2025-11-30T00:00:00",status:"Gaps Found",notes:"Scenario I: Manual check needed",notify_user_1w:!1,notify_user_1d:!1,creation:t},{name:"OBC-2025-00010",employee:"HR-EMP-00010",employee_name:"Jack Daniels",primary_email:"jack.daniels@testcorp.com",event_type:"Offboard",effective_date:"2025-10-15T00:00:00",status:"Gaps Found",notes:"Scenario J: Heavy OAuth user",notify_user_1w:!1,notify_user_1d:!1,creation:t}],o=[{name:"ART-2025-00001",case:"OBC-2025-00001",artifact_type:"OAuthToken",subject_email:"alice.johnson@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive-001",risk_level:"High",scopes_json:'["https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.file"]',creation:a},{name:"ART-2025-00002",case:"OBC-2025-00001",artifact_type:"OAuthToken",subject_email:"alice.johnson@testcorp.com",status:"Active",app_display_name:"Slack",client_id:"client-slack-001",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/gmail.readonly","https://www.googleapis.com/auth/calendar.readonly"]',creation:a},{name:"ART-2025-00003",case:"OBC-2025-00001",artifact_type:"OAuthToken",subject_email:"alice.johnson@testcorp.com",status:"Active",app_display_name:"GitHub",client_id:"client-github-001",risk_level:"Critical",scopes_json:'["https://www.googleapis.com/auth/admin.directory.user","https://www.googleapis.com/auth/gmail.send"]',creation:a},{name:"ART-2025-00004",case:"OBC-2025-00002",artifact_type:"ASP",subject_email:"bob.smith@testcorp.com",status:"Active",app_display_name:"Thunderbird Mail",risk_level:"Medium",creation:a},{name:"ART-2025-00005",case:"OBC-2025-00002",artifact_type:"ASP",subject_email:"bob.smith@testcorp.com",status:"Active",app_display_name:"Outlook Desktop",risk_level:"Medium",creation:a},{name:"ART-2025-00006",case:"OBC-2025-00003",artifact_type:"LoginEvent",subject_email:"charlie.brown@testcorp.com",status:"Active",app_display_name:"Google Login",risk_level:"High",metadata_json:'{"ip":"203.0.113.45","login_time":"2025-10-25T14:30:00","user_agent":"Chrome/119"}',creation:t},{name:"ART-2025-00007",case:"OBC-2025-00004",artifact_type:"AdminMFA",subject_email:"diana.prince@testcorp.com",status:"Active",app_display_name:"Admin Console",risk_level:"Critical",creation:a},{name:"ART-2025-00008",case:"OBC-2025-00004",artifact_type:"DWDChange",subject_email:"diana.prince@testcorp.com",status:"Active",app_display_name:"Domain-Wide Delegation",risk_level:"Critical",metadata_json:'{"service_account":"sa@project.iam.gserviceaccount.com","scopes":["https://www.googleapis.com/auth/admin.directory.user"]}',creation:a},{name:"ART-2025-00009",case:"OBC-2025-00007",artifact_type:"OAuthToken",subject_email:"grace.lee@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive-001",risk_level:"High",scopes_json:'["https://www.googleapis.com/auth/drive"]',creation:t},{name:"ART-2025-00010",case:"OBC-2025-00007",artifact_type:"OAuthToken",subject_email:"grace.lee@testcorp.com",status:"Active",app_display_name:"Zoom",client_id:"client-zoom-001",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/calendar"]',creation:t},{name:"ART-2025-00011",case:"OBC-2025-00007",artifact_type:"OAuthToken",subject_email:"grace.lee@testcorp.com",status:"Active",app_display_name:"Notion",client_id:"client-notion-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/drive.readonly"]',creation:t},{name:"ART-2025-00012",case:"OBC-2025-00007",artifact_type:"ASP",subject_email:"grace.lee@testcorp.com",status:"Active",app_display_name:"Apple Mail",risk_level:"Medium",creation:t},{name:"ART-2025-00013",case:"OBC-2025-00008",artifact_type:"OAuthToken",subject_email:"henry.ford@testcorp.com",status:"Active",app_display_name:"Salesforce",client_id:"client-salesforce-001",risk_level:"High",scopes_json:'["https://www.googleapis.com/auth/contacts","https://www.googleapis.com/auth/gmail.send"]',creation:t},{name:"ART-2025-00014",case:"OBC-2025-00009",artifact_type:"OAuthToken",subject_email:"ivy.chen@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive-001",risk_level:"High",scopes_json:'["https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/drive.appdata"]',creation:t},{name:"ART-2025-00015",case:"OBC-2025-00009",artifact_type:"OAuthToken",subject_email:"ivy.chen@testcorp.com",status:"Active",app_display_name:"Jira",client_id:"client-jira-001",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/calendar","https://www.googleapis.com/auth/tasks"]',creation:t},{name:"ART-2025-00016",case:"OBC-2025-00009",artifact_type:"OAuthToken",subject_email:"ivy.chen@testcorp.com",status:"Active",app_display_name:"VS Code",client_id:"client-vscode-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/userinfo.profile"]',creation:t},{name:"ART-2025-00017",case:"OBC-2025-00009",artifact_type:"OAuthToken",subject_email:"ivy.chen@testcorp.com",status:"Active",app_display_name:"ChatGPT",client_id:"client-chatgpt-001",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/gmail.readonly"]',creation:t},{name:"ART-2025-00018",case:"OBC-2025-00009",artifact_type:"ASP",subject_email:"ivy.chen@testcorp.com",status:"Active",app_display_name:"Thunderbird",risk_level:"Medium",creation:t},{name:"ART-2025-00019",case:"OBC-2025-00009",artifact_type:"LoginEvent",subject_email:"ivy.chen@testcorp.com",status:"Active",app_display_name:"Google Login",risk_level:"High",metadata_json:'{"ip":"198.51.100.23","login_time":"2025-12-01T09:15:00","user_agent":"Firefox/120"}',creation:t},{name:"ART-2025-00020",case:"OBC-2025-00010",artifact_type:"OAuthToken",subject_email:"jack.daniels@testcorp.com",status:"Active",app_display_name:"Dropbox",client_id:"client-dropbox-001",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/drive.readonly"]',creation:t},{name:"ART-2025-00021",case:"",artifact_type:"OAuthToken",subject_email:"alice.johnson@testcorp.com",status:"Hidden",app_display_name:"Trello",client_id:"client-trello-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/tasks"]',creation:t},{name:"ART-2025-00022",case:"",artifact_type:"ASP",subject_email:"bob.smith@testcorp.com",status:"Hidden",app_display_name:"K-9 Mail",risk_level:"Medium",creation:t},{name:"ART-2025-00023",case:"OBC-2025-00001",artifact_type:"OAuthToken",subject_email:"alice.johnson@testcorp.com",status:"Revoked",app_display_name:"Figma",client_id:"client-figma-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/userinfo.profile"]',creation:a},{name:"ART-2025-00024",case:"",artifact_type:"OAuthToken",subject_email:"karen.white@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/drive"]',creation:t},{name:"ART-2025-00025",case:"",artifact_type:"OAuthToken",subject_email:"liam.neeson@testcorp.com",status:"Active",app_display_name:"Slack",client_id:"client-slack-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/gmail.readonly"]',creation:t},{name:"ART-2025-00026",case:"",artifact_type:"OAuthToken",subject_email:"karen.white@testcorp.com",status:"Active",app_display_name:"Figma",client_id:"client-figma-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/userinfo.profile"]',creation:t},{name:"ART-2025-00027",case:"",artifact_type:"OAuthToken",subject_email:"monica.geller@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/drive"]',creation:t},{name:"ART-2025-00028",case:"",artifact_type:"OAuthToken",subject_email:"monica.geller@testcorp.com",status:"Active",app_display_name:"Zoom",client_id:"client-zoom-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/calendar"]',creation:t},{name:"ART-2025-00029",case:"",artifact_type:"OAuthToken",subject_email:"nathan.drake@testcorp.com",status:"Active",app_display_name:"Jira",client_id:"client-jira-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/calendar"]',creation:t},{name:"ART-2025-00030",case:"",artifact_type:"OAuthToken",subject_email:"peter.parker@testcorp.com",status:"Active",app_display_name:"VS Code",client_id:"client-vscode-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/userinfo.profile"]',creation:t},{name:"ART-2025-00031",case:"",artifact_type:"OAuthToken",subject_email:"olivia.pope@testcorp.com",status:"Active",app_display_name:"Salesforce",client_id:"client-salesforce-001",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/contacts","https://www.googleapis.com/auth/gmail.send"]',creation:t},{name:"ART-2025-00032",case:"",artifact_type:"OAuthToken",subject_email:"olivia.pope@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/drive"]',creation:t},{name:"ART-2025-00033",case:"",artifact_type:"OAuthToken",subject_email:"rachel.green@testcorp.com",status:"Active",app_display_name:"Dropbox",client_id:"client-dropbox-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/drive.readonly"]',creation:t},{name:"ART-2025-00034",case:"",artifact_type:"ASP",subject_email:"quinn.hughes@testcorp.com",status:"Active",app_display_name:"Thunderbird Mail",risk_level:"Low",creation:t}],r=[{name:"FND-2025-00001",case:"OBC-2025-00001",finding_type:"LingeringOAuthGrant",severity:"Critical",summary:"OAuth grant for Google Drive discovered — full drive access persists after offboarding.",recommended_action:"Revoke the OAuth token for Google Drive immediately.",creation:a},{name:"FND-2025-00002",case:"OBC-2025-00001",finding_type:"LingeringOAuthGrant",severity:"High",summary:"OAuth grant for GitHub with admin.directory access still active.",recommended_action:"Revoke the GitHub OAuth token.",creation:a},{name:"FND-2025-00003",case:"OBC-2025-00002",finding_type:"LingeringASP",severity:"Medium",summary:"App-Specific Password for Thunderbird Mail still active.",recommended_action:"Delete the ASP for Thunderbird.",creation:a},{name:"FND-2025-00004",case:"OBC-2025-00003",finding_type:"PostOffboardLogin",severity:"High",summary:"Post-offboard login detected from IP 203.0.113.45 via Chrome.",recommended_action:"Sign out all sessions and investigate.",creation:t},{name:"FND-2025-00005",case:"OBC-2025-00004",finding_type:"AdminMFAWeak",severity:"Critical",summary:"Admin account without strong 2FA — only SMS verification enabled.",recommended_action:"Enforce hardware security key for admin accounts.",creation:a},{name:"FND-2025-00006",case:"OBC-2025-00004",finding_type:"DWDHighRisk",severity:"Critical",summary:"Domain-Wide Delegation grant to service account with admin.directory scope.",recommended_action:"Review and restrict DWD scopes.",creation:a},{name:"FND-2025-00007",case:"OBC-2025-00007",finding_type:"LingeringOAuthGrant",severity:"High",summary:"OAuth grant for Google Drive persists after offboarding.",recommended_action:"Revoke Drive token.",creation:t},{name:"FND-2025-00008",case:"OBC-2025-00007",finding_type:"LingeringOAuthGrant",severity:"Medium",summary:"OAuth grant for Zoom with calendar access.",recommended_action:"Revoke Zoom token.",creation:t},{name:"FND-2025-00009",case:"OBC-2025-00007",finding_type:"LingeringASP",severity:"Medium",summary:"ASP for Apple Mail still active.",recommended_action:"Delete the ASP.",creation:t},{name:"FND-2025-00010",case:"OBC-2025-00008",finding_type:"LingeringOAuthGrant",severity:"High",summary:"OAuth grant for Salesforce with contacts and gmail.send access.",recommended_action:"Revoke Salesforce token.",creation:t},{name:"FND-2025-00011",case:"OBC-2025-00009",finding_type:"LingeringOAuthGrant",severity:"Critical",summary:"OAuth grant for Google Drive with full drive + appdata access.",recommended_action:"Revoke all Drive tokens immediately.",creation:t},{name:"FND-2025-00012",case:"OBC-2025-00009",finding_type:"LingeringOAuthGrant",severity:"Medium",summary:"OAuth grant for Jira with calendar and tasks access.",recommended_action:"Revoke Jira token.",creation:t},{name:"FND-2025-00013",case:"OBC-2025-00009",finding_type:"PostOffboardLogin",severity:"High",summary:"Post-offboard login detected from IP 198.51.100.23 via Firefox.",recommended_action:"Sign out all sessions.",creation:t},{name:"FND-2025-00014",case:"OBC-2025-00009",finding_type:"LingeringASP",severity:"Medium",summary:"ASP for Thunderbird still active after offboarding.",recommended_action:"Delete ASP.",creation:t},{name:"FND-2025-00015",case:"OBC-2025-00010",finding_type:"LingeringOAuthGrant",severity:"Medium",summary:"OAuth grant for Dropbox with drive.readonly access.",recommended_action:"Revoke Dropbox token.",creation:t},{name:"FND-2025-00017",case:"OBC-2025-00001",finding_type:"LingeringOAuthGrant",severity:"Medium",summary:"OAuth grant for Slack with gmail.readonly and calendar.readonly access still active.",recommended_action:"Revoke Slack token.",creation:a},{name:"FND-2025-00018",case:"OBC-2025-00002",finding_type:"LingeringASP",severity:"Medium",summary:"App-Specific Password for Outlook Desktop still active.",recommended_action:"Delete the ASP for Outlook.",creation:a},{name:"FND-2025-00019",case:"OBC-2025-00007",finding_type:"LingeringOAuthGrant",severity:"Low",summary:"OAuth grant for Notion with drive.readonly access — low risk but should be cleaned up.",recommended_action:"Revoke Notion token.",creation:t},{name:"FND-2025-00020",case:"OBC-2025-00009",finding_type:"LingeringOAuthGrant",severity:"Low",summary:"OAuth grant for VS Code with userinfo.profile scope only.",recommended_action:"Revoke VS Code token.",creation:t},{name:"FND-2025-00021",case:"OBC-2025-00009",finding_type:"LingeringOAuthGrant",severity:"Medium",summary:"OAuth grant for ChatGPT with gmail.readonly access.",recommended_action:"Revoke ChatGPT token.",creation:t},{name:"FND-2025-00022",case:"OBC-2025-00010",finding_type:"LingeringOAuthGrant",severity:"Medium",summary:"OAuth grant for Dropbox with drive.readonly access — medium risk.",recommended_action:"Revoke Dropbox token.",creation:t},{name:"FND-2025-00016",case:"OBC-2025-00006",finding_type:"LingeringOAuthGrant",severity:"High",summary:"OAuth grant for Slack — remediated.",recommended_action:"None — resolved.",closed_at:a,creation:a}],c=[{name:"AUD-2025-00001",actor_user:"Administrator",action_type:"CaseCreated",target_email:"alice.johnson@testcorp.com",result:"Success",request_json:'{"case":"OBC-2025-00001"}',timestamp:a,creation:a},{name:"AUD-2025-00006",actor_user:"Administrator",action_type:"RemediationStarted",target_email:"frank.castle@testcorp.com",result:"Success",request_json:'{"case":"OBC-2025-00006","action":"full_bundle"}',timestamp:a,creation:a},{name:"AUD-2025-00007",actor_user:"Administrator",action_type:"RemediationCompleted",target_email:"frank.castle@testcorp.com",result:"Success",request_json:'{"case":"OBC-2025-00006","action":"full_bundle","artifacts_remediated":2}',timestamp:a,creation:a},{name:"AUD-2025-00008",actor_user:"Administrator",action_type:"TokenRevoked",target_email:"alice.johnson@testcorp.com",result:"Success",request_json:'{"artifact":"ART-2025-00023","client_id":"client-figma-001"}',timestamp:a,creation:a}];var l=e.i(92749);function m(e){return JSON.parse(JSON.stringify(e))}let _="http://localhost:8000",d=process.env.FRAPPE_ADMIN_USER||"Administrator",p=process.env.FRAPPE_ADMIN_PASS||"admin",u={data:null,ts:0};async function f(){if("u">typeof process&&process.env?.VITEST)return null;if(u.data&&Date.now()-u.ts<6e4)return u.data;try{let e=await fetch(`${_}/api/method/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usr:d,pwd:p})});if(!e.ok)return null;let t=e.headers.getSetCookie?.()??[],a=t.length?t.map(e=>e.split(";")[0]).join("; "):e.headers.get("set-cookie")?.split(",").map(e=>e.trim().split(";")[0]).join("; ")??"",i=new URLSearchParams({fields:JSON.stringify(["name","employee_name","company_email","status","department","designation","date_of_joining","relieving_date","company"]),limit_page_length:"0"}),n=await fetch(`${_}/api/resource/Employee?${i}`,{headers:{Accept:"application/json",Cookie:a}});if(!n.ok)return null;let s=((await n.json()).data||[]).map(e=>({employee_id:e.name,employee_name:e.employee_name||"",company_email:e.company_email||"",emp_status:"Left"===e.status?"Left":"Suspended"===e.status?"Suspended":"Active",date_of_joining:e.date_of_joining||void 0,relieving_date:e.relieving_date||void 0,department:e.department||void 0,designation:e.designation||void 0,company:e.company||void 0}));return u={data:s,ts:Date.now()},s}catch{return null}}async function g(){return await f()??m(n)}let y=m(s),h=m(o),v=m(r),A=m(c),w=m({auto_scan_on_offboard:!0,auto_remediate_on_offboard:!1,background_scan_enabled:!0,auto_create_case_on_leave:!0,background_scan_interval:"Every 5 Minutes",remediation_check_interval:"Every 5 Minutes",notify_on_new_findings:!0,notify_on_remediation:!0,notification_email:"igordjuric404@gmail.com",default_remediation_action:"full_bundle"}),k=0;function O(e,t,a){k++,A.unshift({name:`AUD-MOCK-${Date.now()}-${k}`,actor_user:"Administrator",action_type:e,target_email:t,result:"Success",request_json:JSON.stringify(a||{}),timestamp:new Date().toISOString(),creation:new Date().toISOString()})}class S{name="mock";async authenticate(e,t){if("Administrator"===e&&"admin"===t)return{user:"Administrator",full_name:"Admin User",roles:["System Manager","HR Manager"]};if("hr@testcorp.com"===e&&"admin"===t)return{user:"hr@testcorp.com",full_name:"HR Manager",roles:["HR Manager"]};throw Error("Invalid credentials. Use Administrator/admin or hr@testcorp.com/admin")}async logout(){}async getSession(){return{user:"Administrator",full_name:"Admin User",roles:["System Manager","HR Manager"]}}async getDashboardStats(){this._checkOverdueRemediations();let e=Date.now(),t=y.filter(e=>["Draft","Scheduled"].includes(e.status)).length,a=new Set(v.filter(e=>"Critical"===e.severity&&!e.closed_at).map(e=>e.case)),i=h.filter(t=>"OAuthToken"===t.artifact_type&&"Active"===t.status&&t.creation&&e-new Date(t.creation).getTime()<6048e5),n=h.filter(t=>"OAuthToken"===t.artifact_type&&"Active"===t.status&&t.creation&&e-new Date(t.creation).getTime()<2592e6),s=v.filter(t=>["PostOffboardLogin","PostOffboardSuspiciousLogin"].includes(t.finding_type)&&t.creation&&e-new Date(t.creation).getTime()<6048e5),o=this._getTopApps(),r=y.filter(e=>!["Closed","Remediated"].includes(e.status)).map(e=>{let t=v.filter(t=>t.case===e.name);return{case_name:e.name,primary_email:e.primary_email,employee_name:e.employee_name,status:e.status,effective_date:e.effective_date,finding_count:t.length,critical_count:t.filter(e=>"Critical"===e.severity).length}}).sort((e,t)=>t.critical_count-e.critical_count||t.finding_count-e.finding_count).slice(0,10);return{kpis:{pending_scan:t,critical_gaps:a.size,oauth_grants_7d:i.length,oauth_grants_30d:n.length,post_offboard_logins_7d:s.length,post_offboard_logins_30d:s.length,total_cases:y.length,total_findings:v.length,total_artifacts:h.length},top_oauth_apps:o,risky_cases:r}}async getStatistics(){return{mean_time_to_enforce_hours:48.5,top_apps_by_exposure:this._getTopApps(),scope_heatmap:[{scope:"googleapis.com/auth/drive",count:8},{scope:"googleapis.com/auth/gmail",count:5},{scope:"googleapis.com/auth/calendar",count:4},{scope:"googleapis.com/auth/admin",count:3}],residual_access_trend:[{week:"202548",finding_count:2},{week:"202549",finding_count:4},{week:"202550",finding_count:3},{week:"202551",finding_count:5}]}}async listCases(){return this._checkOverdueRemediations(),m(y)}async getCaseDetail(e){this._checkOverdueRemediations();let t=y.find(t=>t.name===e);if(!t)throw Error(`Case not found: ${e}`);let a=h.filter(t=>t.case===e&&"Hidden"!==t.status),i=v.filter(t=>t.case===e),n=A.filter(e=>e.target_email===t.primary_email);return{case:m(t),artifacts:{tokens:a.filter(e=>"OAuthToken"===e.artifact_type),asps:a.filter(e=>"ASP"===e.artifact_type),login_events:a.filter(e=>"LoginEvent"===e.artifact_type),other:a.filter(e=>!["OAuthToken","ASP","LoginEvent"].includes(e.artifact_type)),total:a.length},findings:i,audit_logs:n}}async createCase(e){let t={name:`OBC-MOCK-${Date.now()}`,employee:e.employee||"",employee_name:e.employee_name||"",primary_email:e.primary_email||"",event_type:e.event_type||"Offboard",effective_date:e.effective_date||new Date().toISOString(),status:"Draft",notify_user_1w:!1,notify_user_1d:!1,notes:e.notes,creation:new Date().toISOString()};return y.unshift(t),O("CaseCreated",t.primary_email,{case:t.name}),m(t)}async createCaseFromEmployee(e){let t=(await g()).find(t=>t.employee_id===e);if(!t)throw Error(`Employee not found: ${e}`);return this.createCase({employee:e,employee_name:t.employee_name,primary_email:t.company_email,event_type:"Offboard"})}async updateCase(e,t){let a=y.findIndex(t=>t.name===e);if(-1===a)throw Error(`Case not found: ${e}`);return y[a]={...y[a],...t},m(y[a])}async triggerScan(e){let t=y.find(t=>t.name===e);if(!t)throw Error(`Case not found: ${e}`);O("ScanStarted",t.primary_email,{case:e});let a=h.filter(t=>t.case===e&&"Active"===t.status).length,i=v.filter(t=>t.case===e&&!t.closed_at).length;return t.status=a>0||i>0?"Gaps Found":"All Clear",O("ScanFinished",t.primary_email,{case:e,active_artifacts:a,open_findings:i,new_status:t.status}),{status:"success",message:`Scan completed for ${t.primary_email}`}}async systemScan(){O("ScanStarted","SYSTEM",{scan_type:"system_scan"});let e=h.filter(e=>"Hidden"===e.status),t=0;for(let a of e){let e=y.find(e=>e.primary_email===a.subject_email&&!["Closed"].includes(e.status));if(!e){let t=(await g()).find(e=>e.company_email===a.subject_email);e={name:`OBC-MOCK-${Date.now()}-${Math.random().toString(36).slice(2,7)}`,employee:t?.employee_id||"",employee_name:t?.employee_name||"",primary_email:a.subject_email,event_type:"Offboard",effective_date:new Date().toISOString(),status:"Gaps Found",notify_user_1w:!1,notify_user_1d:!1,creation:new Date().toISOString()},y.push(e)}a.status="Active",a.case=e.name,e.status="Gaps Found";let i={OAuthToken:"LingeringOAuthGrant",ASP:"LingeringASP",LoginEvent:"PostOffboardLogin",AdminMFA:"AdminMFAWeak",DWDChange:"DWDHighRisk"}[a.artifact_type]||"LingeringOAuthGrant";v.push({name:`FND-MOCK-${Date.now()}-${t}`,case:e.name,finding_type:i,severity:a.risk_level||"Medium",summary:`${a.app_display_name||"Unknown"} discovered during system scan for ${a.subject_email}.`,recommended_action:"Review and remediate.",creation:new Date().toISOString()}),t++}if(O("ScanFinished","SYSTEM",{scan_type:"system_scan",discoveries:t}),w.notify_on_new_findings&&t>0)for(let e of v.filter(e=>!e.closed_at&&("Critical"===e.severity||"High"===e.severity)).slice(-t)){let t=y.find(t=>t.name===e.case);(0,l.sendFindingAlert)({findingName:e.name,severity:e.severity,findingType:e.finding_type,summary:e.summary,caseName:e.case,employeeEmail:t?.primary_email||"unknown"},w.notification_email||void 0).catch(()=>{})}return{status:"success",message:`System scan found ${t} new issue(s).`}}async getScanHistory(){let e=A.filter(e=>["ScanStarted","ScanFinished"].includes(e.action_type)),t=[];for(let a of e){if("ScanStarted"!==a.action_type)continue;let i=JSON.parse(a.request_json||"{}"),n=e.find(e=>"ScanFinished"===e.action_type&&e.target_email===a.target_email),s=n?JSON.parse(n.request_json||"{}"):{};t.push({scan_id:a.name,case:i.case||"",target_email:a.target_email,trigger:a.actor_user?.includes("Scheduler")?"automatic":"manual",actor:a.actor_user,started_at:a.timestamp,result:n?"Completed":"Pending",new_status:s.new_status||"",active_artifacts:s.active_artifacts||0,open_findings:s.open_findings,findings_link:i.case?`/findings?case=${i.case}`:""})}return t}async executeRemediation(e,t){let a=y.find(t=>t.name===e);if(!a)throw Error(`Case not found: ${e}`);if(O("RemediationStarted",a.primary_email,{case:e,action:t}),"full_bundle"===t){let i=h.filter(t=>t.case===e&&"Active"===t.status);for(let e of i)e.status="ASP"===e.artifact_type?"Deleted":"Revoked";let n=v.filter(t=>t.case===e&&!t.closed_at);for(let e of n)e.closed_at=new Date().toISOString();return a.status="Remediated",O("RemediationCompleted",a.primary_email,{case:e,action:t,artifacts_remediated:i.length}),{status:"success",action:t,artifacts_remediated:i.length,findings_closed:n.length}}if("revoke_token"===t){let a=h.filter(t=>t.case===e&&"OAuthToken"===t.artifact_type&&"Active"===t.status);for(let e of a)e.status="Revoked";return this._closeFindingsForCase(e,["LingeringOAuthGrant"]),this._rescanCase(e),{status:"success",action:t,revoked:a.length}}if("delete_asp"===t){let a=h.filter(t=>t.case===e&&"ASP"===t.artifact_type&&"Active"===t.status);for(let e of a)e.status="Deleted";return this._closeFindingsForCase(e,["LingeringASP"]),this._rescanCase(e),{status:"success",action:t,deleted:a.length}}if("sign_out"===t){for(let t of h.filter(t=>t.case===e&&"LoginEvent"===t.artifact_type&&"Active"===t.status))t.status="Acknowledged";return this._closeFindingsForCase(e,["PostOffboardLogin","PostOffboardSuspiciousLogin"]),this._rescanCase(e),{status:"success",action:t}}throw Error(`Unknown action: ${t}`)}async bulkRemediate(e,t){let a=0,i=0;for(let e of t){let t=h.find(t=>t.name===e);t&&("OAuthToken"===t.artifact_type?(t.status="Revoked",a++):"ASP"===t.artifact_type&&(t.status="Deleted",i++))}return this._rescanCase(e),{status:"success",revoked:a,deleted:i}}async remediateArtifacts(e){let t=0,a=0,i=new Set;for(let n of e){let e=h.find(e=>e.name===n);e&&"Active"===e.status&&("OAuthToken"===e.artifact_type?(e.status="Revoked",t++):"ASP"===e.artifact_type?(e.status="Deleted",a++):e.status="Acknowledged",e.case&&i.add(e.case))}for(let e of i)this._rescanCase(e);return{status:"success",revoked:t,deleted:a}}async runScheduledRemediationNow(e){return this.executeRemediation(e,"full_bundle")}async listArtifacts(e){let t=m(h);return e&&(e.status&&(t=t.filter(t=>t.status===e.status)),e.case&&(t=t.filter(t=>t.case===e.case)),e.artifact_type&&(t=t.filter(t=>t.artifact_type===e.artifact_type))),t}async getArtifact(e){let t=h.find(t=>t.name===e);if(!t)throw Error(`Artifact not found: ${e}`);return m(t)}async listFindings(e){let t=m(v);return e&&(e.case&&(t=t.filter(t=>t.case===e.case)),e.severity&&(t=t.filter(t=>t.severity===e.severity)),e.finding_type&&(t=t.filter(t=>t.finding_type===e.finding_type))),t}async getFinding(e){let t=v.find(t=>t.name===e);if(!t)throw Error(`Finding not found: ${e}`);return m(t)}async remediateFinding(e){let t=v.find(t=>t.name===e);if(!t)throw Error(`Finding not found: ${e}`);if(t.closed_at)throw Error(`Finding already closed: ${e}`);t.closed_at=new Date().toISOString();let a=h.filter(e=>e.case===t.case&&"Active"===e.status),i={LingeringOAuthGrant:["OAuthToken"],LingeringASP:["ASP"],PostOffboardLogin:["LoginEvent"],PostOffboardSuspiciousLogin:["LoginEvent"],AdminMFAWeak:["AdminMFA"],DWDHighRisk:["DWDChange"]}[t.finding_type]||[],n=0;for(let e of a)i.includes(e.artifact_type)&&(e.status="ASP"===e.artifact_type?"Deleted":"Revoked",n++);return O("RemediationCompleted",t.case,{finding:e,artifacts_remediated:n}),this._rescanCase(t.case),{status:"success",artifacts_remediated:n,findings_closed:1}}async getEmployeeList(){return(await g()).map(e=>{let t=y.filter(t=>t.employee===e.employee_id),a=t.map(e=>e.name),i=[...h.filter(e=>a.includes(e.case)),...h.filter(t=>t.subject_email===e.company_email&&!t.case)],n=v.filter(e=>a.includes(e.case));return{...e,case_count:t.length,active_artifacts:i.filter(e=>"Active"===e.status).length,open_findings:n.filter(e=>!e.closed_at).length}})}async getEmployeeDetail(e){let t=(await g()).find(t=>t.employee_id===e);if(!t)throw Error(`Employee not found: ${e}`);let a=y.filter(t=>t.employee===e),i=a.map(e=>e.name),n=[...h.filter(e=>i.includes(e.case)),...h.filter(e=>e.subject_email===t.company_email&&!e.case)],s=v.filter(e=>i.includes(e.case)),o={};for(let e of n)if("OAuthToken"===e.artifact_type&&e.app_display_name){let t=e.client_id||e.app_display_name;o[t]||(o[t]={app_name:e.app_display_name,client_id:e.client_id||"",status:e.status,risk_level:e.risk_level,artifact_name:e.name})}return{employee:{id:t.employee_id,name:t.employee_name,email:t.company_email,status:t.emp_status,date_of_joining:t.date_of_joining,relieving_date:t.relieving_date,department:t.department,designation:t.designation,company:t.company},cases:a,artifacts:n,findings:s,apps:Object.values(o),summary:{total_cases:a.length,active_artifacts:n.filter(e=>"Active"===e.status).length,open_findings:s.filter(e=>!e.closed_at).length,apps_used:Object.keys(o).length}}}async revokeEmployeeAccess(e,t){let a=y.filter(t=>t.employee===e&&!["Closed","Remediated"].includes(t.status)),i=0,n=0;for(let e of a){let a=await this.executeRemediation(e.name,"tokens"===t?"revoke_token":"asps"===t?"delete_asp":"full_bundle");i+=a.artifacts_remediated||a.revoked||a.deleted||0,n+=a.findings_closed||0}return{status:"success",artifacts_remediated:i,findings_closed:n}}async getAllActiveOAuthApps(){let e={};for(let t of h)"OAuthToken"===t.artifact_type&&"Active"===t.status&&t.client_id&&(e[t.client_id]||(e[t.client_id]={client_id:t.client_id,app_display_name:t.app_display_name||"Unknown",grant_count:0,user_count:0,case_count:0}),e[t.client_id].grant_count++);for(let t of Object.keys(e)){let a=h.filter(e=>e.client_id===t&&"Active"===e.status);e[t].user_count=new Set(a.map(e=>e.subject_email)).size,e[t].case_count=new Set(a.map(e=>e.case).filter(Boolean)).size}return Object.values(e).sort((e,t)=>t.grant_count-e.grant_count)}async getAppDetail(e){let t=h.filter(t=>t.client_id===e&&"OAuthToken"===t.artifact_type),a=t[0]?.app_display_name||e,i=new Set,n=t.map(e=>{let t=JSON.parse(e.scopes_json||"[]");return t.forEach(e=>{let t=e.split("/");i.add(t[t.length-1]||e)}),{email:e.subject_email,status:e.status,risk_level:e.risk_level,case:e.case||"",artifact_name:e.name,granted:e.creation||"",scopes:t.map(e=>{let t=e.split("/"),a=t[t.length-1]||e;return{scope:a,full:e,level:/send|modify|compose|write|admin|manage/i.test(a)?"write":"read"}}),raw_scopes:t}});return{client_id:e,app_name:a,total_grants:t.length,active_grants:t.filter(e=>"Active"===e.status).length,revoked_grants:t.filter(e=>"Revoked"===e.status).length,cases_affected:[...new Set(t.map(e=>e.case).filter(Boolean))],scopes:[...i].sort(),users:n}}async globalAppRemoval(e,t){let a=h.filter(t=>t.client_id===e&&"Active"===t.status&&"OAuthToken"===t.artifact_type),i=new Set;for(let e of a)e.status="Revoked",e.case&&i.add(e.case);for(let e of i)this._rescanCase(e);return O("GlobalAppRemoval","",{client_id:e,app_name:t,revoked:a.length}),{status:"success",revoked:a.length}}async revokeAppForUsers(e,t){let a=0,i=new Set;for(let e of t){let t=h.find(t=>t.name===e);t&&"Active"===t.status&&"OAuthToken"===t.artifact_type&&(t.status="Revoked",a++,t.case&&i.add(t.case))}for(let e of i)this._rescanCase(e);return{status:"success",revoked:a}}async restoreAppForUsers(e,t){let a=0,i=new Set;for(let e of t){let t=h.find(t=>t.name===e);t&&"Revoked"===t.status&&"OAuthToken"===t.artifact_type&&(t.status="Active",a++,t.case&&i.add(t.case))}for(let e of i)this._rescanCase(e);return{status:"success",artifacts_remediated:a}}async updateUserScopes(e,t){let a=h.find(t=>t.name===e);if(!a)throw Error(`Artifact not found: ${e}`);let i=JSON.parse(a.scopes_json||"[]");a.scopes_json=JSON.stringify(t),t.length||"Active"!==a.status?t.length&&"Revoked"===a.status&&(a.status="Active"):a.status="Revoked";let n=i.filter(e=>!t.includes(e)).length,s=t.filter(e=>!i.includes(e)).length;return a.case&&this._rescanCase(a.case),{removed:n,added:s}}async listAuditLogs(){return m(A)}async getSettings(){return m(w)}async updateSettings(e){return m(w={...w,...e})}async chat(t){let{chat:a}=await e.A(54006);return a(t,{apiKey:process.env.OPENROUTER_API_KEY,liveDataProvider:{getCaseCounts:async()=>{let e={};for(let t of["Draft","Scheduled","All Clear","Gaps Found","Remediated","Closed"]){let a=y.filter(e=>e.status===t).length;a>0&&(e[t]=a)}return e},getTotalCases:async()=>y.length,getOpenFindings:async()=>v.filter(e=>!e.closed_at).length,getTotalFindings:async()=>v.length,getCriticalFindings:async()=>v.filter(e=>"Critical"===e.severity&&!e.closed_at).length,getActiveArtifacts:async()=>h.filter(e=>"Active"===e.status).length,getTotalArtifacts:async()=>h.length,getHiddenArtifacts:async()=>h.filter(e=>"Hidden"===e.status).length,getOffboardedEmployees:async()=>(await g()).filter(e=>"Left"===e.emp_status).length}})}_getTopApps(){let e={};for(let t of h)"OAuthToken"===t.artifact_type&&"Active"===t.status&&t.client_id&&(e[t.client_id]||(e[t.client_id]={client_id:t.client_id,app_display_name:t.app_display_name||"Unknown",grant_count:0}),e[t.client_id].grant_count++);return Object.values(e).sort((e,t)=>t.grant_count-e.grant_count).slice(0,10)}_closeFindingsForCase(e,t){for(let a of v)a.case===e&&t.includes(a.finding_type)&&!a.closed_at&&(a.closed_at=new Date().toISOString())}_checkOverdueRemediations(){let e=new Date;for(let t of y)if("Scheduled"===t.status&&t.scheduled_remediation_date&&new Date(t.scheduled_remediation_date)<=e){let a=h.filter(e=>e.case===t.name&&"Active"===e.status);for(let e of a)e.status="ASP"===e.artifact_type?"Deleted":"Revoked";let i=v.filter(e=>e.case===t.name&&!e.closed_at);for(let t of i)t.closed_at=e.toISOString();t.status="Remediated",O("ScheduledRemediationExecuted",t.primary_email,{case:t.name,scheduled_for:t.scheduled_remediation_date,artifacts_remediated:a.length,findings_closed:i.length})}}_rescanCase(e){let t=y.find(t=>t.name===e);if(!t)return;let a=h.filter(t=>t.case===e&&"Active"===t.status).length,i=v.filter(t=>t.case===e&&!t.closed_at).length;0===a&&0===i?["Gaps Found","Draft","Scheduled"].includes(t.status)&&(t.status="Remediated"):t.status="Gaps Found"}}let C=null;function T(){return C||(C=new S)}e.s(["getProvider",()=>T],24223)}];

//# sourceMappingURL=src_lib_providers_index_ts_b0ab9515._.js.map