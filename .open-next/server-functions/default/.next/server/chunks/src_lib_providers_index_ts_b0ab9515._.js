module.exports=[24223,e=>{"use strict";new Date().toISOString();let t=new Date(Date.now()-6048e5).toISOString(),a=new Date(Date.now()-2592e6).toISOString(),i=new Date(Date.now()+12096e5).toISOString(),n=[{employee_id:"HR-EMP-00001",employee_name:"Alice Johnson",company_email:"alice.johnson@testcorp.com",emp_status:"Left",date_of_joining:"2020-03-15",relieving_date:"2025-12-01",department:"Engineering",designation:"Senior Developer",company:"Test Corp",case_count:1,active_artifacts:3,open_findings:3},{employee_id:"HR-EMP-00002",employee_name:"Bob Smith",company_email:"bob.smith@testcorp.com",emp_status:"Left",date_of_joining:"2019-06-01",relieving_date:"2025-11-15",department:"Marketing",designation:"Marketing Manager",company:"Test Corp",case_count:1,active_artifacts:2,open_findings:2},{employee_id:"HR-EMP-00003",employee_name:"Charlie Brown",company_email:"charlie.brown@testcorp.com",emp_status:"Left",date_of_joining:"2021-01-10",relieving_date:"2025-10-20",department:"Sales",designation:"Sales Rep",company:"Test Corp",case_count:1,active_artifacts:1,open_findings:1},{employee_id:"HR-EMP-00004",employee_name:"Diana Prince",company_email:"diana.prince@testcorp.com",emp_status:"Left",date_of_joining:"2018-09-01",relieving_date:"2025-09-30",department:"IT",designation:"IT Admin",company:"Test Corp",case_count:1,active_artifacts:2,open_findings:2},{employee_id:"HR-EMP-00005",employee_name:"Eve Wilson",company_email:"eve.wilson@testcorp.com",emp_status:"Left",date_of_joining:"2020-07-15",relieving_date:"2025-08-15",department:"HR",designation:"HR Specialist",company:"Test Corp",case_count:1,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00006",employee_name:"Frank Castle",company_email:"frank.castle@testcorp.com",emp_status:"Left",date_of_joining:"2017-04-20",relieving_date:"2025-07-01",department:"Engineering",designation:"DevOps Engineer",company:"Test Corp",case_count:1,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00007",employee_name:"Grace Lee",company_email:"grace.lee@testcorp.com",emp_status:"Left",date_of_joining:"2021-11-01",relieving_date:"2025-12-15",department:"Finance",designation:"Accountant",company:"Test Corp",case_count:1,active_artifacts:4,open_findings:4},{employee_id:"HR-EMP-00008",employee_name:"Henry Ford",company_email:"henry.ford@testcorp.com",emp_status:"Left",date_of_joining:"2019-02-14",relieving_date:"2025-06-30",department:"Legal",designation:"Legal Counsel",company:"Test Corp",case_count:1,active_artifacts:1,open_findings:1},{employee_id:"HR-EMP-00009",employee_name:"Ivy Chen",company_email:"ivy.chen@testcorp.com",emp_status:"Left",date_of_joining:"2022-05-01",relieving_date:"2025-11-30",department:"Engineering",designation:"Backend Developer",company:"Test Corp",case_count:1,active_artifacts:6,open_findings:6},{employee_id:"HR-EMP-00010",employee_name:"Jack Daniels",company_email:"jack.daniels@testcorp.com",emp_status:"Left",date_of_joining:"2020-08-01",relieving_date:"2025-10-15",department:"Support",designation:"Support Lead",company:"Test Corp",case_count:1,active_artifacts:1,open_findings:1},{employee_id:"HR-EMP-00011",employee_name:"Karen White",company_email:"karen.white@testcorp.com",emp_status:"Active",date_of_joining:"2021-03-10",department:"Engineering",designation:"Frontend Developer",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00012",employee_name:"Liam Neeson",company_email:"liam.neeson@testcorp.com",emp_status:"Active",date_of_joining:"2019-11-20",department:"Marketing",designation:"Content Writer",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00013",employee_name:"Monica Geller",company_email:"monica.geller@testcorp.com",emp_status:"Active",date_of_joining:"2020-01-05",department:"Operations",designation:"Operations Manager",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00014",employee_name:"Nathan Drake",company_email:"nathan.drake@testcorp.com",emp_status:"Active",date_of_joining:"2022-06-15",department:"Engineering",designation:"QA Engineer",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00015",employee_name:"Olivia Pope",company_email:"olivia.pope@testcorp.com",emp_status:"Active",date_of_joining:"2018-12-01",department:"Executive",designation:"VP Operations",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00016",employee_name:"Peter Parker",company_email:"peter.parker@testcorp.com",emp_status:"Active",date_of_joining:"2023-01-20",department:"Engineering",designation:"Intern",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00017",employee_name:"Quinn Hughes",company_email:"quinn.hughes@testcorp.com",emp_status:"Active",date_of_joining:"2021-08-30",department:"Design",designation:"UI Designer",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0},{employee_id:"HR-EMP-00018",employee_name:"Rachel Green",company_email:"rachel.green@testcorp.com",emp_status:"Active",date_of_joining:"2020-04-15",department:"Sales",designation:"Account Executive",company:"Test Corp",case_count:0,active_artifacts:0,open_findings:0}],s=[{name:"OBC-2025-00001",employee:"HR-EMP-00001",employee_name:"Alice Johnson",primary_email:"alice.johnson@testcorp.com",event_type:"Offboard",effective_date:"2025-12-01T00:00:00",status:"Gaps Found",notes:"Scenario A: Multiple OAuth tokens lingering",notify_user_1w:!1,notify_user_1d:!1,creation:a},{name:"OBC-2025-00002",employee:"HR-EMP-00002",employee_name:"Bob Smith",primary_email:"bob.smith@testcorp.com",event_type:"Offboard",effective_date:"2025-11-15T00:00:00",status:"Gaps Found",notes:"Scenario B: ASPs still active",notify_user_1w:!1,notify_user_1d:!1,creation:a},{name:"OBC-2025-00003",employee:"HR-EMP-00003",employee_name:"Charlie Brown",primary_email:"charlie.brown@testcorp.com",event_type:"Offboard",effective_date:"2025-10-20T00:00:00",status:"Gaps Found",notes:"Scenario C: Post-offboard login detected",notify_user_1w:!1,notify_user_1d:!1,creation:a},{name:"OBC-2025-00004",employee:"HR-EMP-00004",employee_name:"Diana Prince",primary_email:"diana.prince@testcorp.com",event_type:"Security Review",effective_date:"2025-09-30T00:00:00",status:"Gaps Found",notes:"Scenario D: Admin MFA weak + DWD risk",notify_user_1w:!1,notify_user_1d:!1,creation:a},{name:"OBC-2025-00005",employee:"HR-EMP-00005",employee_name:"Eve Wilson",primary_email:"eve.wilson@testcorp.com",event_type:"Offboard",effective_date:"2025-08-15T00:00:00",status:"Scheduled",scheduled_remediation_date:i,notes:"Scenario E: Scheduled remediation",notify_user_1w:!0,notify_user_1d:!1,creation:a},{name:"OBC-2025-00006",employee:"HR-EMP-00006",employee_name:"Frank Castle",primary_email:"frank.castle@testcorp.com",event_type:"Offboard",effective_date:"2025-07-01T00:00:00",status:"Remediated",notes:"Scenario F: Already remediated",notify_user_1w:!1,notify_user_1d:!1,creation:a},{name:"OBC-2025-00007",employee:"HR-EMP-00007",employee_name:"Grace Lee",primary_email:"grace.lee@testcorp.com",event_type:"Offboard",effective_date:"2025-12-15T00:00:00",status:"Gaps Found",notes:"Scenario G: All clear after scan",notify_user_1w:!1,notify_user_1d:!1,creation:t},{name:"OBC-2025-00008",employee:"HR-EMP-00008",employee_name:"Henry Ford",primary_email:"henry.ford@testcorp.com",event_type:"Manual Check",effective_date:"2025-06-30T00:00:00",status:"Gaps Found",notes:"Scenario H: Mixed artifacts",notify_user_1w:!1,notify_user_1d:!1,creation:t},{name:"OBC-2025-00009",employee:"HR-EMP-00009",employee_name:"Ivy Chen",primary_email:"ivy.chen@testcorp.com",event_type:"Offboard",effective_date:"2025-11-30T00:00:00",status:"Gaps Found",notes:"Scenario I: Manual check needed",notify_user_1w:!1,notify_user_1d:!1,creation:t},{name:"OBC-2025-00010",employee:"HR-EMP-00010",employee_name:"Jack Daniels",primary_email:"jack.daniels@testcorp.com",event_type:"Offboard",effective_date:"2025-10-15T00:00:00",status:"Gaps Found",notes:"Scenario J: Heavy OAuth user",notify_user_1w:!1,notify_user_1d:!1,creation:t}],o=[{name:"ART-2025-00001",case:"OBC-2025-00001",artifact_type:"OAuthToken",subject_email:"alice.johnson@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive-001",risk_level:"High",scopes_json:'["https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.file"]',creation:a},{name:"ART-2025-00002",case:"OBC-2025-00001",artifact_type:"OAuthToken",subject_email:"alice.johnson@testcorp.com",status:"Active",app_display_name:"Slack",client_id:"client-slack-001",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/gmail.readonly","https://www.googleapis.com/auth/calendar.readonly"]',creation:a},{name:"ART-2025-00003",case:"OBC-2025-00001",artifact_type:"OAuthToken",subject_email:"alice.johnson@testcorp.com",status:"Active",app_display_name:"GitHub",client_id:"client-github-001",risk_level:"Critical",scopes_json:'["https://www.googleapis.com/auth/admin.directory.user","https://www.googleapis.com/auth/gmail.send"]',creation:a},{name:"ART-2025-00004",case:"OBC-2025-00002",artifact_type:"ASP",subject_email:"bob.smith@testcorp.com",status:"Active",app_display_name:"Thunderbird Mail",risk_level:"Medium",creation:a},{name:"ART-2025-00005",case:"OBC-2025-00002",artifact_type:"ASP",subject_email:"bob.smith@testcorp.com",status:"Active",app_display_name:"Outlook Desktop",risk_level:"Medium",creation:a},{name:"ART-2025-00006",case:"OBC-2025-00003",artifact_type:"LoginEvent",subject_email:"charlie.brown@testcorp.com",status:"Active",app_display_name:"Google Login",risk_level:"High",metadata_json:'{"ip":"203.0.113.45","login_time":"2025-10-25T14:30:00","user_agent":"Chrome/119"}',creation:t},{name:"ART-2025-00007",case:"OBC-2025-00004",artifact_type:"AdminMFA",subject_email:"diana.prince@testcorp.com",status:"Active",app_display_name:"Admin Console",risk_level:"Critical",creation:a},{name:"ART-2025-00008",case:"OBC-2025-00004",artifact_type:"DWDChange",subject_email:"diana.prince@testcorp.com",status:"Active",app_display_name:"Domain-Wide Delegation",risk_level:"Critical",metadata_json:'{"service_account":"sa@project.iam.gserviceaccount.com","scopes":["https://www.googleapis.com/auth/admin.directory.user"]}',creation:a},{name:"ART-2025-00009",case:"OBC-2025-00007",artifact_type:"OAuthToken",subject_email:"grace.lee@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive-001",risk_level:"High",scopes_json:'["https://www.googleapis.com/auth/drive"]',creation:t},{name:"ART-2025-00010",case:"OBC-2025-00007",artifact_type:"OAuthToken",subject_email:"grace.lee@testcorp.com",status:"Active",app_display_name:"Zoom",client_id:"client-zoom-001",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/calendar"]',creation:t},{name:"ART-2025-00011",case:"OBC-2025-00007",artifact_type:"OAuthToken",subject_email:"grace.lee@testcorp.com",status:"Active",app_display_name:"Notion",client_id:"client-notion-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/drive.readonly"]',creation:t},{name:"ART-2025-00012",case:"OBC-2025-00007",artifact_type:"ASP",subject_email:"grace.lee@testcorp.com",status:"Active",app_display_name:"Apple Mail",risk_level:"Medium",creation:t},{name:"ART-2025-00013",case:"OBC-2025-00008",artifact_type:"OAuthToken",subject_email:"henry.ford@testcorp.com",status:"Active",app_display_name:"Salesforce",client_id:"client-salesforce-001",risk_level:"High",scopes_json:'["https://www.googleapis.com/auth/contacts","https://www.googleapis.com/auth/gmail.send"]',creation:t},{name:"ART-2025-00014",case:"OBC-2025-00009",artifact_type:"OAuthToken",subject_email:"ivy.chen@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive-001",risk_level:"High",scopes_json:'["https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/drive.appdata"]',creation:t},{name:"ART-2025-00015",case:"OBC-2025-00009",artifact_type:"OAuthToken",subject_email:"ivy.chen@testcorp.com",status:"Active",app_display_name:"Jira",client_id:"client-jira-001",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/calendar","https://www.googleapis.com/auth/tasks"]',creation:t},{name:"ART-2025-00016",case:"OBC-2025-00009",artifact_type:"OAuthToken",subject_email:"ivy.chen@testcorp.com",status:"Active",app_display_name:"VS Code",client_id:"client-vscode-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/userinfo.profile"]',creation:t},{name:"ART-2025-00017",case:"OBC-2025-00009",artifact_type:"OAuthToken",subject_email:"ivy.chen@testcorp.com",status:"Active",app_display_name:"ChatGPT",client_id:"client-chatgpt-001",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/gmail.readonly"]',creation:t},{name:"ART-2025-00018",case:"OBC-2025-00009",artifact_type:"ASP",subject_email:"ivy.chen@testcorp.com",status:"Active",app_display_name:"Thunderbird",risk_level:"Medium",creation:t},{name:"ART-2025-00019",case:"OBC-2025-00009",artifact_type:"LoginEvent",subject_email:"ivy.chen@testcorp.com",status:"Active",app_display_name:"Google Login",risk_level:"High",metadata_json:'{"ip":"198.51.100.23","login_time":"2025-12-01T09:15:00","user_agent":"Firefox/120"}',creation:t},{name:"ART-2025-00020",case:"OBC-2025-00010",artifact_type:"OAuthToken",subject_email:"jack.daniels@testcorp.com",status:"Active",app_display_name:"Dropbox",client_id:"client-dropbox-001",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/drive.readonly"]',creation:t},{name:"ART-2025-00021",case:"",artifact_type:"OAuthToken",subject_email:"alice.johnson@testcorp.com",status:"Hidden",app_display_name:"Trello",client_id:"client-trello-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/tasks"]',creation:t},{name:"ART-2025-00022",case:"",artifact_type:"ASP",subject_email:"bob.smith@testcorp.com",status:"Hidden",app_display_name:"K-9 Mail",risk_level:"Medium",creation:t},{name:"ART-2025-00023",case:"OBC-2025-00001",artifact_type:"OAuthToken",subject_email:"alice.johnson@testcorp.com",status:"Revoked",app_display_name:"Figma",client_id:"client-figma-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/userinfo.profile"]',creation:a},{name:"ART-2025-00024",case:"",artifact_type:"OAuthToken",subject_email:"karen.white@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/drive"]',creation:t},{name:"ART-2025-00025",case:"",artifact_type:"OAuthToken",subject_email:"liam.neeson@testcorp.com",status:"Active",app_display_name:"Slack",client_id:"client-slack-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/gmail.readonly"]',creation:t},{name:"ART-2025-00026",case:"",artifact_type:"OAuthToken",subject_email:"karen.white@testcorp.com",status:"Active",app_display_name:"Figma",client_id:"client-figma-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/userinfo.profile"]',creation:t},{name:"ART-2025-00027",case:"",artifact_type:"OAuthToken",subject_email:"monica.geller@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/drive"]',creation:t},{name:"ART-2025-00028",case:"",artifact_type:"OAuthToken",subject_email:"monica.geller@testcorp.com",status:"Active",app_display_name:"Zoom",client_id:"client-zoom-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/calendar"]',creation:t},{name:"ART-2025-00029",case:"",artifact_type:"OAuthToken",subject_email:"nathan.drake@testcorp.com",status:"Active",app_display_name:"Jira",client_id:"client-jira-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/calendar"]',creation:t},{name:"ART-2025-00030",case:"",artifact_type:"OAuthToken",subject_email:"peter.parker@testcorp.com",status:"Active",app_display_name:"VS Code",client_id:"client-vscode-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/userinfo.profile"]',creation:t},{name:"ART-2025-00031",case:"",artifact_type:"OAuthToken",subject_email:"olivia.pope@testcorp.com",status:"Active",app_display_name:"Salesforce",client_id:"client-salesforce-001",risk_level:"Medium",scopes_json:'["https://www.googleapis.com/auth/contacts","https://www.googleapis.com/auth/gmail.send"]',creation:t},{name:"ART-2025-00032",case:"",artifact_type:"OAuthToken",subject_email:"olivia.pope@testcorp.com",status:"Active",app_display_name:"Google Drive",client_id:"client-google-drive-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/drive"]',creation:t},{name:"ART-2025-00033",case:"",artifact_type:"OAuthToken",subject_email:"rachel.green@testcorp.com",status:"Active",app_display_name:"Dropbox",client_id:"client-dropbox-001",risk_level:"Low",scopes_json:'["https://www.googleapis.com/auth/drive.readonly"]',creation:t},{name:"ART-2025-00034",case:"",artifact_type:"ASP",subject_email:"quinn.hughes@testcorp.com",status:"Active",app_display_name:"Thunderbird Mail",risk_level:"Low",creation:t}],r=[{name:"FND-2025-00001",case:"OBC-2025-00001",finding_type:"LingeringOAuthGrant",severity:"Critical",summary:"OAuth grant for Google Drive discovered — full drive access persists after offboarding.",recommended_action:"Revoke the OAuth token for Google Drive immediately.",creation:a},{name:"FND-2025-00002",case:"OBC-2025-00001",finding_type:"LingeringOAuthGrant",severity:"High",summary:"OAuth grant for GitHub with admin.directory access still active.",recommended_action:"Revoke the GitHub OAuth token.",creation:a},{name:"FND-2025-00003",case:"OBC-2025-00002",finding_type:"LingeringASP",severity:"Medium",summary:"App-Specific Password for Thunderbird Mail still active.",recommended_action:"Delete the ASP for Thunderbird.",creation:a},{name:"FND-2025-00004",case:"OBC-2025-00003",finding_type:"PostOffboardLogin",severity:"High",summary:"Post-offboard login detected from IP 203.0.113.45 via Chrome.",recommended_action:"Sign out all sessions and investigate.",creation:t},{name:"FND-2025-00005",case:"OBC-2025-00004",finding_type:"AdminMFAWeak",severity:"Critical",summary:"Admin account without strong 2FA — only SMS verification enabled.",recommended_action:"Enforce hardware security key for admin accounts.",creation:a},{name:"FND-2025-00006",case:"OBC-2025-00004",finding_type:"DWDHighRisk",severity:"Critical",summary:"Domain-Wide Delegation grant to service account with admin.directory scope.",recommended_action:"Review and restrict DWD scopes.",creation:a},{name:"FND-2025-00007",case:"OBC-2025-00007",finding_type:"LingeringOAuthGrant",severity:"High",summary:"OAuth grant for Google Drive persists after offboarding.",recommended_action:"Revoke Drive token.",creation:t},{name:"FND-2025-00008",case:"OBC-2025-00007",finding_type:"LingeringOAuthGrant",severity:"Medium",summary:"OAuth grant for Zoom with calendar access.",recommended_action:"Revoke Zoom token.",creation:t},{name:"FND-2025-00009",case:"OBC-2025-00007",finding_type:"LingeringASP",severity:"Medium",summary:"ASP for Apple Mail still active.",recommended_action:"Delete the ASP.",creation:t},{name:"FND-2025-00010",case:"OBC-2025-00008",finding_type:"LingeringOAuthGrant",severity:"High",summary:"OAuth grant for Salesforce with contacts and gmail.send access.",recommended_action:"Revoke Salesforce token.",creation:t},{name:"FND-2025-00011",case:"OBC-2025-00009",finding_type:"LingeringOAuthGrant",severity:"Critical",summary:"OAuth grant for Google Drive with full drive + appdata access.",recommended_action:"Revoke all Drive tokens immediately.",creation:t},{name:"FND-2025-00012",case:"OBC-2025-00009",finding_type:"LingeringOAuthGrant",severity:"Medium",summary:"OAuth grant for Jira with calendar and tasks access.",recommended_action:"Revoke Jira token.",creation:t},{name:"FND-2025-00013",case:"OBC-2025-00009",finding_type:"PostOffboardLogin",severity:"High",summary:"Post-offboard login detected from IP 198.51.100.23 via Firefox.",recommended_action:"Sign out all sessions.",creation:t},{name:"FND-2025-00014",case:"OBC-2025-00009",finding_type:"LingeringASP",severity:"Medium",summary:"ASP for Thunderbird still active after offboarding.",recommended_action:"Delete ASP.",creation:t},{name:"FND-2025-00015",case:"OBC-2025-00010",finding_type:"LingeringOAuthGrant",severity:"Medium",summary:"OAuth grant for Dropbox with drive.readonly access.",recommended_action:"Revoke Dropbox token.",creation:t},{name:"FND-2025-00017",case:"OBC-2025-00001",finding_type:"LingeringOAuthGrant",severity:"Medium",summary:"OAuth grant for Slack with gmail.readonly and calendar.readonly access still active.",recommended_action:"Revoke Slack token.",creation:a},{name:"FND-2025-00018",case:"OBC-2025-00002",finding_type:"LingeringASP",severity:"Medium",summary:"App-Specific Password for Outlook Desktop still active.",recommended_action:"Delete the ASP for Outlook.",creation:a},{name:"FND-2025-00019",case:"OBC-2025-00007",finding_type:"LingeringOAuthGrant",severity:"Low",summary:"OAuth grant for Notion with drive.readonly access — low risk but should be cleaned up.",recommended_action:"Revoke Notion token.",creation:t},{name:"FND-2025-00020",case:"OBC-2025-00009",finding_type:"LingeringOAuthGrant",severity:"Low",summary:"OAuth grant for VS Code with userinfo.profile scope only.",recommended_action:"Revoke VS Code token.",creation:t},{name:"FND-2025-00021",case:"OBC-2025-00009",finding_type:"LingeringOAuthGrant",severity:"Medium",summary:"OAuth grant for ChatGPT with gmail.readonly access.",recommended_action:"Revoke ChatGPT token.",creation:t},{name:"FND-2025-00022",case:"OBC-2025-00010",finding_type:"LingeringOAuthGrant",severity:"Medium",summary:"OAuth grant for Dropbox with drive.readonly access — medium risk.",recommended_action:"Revoke Dropbox token.",creation:t},{name:"FND-2025-00016",case:"OBC-2025-00006",finding_type:"LingeringOAuthGrant",severity:"High",summary:"OAuth grant for Slack — remediated.",recommended_action:"None — resolved.",closed_at:a,creation:a}],c=[{name:"AUD-2025-00001",actor_user:"Administrator",action_type:"CaseCreated",target_email:"alice.johnson@testcorp.com",result:"Success",request_json:'{"case":"OBC-2025-00001"}',timestamp:a,creation:a},{name:"AUD-2025-00006",actor_user:"Administrator",action_type:"RemediationStarted",target_email:"frank.castle@testcorp.com",result:"Success",request_json:'{"case":"OBC-2025-00006","action":"full_bundle"}',timestamp:a,creation:a},{name:"AUD-2025-00007",actor_user:"Administrator",action_type:"RemediationCompleted",target_email:"frank.castle@testcorp.com",result:"Success",request_json:'{"case":"OBC-2025-00006","action":"full_bundle","artifacts_remediated":2}',timestamp:a,creation:a},{name:"AUD-2025-00008",actor_user:"Administrator",action_type:"TokenRevoked",target_email:"alice.johnson@testcorp.com",result:"Success",request_json:'{"artifact":"ART-2025-00023","client_id":"client-figma-001"}',timestamp:a,creation:a}];var l=e.i(92749);function m(e){return JSON.parse(JSON.stringify(e))}let d=m(s),p=m(o),_=m(r),u=m(c),f=m({auto_scan_on_offboard:!0,auto_remediate_on_offboard:!1,background_scan_enabled:!0,auto_create_case_on_leave:!0,background_scan_interval:"Every Hour",remediation_check_interval:"Every 5 Minutes",notify_on_new_findings:!0,notify_on_remediation:!0,notification_email:"security@testcorp.com",default_remediation_action:"full_bundle"});function g(e,t,a){u.unshift({name:`AUD-MOCK-${Date.now()}`,actor_user:"Administrator",action_type:e,target_email:t,result:"Success",request_json:JSON.stringify(a||{}),timestamp:new Date().toISOString(),creation:new Date().toISOString()})}class y{name="mock";async authenticate(e,t){if("Administrator"===e&&"admin"===t)return{user:"Administrator",full_name:"Admin User",roles:["System Manager","HR Manager"]};if("hr@testcorp.com"===e&&"admin"===t)return{user:"hr@testcorp.com",full_name:"HR Manager",roles:["HR Manager"]};throw Error("Invalid credentials. Use Administrator/admin or hr@testcorp.com/admin")}async logout(){}async getSession(){return{user:"Administrator",full_name:"Admin User",roles:["System Manager","HR Manager"]}}async getDashboardStats(){let e=Date.now(),t=d.filter(e=>["Draft","Scheduled"].includes(e.status)).length,a=new Set(_.filter(e=>"Critical"===e.severity&&!e.closed_at).map(e=>e.case)),i=p.filter(t=>"OAuthToken"===t.artifact_type&&"Active"===t.status&&t.creation&&e-new Date(t.creation).getTime()<6048e5),n=p.filter(t=>"OAuthToken"===t.artifact_type&&"Active"===t.status&&t.creation&&e-new Date(t.creation).getTime()<2592e6),s=_.filter(t=>["PostOffboardLogin","PostOffboardSuspiciousLogin"].includes(t.finding_type)&&t.creation&&e-new Date(t.creation).getTime()<6048e5),o=this._getTopApps(),r=d.filter(e=>!["Closed","Remediated"].includes(e.status)).map(e=>{let t=_.filter(t=>t.case===e.name);return{case_name:e.name,primary_email:e.primary_email,employee_name:e.employee_name,status:e.status,effective_date:e.effective_date,finding_count:t.length,critical_count:t.filter(e=>"Critical"===e.severity).length}}).sort((e,t)=>t.critical_count-e.critical_count||t.finding_count-e.finding_count).slice(0,10);return{kpis:{pending_scan:t,critical_gaps:a.size,oauth_grants_7d:i.length,oauth_grants_30d:n.length,post_offboard_logins_7d:s.length,post_offboard_logins_30d:s.length,total_cases:d.length,total_findings:_.length,total_artifacts:p.length},top_oauth_apps:o,risky_cases:r}}async getStatistics(){return{mean_time_to_enforce_hours:48.5,top_apps_by_exposure:this._getTopApps(),scope_heatmap:[{scope:"googleapis.com/auth/drive",count:8},{scope:"googleapis.com/auth/gmail",count:5},{scope:"googleapis.com/auth/calendar",count:4},{scope:"googleapis.com/auth/admin",count:3}],residual_access_trend:[{week:"202548",finding_count:2},{week:"202549",finding_count:4},{week:"202550",finding_count:3},{week:"202551",finding_count:5}]}}async listCases(){return m(d)}async getCaseDetail(e){let t=d.find(t=>t.name===e);if(!t)throw Error(`Case not found: ${e}`);let a=p.filter(t=>t.case===e&&"Hidden"!==t.status),i=_.filter(t=>t.case===e),n=u.filter(e=>e.target_email===t.primary_email);return{case:m(t),artifacts:{tokens:a.filter(e=>"OAuthToken"===e.artifact_type),asps:a.filter(e=>"ASP"===e.artifact_type),login_events:a.filter(e=>"LoginEvent"===e.artifact_type),other:a.filter(e=>!["OAuthToken","ASP","LoginEvent"].includes(e.artifact_type)),total:a.length},findings:i,audit_logs:n}}async createCase(e){let t={name:`OBC-MOCK-${Date.now()}`,employee:e.employee||"",employee_name:e.employee_name||"",primary_email:e.primary_email||"",event_type:e.event_type||"Offboard",effective_date:e.effective_date||new Date().toISOString(),status:"Draft",notify_user_1w:!1,notify_user_1d:!1,notes:e.notes,creation:new Date().toISOString()};return d.unshift(t),g("CaseCreated",t.primary_email,{case:t.name}),m(t)}async createCaseFromEmployee(e){let t=n.find(t=>t.employee_id===e);if(!t)throw Error(`Employee not found: ${e}`);return this.createCase({employee:e,employee_name:t.employee_name,primary_email:t.company_email,event_type:"Offboard"})}async updateCase(e,t){let a=d.findIndex(t=>t.name===e);if(-1===a)throw Error(`Case not found: ${e}`);return d[a]={...d[a],...t},m(d[a])}async triggerScan(e){let t=d.find(t=>t.name===e);if(!t)throw Error(`Case not found: ${e}`);g("ScanStarted",t.primary_email,{case:e});let a=p.filter(t=>t.case===e&&"Active"===t.status).length,i=_.filter(t=>t.case===e&&!t.closed_at).length;return t.status=a>0||i>0?"Gaps Found":"All Clear",g("ScanFinished",t.primary_email,{case:e,active_artifacts:a,open_findings:i,new_status:t.status}),{status:"success",message:`Scan completed for ${t.primary_email}`}}async systemScan(){g("ScanStarted","SYSTEM",{scan_type:"system_scan"});let e=p.filter(e=>"Hidden"===e.status),t=0;for(let a of e){let e=d.find(e=>e.primary_email===a.subject_email&&!["Closed"].includes(e.status));if(!e){let t=n.find(e=>e.company_email===a.subject_email);e={name:`OBC-MOCK-${Date.now()}-${Math.random().toString(36).slice(2,7)}`,employee:t?.employee_id||"",employee_name:t?.employee_name||"",primary_email:a.subject_email,event_type:"Offboard",effective_date:new Date().toISOString(),status:"Gaps Found",notify_user_1w:!1,notify_user_1d:!1,creation:new Date().toISOString()},d.push(e)}a.status="Active",a.case=e.name,e.status="Gaps Found";let i={OAuthToken:"LingeringOAuthGrant",ASP:"LingeringASP",LoginEvent:"PostOffboardLogin",AdminMFA:"AdminMFAWeak",DWDChange:"DWDHighRisk"}[a.artifact_type]||"LingeringOAuthGrant";_.push({name:`FND-MOCK-${Date.now()}-${t}`,case:e.name,finding_type:i,severity:a.risk_level||"Medium",summary:`${a.app_display_name||"Unknown"} discovered during system scan for ${a.subject_email}.`,recommended_action:"Review and remediate.",creation:new Date().toISOString()}),t++}if(g("ScanFinished","SYSTEM",{scan_type:"system_scan",discoveries:t}),f.notify_on_new_findings&&t>0)for(let e of _.filter(e=>!e.closed_at&&("Critical"===e.severity||"High"===e.severity)).slice(-t)){let t=d.find(t=>t.name===e.case);(0,l.sendFindingAlert)({findingName:e.name,severity:e.severity,findingType:e.finding_type,summary:e.summary,caseName:e.case,employeeEmail:t?.primary_email||"unknown"},f.notification_email||void 0).catch(()=>{})}return{status:"success",message:`System scan found ${t} new issue(s).`}}async getScanHistory(){let e=u.filter(e=>["ScanStarted","ScanFinished"].includes(e.action_type)),t=[];for(let a of e){if("ScanStarted"!==a.action_type)continue;let i=JSON.parse(a.request_json||"{}"),n=e.find(e=>"ScanFinished"===e.action_type&&e.target_email===a.target_email),s=n?JSON.parse(n.request_json||"{}"):{};t.push({scan_id:a.name,case:i.case||"",target_email:a.target_email,trigger:a.actor_user?.includes("Scheduler")?"automatic":"manual",actor:a.actor_user,started_at:a.timestamp,result:n?"Completed":"Pending",new_status:s.new_status||"",active_artifacts:s.active_artifacts||0,open_findings:s.open_findings,findings_link:i.case?`/findings?case=${i.case}`:""})}return t}async executeRemediation(e,t){let a=d.find(t=>t.name===e);if(!a)throw Error(`Case not found: ${e}`);if(g("RemediationStarted",a.primary_email,{case:e,action:t}),"full_bundle"===t){let i=p.filter(t=>t.case===e&&"Active"===t.status);for(let e of i)e.status="ASP"===e.artifact_type?"Deleted":"Revoked";let n=_.filter(t=>t.case===e&&!t.closed_at);for(let e of n)e.closed_at=new Date().toISOString();return a.status="Remediated",g("RemediationCompleted",a.primary_email,{case:e,action:t,artifacts_remediated:i.length}),{status:"success",action:t,artifacts_remediated:i.length,findings_closed:n.length}}if("revoke_token"===t){let a=p.filter(t=>t.case===e&&"OAuthToken"===t.artifact_type&&"Active"===t.status);for(let e of a)e.status="Revoked";return this._closeFindingsForCase(e,["LingeringOAuthGrant"]),this._rescanCase(e),{status:"success",action:t,revoked:a.length}}if("delete_asp"===t){let a=p.filter(t=>t.case===e&&"ASP"===t.artifact_type&&"Active"===t.status);for(let e of a)e.status="Deleted";return this._closeFindingsForCase(e,["LingeringASP"]),this._rescanCase(e),{status:"success",action:t,deleted:a.length}}if("sign_out"===t){for(let t of p.filter(t=>t.case===e&&"LoginEvent"===t.artifact_type&&"Active"===t.status))t.status="Acknowledged";return this._closeFindingsForCase(e,["PostOffboardLogin","PostOffboardSuspiciousLogin"]),this._rescanCase(e),{status:"success",action:t}}throw Error(`Unknown action: ${t}`)}async bulkRemediate(e,t){let a=0,i=0;for(let e of t){let t=p.find(t=>t.name===e);t&&("OAuthToken"===t.artifact_type?(t.status="Revoked",a++):"ASP"===t.artifact_type&&(t.status="Deleted",i++))}return this._rescanCase(e),{status:"success",revoked:a,deleted:i}}async remediateArtifacts(e){let t=0,a=0,i=new Set;for(let n of e){let e=p.find(e=>e.name===n);e&&"Active"===e.status&&("OAuthToken"===e.artifact_type?(e.status="Revoked",t++):"ASP"===e.artifact_type?(e.status="Deleted",a++):e.status="Acknowledged",e.case&&i.add(e.case))}for(let e of i)this._rescanCase(e);return{status:"success",revoked:t,deleted:a}}async runScheduledRemediationNow(e){return this.executeRemediation(e,"full_bundle")}async listArtifacts(e){let t=m(p);return e&&(e.status&&(t=t.filter(t=>t.status===e.status)),e.case&&(t=t.filter(t=>t.case===e.case)),e.artifact_type&&(t=t.filter(t=>t.artifact_type===e.artifact_type))),t}async getArtifact(e){let t=p.find(t=>t.name===e);if(!t)throw Error(`Artifact not found: ${e}`);return m(t)}async listFindings(e){let t=m(_);return e&&(e.case&&(t=t.filter(t=>t.case===e.case)),e.severity&&(t=t.filter(t=>t.severity===e.severity)),e.finding_type&&(t=t.filter(t=>t.finding_type===e.finding_type))),t}async getFinding(e){let t=_.find(t=>t.name===e);if(!t)throw Error(`Finding not found: ${e}`);return m(t)}async remediateFinding(e){let t=_.find(t=>t.name===e);if(!t)throw Error(`Finding not found: ${e}`);if(t.closed_at)throw Error(`Finding already closed: ${e}`);t.closed_at=new Date().toISOString();let a=p.filter(e=>e.case===t.case&&"Active"===e.status),i={LingeringOAuthGrant:["OAuthToken"],LingeringASP:["ASP"],PostOffboardLogin:["LoginEvent"],PostOffboardSuspiciousLogin:["LoginEvent"],AdminMFAWeak:["AdminMFA"],DWDHighRisk:["DWDChange"]}[t.finding_type]||[],n=0;for(let e of a)i.includes(e.artifact_type)&&(e.status="ASP"===e.artifact_type?"Deleted":"Revoked",n++);return g("RemediationCompleted",t.case,{finding:e,artifacts_remediated:n}),this._rescanCase(t.case),{status:"success",artifacts_remediated:n,findings_closed:1}}async getEmployeeList(){return m(n).map(e=>{let t=d.filter(t=>t.employee===e.employee_id),a=t.map(e=>e.name),i=[...p.filter(e=>a.includes(e.case)),...p.filter(t=>t.subject_email===e.company_email&&!t.case)],n=_.filter(e=>a.includes(e.case));return{...e,case_count:t.length,active_artifacts:i.filter(e=>"Active"===e.status).length,open_findings:n.filter(e=>!e.closed_at).length}})}async getEmployeeDetail(e){let t=n.find(t=>t.employee_id===e);if(!t)throw Error(`Employee not found: ${e}`);let a=d.filter(t=>t.employee===e),i=a.map(e=>e.name),s=[...p.filter(e=>i.includes(e.case)),...p.filter(e=>e.subject_email===t.company_email&&!e.case)],o=_.filter(e=>i.includes(e.case)),r={};for(let e of s)if("OAuthToken"===e.artifact_type&&e.app_display_name){let t=e.client_id||e.app_display_name;r[t]||(r[t]={app_name:e.app_display_name,client_id:e.client_id||"",status:e.status,risk_level:e.risk_level,artifact_name:e.name})}return{employee:{id:t.employee_id,name:t.employee_name,email:t.company_email,status:t.emp_status,date_of_joining:t.date_of_joining,relieving_date:t.relieving_date,department:t.department,designation:t.designation,company:t.company},cases:a,artifacts:s,findings:o,apps:Object.values(r),summary:{total_cases:a.length,active_artifacts:s.filter(e=>"Active"===e.status).length,open_findings:o.filter(e=>!e.closed_at).length,apps_used:Object.keys(r).length}}}async revokeEmployeeAccess(e,t){let a=d.filter(t=>t.employee===e&&!["Closed","Remediated"].includes(t.status)),i=0,n=0;for(let e of a){let a=await this.executeRemediation(e.name,"tokens"===t?"revoke_token":"asps"===t?"delete_asp":"full_bundle");i+=a.artifacts_remediated||a.revoked||a.deleted||0,n+=a.findings_closed||0}return{status:"success",artifacts_remediated:i,findings_closed:n}}async getAllActiveOAuthApps(){let e={};for(let t of p)"OAuthToken"===t.artifact_type&&"Active"===t.status&&t.client_id&&(e[t.client_id]||(e[t.client_id]={client_id:t.client_id,app_display_name:t.app_display_name||"Unknown",grant_count:0,user_count:0,case_count:0}),e[t.client_id].grant_count++);for(let t of Object.keys(e)){let a=p.filter(e=>e.client_id===t&&"Active"===e.status);e[t].user_count=new Set(a.map(e=>e.subject_email)).size,e[t].case_count=new Set(a.map(e=>e.case).filter(Boolean)).size}return Object.values(e).sort((e,t)=>t.grant_count-e.grant_count)}async getAppDetail(e){let t=p.filter(t=>t.client_id===e&&"OAuthToken"===t.artifact_type),a=t[0]?.app_display_name||e,i=new Set,n=t.map(e=>{let t=JSON.parse(e.scopes_json||"[]");return t.forEach(e=>{let t=e.split("/");i.add(t[t.length-1]||e)}),{email:e.subject_email,status:e.status,risk_level:e.risk_level,case:e.case||"",artifact_name:e.name,granted:e.creation||"",scopes:t.map(e=>{let t=e.split("/"),a=t[t.length-1]||e;return{scope:a,full:e,level:/send|modify|compose|write|admin|manage/i.test(a)?"write":"read"}}),raw_scopes:t}});return{client_id:e,app_name:a,total_grants:t.length,active_grants:t.filter(e=>"Active"===e.status).length,revoked_grants:t.filter(e=>"Revoked"===e.status).length,cases_affected:[...new Set(t.map(e=>e.case).filter(Boolean))],scopes:[...i].sort(),users:n}}async globalAppRemoval(e,t){let a=p.filter(t=>t.client_id===e&&"Active"===t.status&&"OAuthToken"===t.artifact_type),i=new Set;for(let e of a)e.status="Revoked",e.case&&i.add(e.case);for(let e of i)this._rescanCase(e);return g("GlobalAppRemoval","",{client_id:e,app_name:t,revoked:a.length}),{status:"success",revoked:a.length}}async revokeAppForUsers(e,t){let a=0,i=new Set;for(let e of t){let t=p.find(t=>t.name===e);t&&"Active"===t.status&&"OAuthToken"===t.artifact_type&&(t.status="Revoked",a++,t.case&&i.add(t.case))}for(let e of i)this._rescanCase(e);return{status:"success",revoked:a}}async restoreAppForUsers(e,t){let a=0,i=new Set;for(let e of t){let t=p.find(t=>t.name===e);t&&"Revoked"===t.status&&"OAuthToken"===t.artifact_type&&(t.status="Active",a++,t.case&&i.add(t.case))}for(let e of i)this._rescanCase(e);return{status:"success",artifacts_remediated:a}}async updateUserScopes(e,t){let a=p.find(t=>t.name===e);if(!a)throw Error(`Artifact not found: ${e}`);let i=JSON.parse(a.scopes_json||"[]");a.scopes_json=JSON.stringify(t),t.length||"Active"!==a.status?t.length&&"Revoked"===a.status&&(a.status="Active"):a.status="Revoked";let n=i.filter(e=>!t.includes(e)).length,s=t.filter(e=>!i.includes(e)).length;return a.case&&this._rescanCase(a.case),{removed:n,added:s}}async listAuditLogs(){return m(u)}async getSettings(){return m(f)}async updateSettings(e){return m(f={...f,...e})}async chat(e){let t=e.toLowerCase();if(t.includes("audit log")||t.includes("audit")||t.includes("log")){let e=u.slice(0,5).map(e=>`- ${e.action_type} by ${e.actor_user} for ${e.target_email} (${e.result})`).join("\n");return{reply:`Audit logs record every scan, remediation, and admin action. There are ${u.length} entries.

Recent:
${e}

View the full audit log →`,sources:[{title:"View Audit Log →",url:"/audit-log"}]}}if(t.includes("employee")||t.includes("staff")||t.includes("people")||t.includes("who")){let e=n.filter(e=>"Left"===e.emp_status),t=n.filter(e=>"Active"===e.emp_status),a=d.map(e=>e.employee),i=n.filter(e=>a.includes(e.employee_id));return{reply:`${n.length} employees: ${t.length} active, ${e.length} left.
${i.length} have offboarding cases.

Top concerns:
${e.slice(0,5).map(e=>`- ${e.employee_name} (${e.company_email})`).join("\n")}`,sources:[{title:"View All Employees →",url:"/employees"},...e.slice(0,3).map(e=>({title:e.employee_name,url:`/employees?employee=${encodeURIComponent(e.employee_id)}`}))]}}if(t.includes("remediat")||t.includes("fix")||t.includes("revoke")||t.includes("resolve")){let e=d.filter(e=>"Remediated"===e.status),t=d.filter(e=>"Gaps Found"===e.status);return{reply:`Remediation revokes access and closes findings.

**Full Bundle**: revoke tokens → delete ASPs → sign out → close findings.

${e.length} cases remediated, ${t.length} still have gaps.`,sources:[{title:"View Cases →",url:"/cases"},...t.slice(0,3).map(e=>({title:`${e.employee_name} (${e.status})`,url:`/cases/${e.name}`}))]}}if(t.includes("setting")||t.includes("config")||t.includes("interval")||t.includes("schedul"))return{reply:`Current settings:
- Auto scan on offboard: ${f.auto_scan_on_offboard?"ON":"OFF"}
- Auto remediate: ${f.auto_remediate_on_offboard?"ON":"OFF"}
- Background scan: ${f.background_scan_enabled?"ON":"OFF"} (${f.background_scan_interval})
- Notifications: ${f.notify_on_new_findings?"ON":"OFF"} → ${f.notification_email||"not set"}`,sources:[{title:"Open Settings →",url:"/settings"}]};if(t.includes("scan")||t.includes("discover")){let e=u.filter(e=>"ScanFinished"===e.action_type);return{reply:`Scans discover lingering access (tokens, ASPs, logins) for offboarded employees.

- **System scan**: checks all hidden artifacts
- **Case scan**: scans one employee
- **Background**: runs every ${f.background_scan_interval}

${e.length} completed scans so far. Run a system scan from the dashboard.`,sources:[{title:"Scan History →",url:"/scan-history"},{title:"Run System Scan →",url:"/dashboard"}]}}if(t.includes("case")||t.includes("offboard")){let e=Object.entries(d.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{})).map(([e,t])=>`${e}: ${t}`).join(", "),t=d.filter(e=>"Gaps Found"===e.status);return{reply:`${d.length} offboarding cases.

Breakdown: ${e}

Cases needing attention:
${t.slice(0,5).map(e=>`- ${e.employee_name}: ${e.status}`).join("\n")}`,sources:[{title:"View All Cases →",url:"/cases"},...t.slice(0,3).map(e=>({title:e.employee_name,url:`/cases/${e.name}`}))]}}if(t.includes("where")&&(t.includes("artifact")||t.includes("token")||t.includes("oauth")||t.includes("asp")||t.includes("access"))){let e=p.filter(e=>"Active"===e.status),t=e.reduce((e,t)=>{let a=t.case||"Unlinked";return e[a]=(e[a]||0)+1,e},{}),a=Object.entries(t).slice(0,5).map(([e,t])=>{let a=d.find(t=>t.name===e);return`- ${a?a.employee_name:e}: ${t} artifact(s)`}).join("\n");return{reply:`${e.length} active artifacts.

By employee/case:
${a}

Click below to browse artifacts or specific employees.`,sources:[{title:"View All Artifacts →",url:"/artifacts"},{title:"View OAuth Apps →",url:"/apps"},...Object.keys(t).slice(0,2).filter(e=>"Unlinked"!==e).map(e=>{let t=d.find(t=>t.name===e);return{title:t?.employee_name||e,url:`/cases/${e}`}})]}}if(t.includes("artifact")||t.includes("token")||t.includes("oauth")||t.includes("asp")||t.includes("access")){let e=p.filter(e=>"Active"===e.status),t=Object.entries(e.reduce((e,t)=>(e[t.artifact_type]=(e[t.artifact_type]||0)+1,e),{})).map(([e,t])=>`${e}: ${t}`).join(", ");return{reply:`${e.length} active artifacts.

By type: ${t}

Artifacts are access mechanisms (tokens, ASPs, logins) needing review.`,sources:[{title:"View Artifacts →",url:"/artifacts"},{title:"View OAuth Apps →",url:"/apps"}]}}if(t.includes("finding")||t.includes("risk")||t.includes("critical")||t.includes("severity")||t.includes("gap")){let e=_.filter(e=>!e.closed_at),t=Object.entries(e.reduce((e,t)=>(e[t.severity]=(e[t.severity]||0)+1,e),{})).map(([e,t])=>`${e}: ${t}`).join(", "),a=e.filter(e=>"Critical"===e.severity);return{reply:`${e.length} open findings (${_.length} total).

Severity: ${t}

${a.length>0?`Critical findings:
${a.slice(0,3).map(e=>`- ${e.name}: ${e.summary.slice(0,60)}`).join("\n")}`:"No critical findings."}`,sources:[{title:"View All Findings →",url:"/findings"},...a.slice(0,2).map(e=>({title:e.name,url:`/findings?finding=${encodeURIComponent(e.name)}`}))]}}if(t.includes("doc")||t.includes("help")||t.includes("how")||t.includes("what")||t.includes("explain"))return{reply:`OGM manages security for employee offboarding:

1. **Cases** created when employees leave
2. **Scans** discover lingering access
3. **Findings** flag policy violations
4. **Remediation** revokes access
5. **Audit logs** track everything

Integrates with Frappe HRMS + Google Workspace.`,sources:[{title:"Documentation →",url:"/docs"},{title:"Dashboard →",url:"/dashboard"},{title:"Settings →",url:"/settings"}]};let a=d.length,i=_.filter(e=>!e.closed_at).length,s=p.filter(e=>"Active"===e.status).length;return{reply:`I can help you with information about the OGM system. Here's a quick overview:

- **${a} offboarding cases** tracked
- **${i} open findings** requiring attention
- **${s} active artifacts** across all cases

Try asking about:
- Cases and their statuses
- Findings and severity levels
- Access artifacts (tokens, ASPs)
- Remediation actions
- Audit logs
- Settings and configuration
- Employees
- Scanning process`,sources:[{title:"Dashboard →",url:"/dashboard"},{title:"Cases →",url:"/cases"},{title:"Findings →",url:"/findings"},{title:"Employees →",url:"/employees"}]}}_getTopApps(){let e={};for(let t of p)"OAuthToken"===t.artifact_type&&"Active"===t.status&&t.client_id&&(e[t.client_id]||(e[t.client_id]={client_id:t.client_id,app_display_name:t.app_display_name||"Unknown",grant_count:0}),e[t.client_id].grant_count++);return Object.values(e).sort((e,t)=>t.grant_count-e.grant_count).slice(0,10)}_closeFindingsForCase(e,t){for(let a of _)a.case===e&&t.includes(a.finding_type)&&!a.closed_at&&(a.closed_at=new Date().toISOString())}_rescanCase(e){let t=d.find(t=>t.name===e);if(!t)return;let a=p.filter(t=>t.case===e&&"Active"===t.status).length,i=_.filter(t=>t.case===e&&!t.closed_at).length;0===a&&0===i?["Gaps Found","Draft","Scheduled"].includes(t.status)&&(t.status="Remediated"):t.status="Gaps Found"}}let h=null;function v(){return h||(h=new y)}e.s(["getProvider",()=>v],24223)}];

//# sourceMappingURL=src_lib_providers_index_ts_b0ab9515._.js.map