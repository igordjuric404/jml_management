module.exports=[20969,e=>{"use strict";let t={overview:{id:"overview",title:"OGM Overview",keywords:["overview","what is ogm","oauth gap monitor","purpose","jml management"],content:"OGM (OAuth Gap Monitor) is a post-offboarding access and OAuth gap monitor for Google Workspace. It detects lingering OAuth tokens, ASPs, post-offboarding logins, admin MFA gaps, and DWD risks. Main URL: /dashboard. Key pages: Dashboard (/dashboard), Cases (/cases), Employees (/employees), OAuth Apps (/apps), Findings (/findings), Artifacts (/artifacts), Scan History (/scan-history), Audit Log (/audit-log), Settings (/settings), Docs (/docs).",answer:"OGM (OAuth Gap Monitor) is a post-offboarding security tool for Google Workspace. It detects lingering OAuth tokens, app-specific passwords, suspicious logins, and other access gaps after employees leave. You can get started from the **Dashboard**."},remediation:{id:"remediation",title:"Remediation Actions",keywords:["remediate","revoke","delete","sign out","fix","resolve","bundle"],content:"Remediation actions: 1) Revoke All OAuth Grants (tokens.delete), 2) Delete All ASPs (asps.delete), 3) Sign Out User Everywhere (users.signOut), 4) Full Remediation Bundle (all of the above + close findings). Available from: case detail page (/cases/{id}), employee page (/employees), artifact list (/artifacts), app dashboard (/apps). After any remediation, case status updates automatically.",answer:"Remediation lets you revoke lingering access for offboarded employees. Actions include revoking OAuth grants, deleting ASPs, signing out sessions, or running a Full Bundle that does all three and closes findings. You can trigger remediation from any case detail page under **Cases**."},findings:{id:"findings",title:"Finding Types",keywords:["finding","issue","vulnerability","gap","severity"],content:"Finding types: LingeringOAuthGrant (active tokens), LingeringASP (active passwords), PostOffboardLogin (login after leaving), PostOffboardSuspiciousLogin (suspicious login), OffboardingNotEnforced (account not suspended), AdminMFAWeak (admin without 2SV), DWDHighRisk (dangerous domain-wide delegation). Severities: Low, Medium, High, Critical. URL: /findings.",answer:"Findings are security issues discovered during scans. Types include lingering OAuth grants, lingering ASPs, post-offboard logins, weak admin MFA, and risky domain-wide delegation. Each finding has a severity (Low, Medium, High, or Critical). You can review and remediate them on the **Findings** page."},scanning:{id:"scanning",title:"Scanning",keywords:["scan","rescan","discover","detect","hidden","system scan"],content:"System Scan: triggered from the Dashboard (/dashboard) via the 'Scan System' button. Discovers hidden leftover access across ALL offboarded employees — tokens, ASPs, logins. Auto-creates cases for new discoveries. Background scan runs on the configured interval (if enabled in Settings). Scan history at /scan-history.",answer:"You can run a System Scan from the **Dashboard** to discover hidden leftover access across all offboarded employees. It automatically creates cases for any new discoveries. Background scanning can also be enabled in **Settings**. View past scans under **Scan History**."},automation:{id:"automation",title:"Automation & Settings",keywords:["automatic","auto","setting","config","toggle","schedule","background","interval"],content:"Settings at /settings: Auto-Scan on Offboarding (off by default), Auto-Remediate on Offboarding (off), Background Scanning (on), Auto-Create Case on Employee Leave (on). Scheduled remediations check every 5 minutes. Notifications for 7-day and 1-day reminders.",answer:"You can configure automation on the **Settings** page. Options include auto-scan on offboarding, auto-remediation, background scanning, and automatic case creation when employees leave. Notification reminders are sent at 7-day and 1-day intervals."},cases:{id:"offboarding-case",title:"Offboarding Cases",keywords:["case","offboarding","draft","gaps found","remediated","all clear"],content:"Offboarding Cases track user access reviews. Status flow: Draft → (scan) → All Clear or Gaps Found → (remediate) → Remediated → Closed. Can also be Scheduled. Fields: primary_email, employee, event_type, effective_date, status, scheduled_remediation_date. URL: /cases. Detail: /cases/{id}.",answer:"Offboarding Cases track the access review process for departing employees. They follow a status flow: Draft → All Clear or Gaps Found → Remediated → Closed. You can view and manage all cases on the **Cases** page."},artifacts:{id:"artifacts",title:"Access Artifacts",keywords:["artifact","token","asp","login event","access artifact","oauth token"],content:"Access Artifacts: OAuthToken (third-party OAuth grant), ASP (app-specific password), LoginEvent (login record), AdminMFA (MFA status), DWDChange (domain delegation event). Status: Hidden → (system scan) → Active → Revoked/Deleted/Acknowledged. You can access and manage them at /artifacts.",answer:"The artifacts are stored within the OAuth Gap Monitor system. You can access and manage them on the **Artifacts** page. The artifact types are OAuthToken, ASP, LoginEvent, AdminMFA, and DWDChange."},employees:{id:"employees",title:"Employee Management",keywords:["employee","staff","people","personnel"],content:"Employee Access Overview at /employees. Lists all employees with case/artifact/finding counts. Per-employee detail: info, KPIs, apps used, findings with remediate buttons, cases with resolve buttons. Bulk revoke: select employees and revoke all tokens or ASPs.",answer:"You can view all employees and their access status on the **Employees** page. Each employee shows their cases, artifacts, findings, and apps used, with options to remediate directly. Bulk revoke is also available."},apps:{id:"apps",title:"OAuth Applications",keywords:["app","application","oauth app","slack","notion","client","grant"],content:"OAuth App Dashboard at /apps. Lists all apps with grant counts. Per-app detail: users with grants, scopes, risk levels. Per-user revoke or global revoke.",answer:"You can see all your OAuth apps on the **Apps** page. It lists every third-party application with active grants, showing user counts and scopes. You can revoke access per-user or globally."},audit:{id:"audit-log",title:"Audit Log",keywords:["audit","log","trail","action history"],content:"Unified Audit Log at /audit-log. Records all OGM actions: scans, remediations, case creation. Fields: actor_user, action_type, target_email, result, remediation_type (manual/automatic/scheduler), timestamp.",answer:"The Audit Log records every action in the system — scans, remediations, and case changes. You can review the full history on the **Audit Log** page."},navigation:{id:"navigation",title:"Navigation Guide",keywords:["navigate","page","url","sidebar","menu"],content:"Dashboard: /dashboard. Cases: /cases. Employees: /employees. Apps: /apps. Findings: /findings. Artifacts: /artifacts. Scan History: /scan-history. Audit Log: /audit-log. Settings: /settings. Docs: /docs. All accessible from the sidebar navigation.",answer:"All pages are accessible from the sidebar. Key areas: **Dashboard**, **Cases**, **Employees**, **Apps**, **Findings**, **Artifacts**, **Audit Log**, and **Settings**."}},a=["how many","count","number","total","active","open","status","statistics","stat","finding","artifact","case","critical","remediated","pending","hidden"],s=["where","find","navigate","go to","how to get","located","stored","page","url"];function i(e){let t;if(t=e.toLowerCase(),s.some(e=>t.includes(e)))return!1;let i=e.toLowerCase();return a.some(e=>i.includes(e))}let n=new Set(["a","an","the","is","are","was","were","be","been","being","have","has","had","do","does","did","will","would","shall","should","may","might","must","can","could","i","me","my","we","our","you","your","he","she","it","they","them","this","that","these","those","am","or","and","but","if","not","no","so","up","out","on","off","in","to","at","of","for","by","with","from","as","into","about","how","what","which","who","whom","when","where","why","all","each","any","both","more","most","some","such","than","too","very","just","also","there","here","then"]),o=new Set(["navigation","overview"]);function r(e){let a=e.toLowerCase(),s=[],i=!1;for(let[e,r]of Object.entries(t)){let t=0,d=!1;for(let e of r.keywords)a.includes(e)&&(t+=10,d=!0);for(let e of(a.match(/\w+/g)??[]).filter(e=>e.length>=4&&!n.has(e)))r.content.toLowerCase().includes(e)&&(t+=1);t>0&&(s.push([t,e,r]),d&&!o.has(e)&&(i=!0))}if(s.sort((e,t)=>t[0]-e[0]),i&&s.length>=2&&o.has(s[0][1])){let e=s.findIndex(([,e])=>!o.has(e));if(e>0){let[t]=s.splice(e,1);s.unshift(t)}}return s.slice(0,3)}async function d(e){try{let[t,a,s,i,n,o,r,d,c]=await Promise.all([e.getTotalCases(),e.getCaseCounts(),e.getTotalFindings(),e.getOpenFindings(),e.getCriticalFindings(),e.getTotalArtifacts(),e.getActiveArtifacts(),e.getHiddenArtifacts(),e.getOffboardedEmployees()]),l=Object.entries(a).map(([e,t])=>`${e}: ${t}`).join(", ");return`LIVE DATABASE: ${t} total cases (${l}). ${s} total findings (${i} open, ${s-i} closed, ${n} critical open). ${o} total artifacts (${r} active, ${d} hidden/undiscovered). ${c} offboarded employees.`}catch{return""}}let c={overview:"/dashboard",remediation:"/cases",findings:"/findings",scanning:"/scan-history",automation:"/settings","offboarding-case":"/cases",artifacts:"/artifacts",employees:"/employees",apps:"/apps","audit-log":"/audit-log",navigation:"/dashboard"};function l(e){return e.map(([,,e])=>({title:e.title,url:c[e.id]||"/dashboard"}))}function u(e,t,a){if(t.length>0){let s=t[0][2].answer;return i(e)&&a&&(s=a+"\n\n"+s),{reply:s,sources:l(t)}}return{reply:"I can help with questions about OGM. Try asking about: findings, remediation, scanning, automation, cases, employees, artifacts, navigation, or the audit log.",sources:[{title:"Dashboard",url:"/dashboard"},{title:"Documentation",url:"/docs"}]}}async function g(e,t,a){try{let s=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({model:"google/gemini-2.0-flash-001",messages:[{role:"system",content:"You are the OGM Help Assistant. Answer questions about the OAuth Gap Monitor system. Be concise (2-4 sentences max). Include relevant URLs when helpful (use format /page-name like /artifacts, /cases, /findings). If LIVE DATABASE data is provided, use those exact numbers. Only answer based on provided context."},{role:"user",content:`Context:
${t}

Question: ${e}`}],max_tokens:300,temperature:.3}),signal:AbortSignal.timeout(15e3)});if(!s.ok)return null;let i=await s.json();return i?.choices?.[0]?.message?.content??null}catch{return null}}async function h(e,a){let s;if(!e||e.trim().length<2)return{reply:"Please ask a question about the OGM system.",sources:[]};let n=r(e),o=[];if(i(e)&&a?.liveDataProvider&&(s=await d(a.liveDataProvider))&&o.push(s),n.length>0)for(let[,,e]of n)o.push(`[${e.title}]: ${e.content}`);else o.push(t.overview.content),o.push(t.navigation.content);let c=o.join("\n\n"),h=l(n);if(a?.apiKey){let t=await g(e,c,a.apiKey);if(t)return{reply:t,sources:h}}return u(e,n,s)}e.s(["chat",()=>h,"chatWithLLM",()=>g,"getLiveDataString",()=>d,"localAnswer",()=>u,"needsLiveData",()=>i,"searchKnowledge",()=>r])}];

//# sourceMappingURL=src_lib_chatbot_ts_a345d6a8._.js.map