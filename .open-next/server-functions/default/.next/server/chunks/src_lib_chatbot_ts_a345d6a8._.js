module.exports=[20969,e=>{"use strict";let t={overview:{id:"overview",title:"OGM Overview",keywords:["overview","what is","ogm","oauth gap monitor","purpose","about","jml"],content:"OGM (OAuth Gap Monitor) is a post-offboarding access and OAuth gap monitor for Google Workspace. It detects lingering OAuth tokens, ASPs, post-offboarding logins, admin MFA gaps, and DWD risks. Main URL: /dashboard. Key pages: Dashboard (/dashboard), Cases (/cases), Employees (/employees), OAuth Apps (/apps), Findings (/findings), Artifacts (/artifacts), Scan History (/scan-history), Audit Log (/audit-log), Settings (/settings), Docs (/docs)."},remediation:{id:"remediation",title:"Remediation Actions",keywords:["remediate","revoke","delete","sign out","fix","resolve","bundle","action"],content:"Remediation actions: 1) Revoke All OAuth Grants (tokens.delete), 2) Delete All ASPs (asps.delete), 3) Sign Out User Everywhere (users.signOut), 4) Full Remediation Bundle (all of the above + close findings). Available from: case detail page (/cases/{id}), employee page (/employees), artifact list (/artifacts), app dashboard (/apps). After any remediation, case status updates automatically."},findings:{id:"findings",title:"Finding Types",keywords:["finding","issue","vulnerability","gap","security","type","severity"],content:"Finding types: LingeringOAuthGrant (active tokens), LingeringASP (active passwords), PostOffboardLogin (login after leaving), PostOffboardSuspiciousLogin (suspicious login), OffboardingNotEnforced (account not suspended), AdminMFAWeak (admin without 2SV), DWDHighRisk (dangerous domain-wide delegation). Severities: Low, Medium, High, Critical. URL: /findings."},scanning:{id:"scanning",title:"Scanning",keywords:["scan","rescan","discover","detect","hidden","background","system scan"],content:"System Scan: triggered from the Dashboard (/dashboard) via the 'Scan System' button. Discovers hidden leftover access across ALL offboarded employees — tokens, ASPs, logins. Auto-creates cases for new discoveries. Background scan runs on the configured interval (if enabled in Settings). Scan history at /scan-history."},automation:{id:"automation",title:"Automation & Settings",keywords:["automatic","auto","setting","config","toggle","schedule","background","interval"],content:"Settings at /settings: Auto-Scan on Offboarding (off by default), Auto-Remediate on Offboarding (off), Background Scanning (on), Auto-Create Case on Employee Leave (on). Scheduled remediations check every 5 minutes. Notifications for 7-day and 1-day reminders."},cases:{id:"offboarding-case",title:"Offboarding Cases",keywords:["case","offboarding","status","draft","gaps found","remediated","all clear"],content:"Offboarding Cases track user access reviews. Status flow: Draft → (scan) → All Clear or Gaps Found → (remediate) → Remediated → Closed. Can also be Scheduled. Fields: primary_email, employee, event_type, effective_date, status, scheduled_remediation_date. URL: /cases. Detail: /cases/{id}."},artifacts:{id:"artifacts",title:"Access Artifacts",keywords:["artifact","token","asp","login","access","oauth","stored"],content:"Access Artifacts: OAuthToken (third-party OAuth grant), ASP (app-specific password), LoginEvent (login record), AdminMFA (MFA status), DWDChange (domain delegation event). Status: Hidden → (system scan) → Active → Revoked/Deleted/Acknowledged. You can access and manage them at /artifacts."},employees:{id:"employees",title:"Employee Management",keywords:["employee","user","staff","people","hr","who"],content:"Employee Access Overview at /employees. Lists all employees with case/artifact/finding counts. Per-employee detail: info, KPIs, apps used, findings with remediate buttons, cases with resolve buttons. Bulk revoke: select employees and revoke all tokens or ASPs."},apps:{id:"apps",title:"OAuth Applications",keywords:["app","application","oauth","slack","notion","client","grant"],content:"OAuth App Dashboard at /apps. Lists all apps with grant counts. Per-app detail: users with grants, scopes, risk levels. Per-user revoke or global revoke."},audit:{id:"audit-log",title:"Audit Log",keywords:["audit","log","history","trail","who","when","action","track"],content:"Unified Audit Log at /audit-log. Records all OGM actions: scans, remediations, case creation. Fields: actor_user, action_type, target_email, result, remediation_type (manual/automatic/scheduler), timestamp."},navigation:{id:"navigation",title:"Navigation Guide",keywords:["where","find","navigate","page","url","go to","how to get","located","stored"],content:"Dashboard: /dashboard. Cases: /cases. Employees: /employees. Apps: /apps. Findings: /findings. Artifacts: /artifacts. Scan History: /scan-history. Audit Log: /audit-log. Settings: /settings. Docs: /docs. All accessible from the sidebar navigation."}},a=["how many","count","number","total","active","open","status","statistics","stat","finding","artifact","case","critical","remediated","pending","hidden"],s=["where","find","navigate","go to","how to get","located","stored","page","url"];function i(e){let t;if(t=e.toLowerCase(),s.some(e=>t.includes(e)))return!1;let i=e.toLowerCase();return a.some(e=>i.includes(e))}function o(e){let a=e.toLowerCase(),s=[];for(let[e,i]of Object.entries(t)){let t=0;for(let e of i.keywords)a.includes(e)&&(t+=2);for(let e of a.match(/\w+/g)??[])i.content.toLowerCase().includes(e)&&(t+=1);t>0&&s.push([t,e,i])}return s.sort((e,t)=>t[0]-e[0]),s.slice(0,3)}async function n(e){try{let[t,a,s,i,o,n,r,d,c]=await Promise.all([e.getTotalCases(),e.getCaseCounts(),e.getTotalFindings(),e.getOpenFindings(),e.getCriticalFindings(),e.getTotalArtifacts(),e.getActiveArtifacts(),e.getHiddenArtifacts(),e.getOffboardedEmployees()]),l=Object.entries(a).map(([e,t])=>`${e}: ${t}`).join(", ");return`LIVE DATABASE: ${t} total cases (${l}). ${s} total findings (${i} open, ${s-i} closed, ${o} critical open). ${n} total artifacts (${r} active, ${d} hidden/undiscovered). ${c} offboarded employees.`}catch{return""}}let r={overview:"/dashboard",remediation:"/cases",findings:"/findings",scanning:"/scan-history",automation:"/settings","offboarding-case":"/cases",artifacts:"/artifacts",employees:"/employees",apps:"/apps","audit-log":"/audit-log",navigation:"/dashboard"};function d(e){return e.map(([,,e])=>({title:e.title,url:r[e.id]||"/dashboard"}))}function c(e,t,a){if(t.length>0){let s=t[0][2].content;return i(e)&&a&&(s=a+"\n\n"+s),{reply:s,sources:d(t)}}return{reply:"I can help with questions about OGM. Try asking about: findings, remediation, scanning, automation, cases, employees, artifacts, navigation, or the audit log.",sources:[{title:"Dashboard",url:"/dashboard"},{title:"Documentation",url:"/docs"}]}}async function l(e,t,a){try{let s=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({model:"google/gemini-2.0-flash-001",messages:[{role:"system",content:"You are the OGM Help Assistant. Answer questions about the OAuth Gap Monitor system. Be concise (2-4 sentences max). Include relevant URLs when helpful (use format /page-name like /artifacts, /cases, /findings). If LIVE DATABASE data is provided, use those exact numbers. Only answer based on provided context."},{role:"user",content:`Context:
${t}

Question: ${e}`}],max_tokens:300,temperature:.3}),signal:AbortSignal.timeout(15e3)});if(!s.ok)return null;let i=await s.json();return i?.choices?.[0]?.message?.content??null}catch{return null}}async function u(e,a){let s;if(!e||e.trim().length<2)return{reply:"Please ask a question about the OGM system.",sources:[]};let r=o(e),u=[];if(i(e)&&a?.liveDataProvider&&(s=await n(a.liveDataProvider))&&u.push(s),r.length>0)for(let[,,e]of r)u.push(`[${e.title}]: ${e.content}`);else u.push(t.overview.content),u.push(t.navigation.content);let g=u.join("\n\n"),p=d(r);if(a?.apiKey){let t=await l(e,g,a.apiKey);if(t)return{reply:t,sources:p}}return c(e,r,s)}e.s(["chat",()=>u,"chatWithLLM",()=>l,"getLiveDataString",()=>n,"localAnswer",()=>c,"needsLiveData",()=>i,"searchKnowledge",()=>o])}];

//# sourceMappingURL=src_lib_chatbot_ts_a345d6a8._.js.map