(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var a=e.i(43476),r=e.i(75157);function s({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function t({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function l({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",e),...s})}function i({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...s})}function n({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>n,"CardDescription",()=>i,"CardHeader",()=>t,"CardTitle",()=>l])},87486,e=>{"use strict";var a=e.i(43476),r=e.i(25913),s=e.i(86011),t=e.i(75157);let l=(0,r.cva)("inline-flex items-center justify-center rounded-full border border-transparent px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border-border text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",ghost:"[a&]:hover:bg-accent [a&]:hover:text-accent-foreground",link:"text-primary underline-offset-4 [a&]:hover:underline"}},defaultVariants:{variant:"default"}});function i({className:e,variant:r="default",asChild:i=!1,...n}){let d=i?s.Slot.Root:"span";return(0,a.jsx)(d,{"data-slot":"badge","data-variant":r,className:(0,t.cn)(l({variant:r}),e),...n})}e.s(["Badge",()=>i])},84774,e=>{"use strict";var a=e.i(43476),r=e.i(75157);function s({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,r.cn)("w-full caption-bottom text-sm",e),...s})})}function t({className:e,...s}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,r.cn)("[&_tr]:border-b",e),...s})}function l({className:e,...s}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,r.cn)("[&_tr:last-child]:border-0",e),...s})}function i({className:e,...s}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,r.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...s})}function n({className:e,...s}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,r.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function d({className:e,...s}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,r.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}e.s(["Table",()=>s,"TableBody",()=>l,"TableCell",()=>d,"TableHead",()=>n,"TableHeader",()=>t,"TableRow",()=>i])},70756,e=>{"use strict";let a=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>a],70756)},55436,e=>{"use strict";let a=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>a],55436)},27671,e=>{"use strict";var a=e.i(43476),r=e.i(90472),s=e.i(15288),t=e.i(19455),l=e.i(87486),i=e.i(84774),n=e.i(78894),d=e.i(75505),c=e.i(61911),o=e.i(95444),h=e.i(27516),u=e.i(78583),x=e.i(55436);let m=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var f=e.i(31278),b=e.i(70756),p=e.i(22016),g=e.i(46200);let j=[{label:"Offboarding Cases",href:"/cases",icon:d.FolderOpen},{label:"Employees",href:"/employees",icon:c.Users},{label:"Access Artifacts",href:"/artifacts",icon:b.Lock},{label:"Findings",href:"/findings",icon:n.AlertTriangle},{label:"OAuth Apps",href:"/apps",icon:o.Grid3X3},{label:"Scan History",href:"/scan-history",icon:h.History},{label:"Audit Log",href:"/audit-log",icon:u.FileText}];function v(){let{data:e,isLoading:n,refetch:d}=(0,r.useDashboard)(),c=(0,r.useSystemScan)();if(n)return(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(f.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})});let o=e?.kpis;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"OAuth Gap Monitor Dashboard"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Overview of access security posture"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(t.Button,{variant:"outline",size:"sm",onClick:()=>d(),children:[(0,a.jsx)(m,{className:"mr-2 h-4 w-4"}),"Refresh"]}),(0,a.jsxs)(t.Button,{size:"sm",onClick:()=>{(0,g.confirmAction)({title:"System Scan",description:"Run a system-wide scan to discover new lingering access? This will check all employees for hidden artifacts.",confirmLabel:"Run Scan",onConfirm:()=>c.mutate()})},disabled:c.isPending,children:[c.isPending?(0,a.jsx)(f.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(x.Search,{className:"mr-2 h-4 w-4"}),"Scan System"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,a.jsx)(y,{label:"Pending Scan",value:o?.pending_scan,color:"blue",href:"/cases?status=Draft"}),(0,a.jsx)(y,{label:"Critical Gaps",value:o?.critical_gaps,color:"red",href:"/findings?severity=Critical"}),(0,a.jsx)(y,{label:"OAuth Grants (7d)",value:o?.oauth_grants_7d,color:"orange",href:"/artifacts?type=OAuthToken"}),(0,a.jsx)(y,{label:"OAuth Grants (30d)",value:o?.oauth_grants_30d,color:"yellow",href:"/artifacts?type=OAuthToken"}),(0,a.jsx)(y,{label:"Post-offboard Logins",value:o?.post_offboard_logins_7d,color:"red",href:"/findings?type=PostOffboardLogin"}),(0,a.jsx)(y,{label:"Total Cases",value:o?.total_cases,color:"gray",href:"/cases"})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsx)(s.CardTitle,{className:"text-base",children:"Quick Links"})}),(0,a.jsx)(s.CardContent,{children:(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-2",children:j.map(e=>(0,a.jsx)(p.default,{href:e.href,children:(0,a.jsxs)(t.Button,{variant:"outline",size:"sm",className:"w-full justify-start",children:[(0,a.jsx)(e.icon,{className:"mr-2 h-4 w-4"}),e.label]})},e.href))})})]}),e?.top_oauth_apps&&e.top_oauth_apps.length>0&&(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsx)(s.CardTitle,{className:"text-base",children:"Top Lingering OAuth Apps"})}),(0,a.jsx)(s.CardContent,{children:(0,a.jsxs)(i.Table,{children:[(0,a.jsx)(i.TableHeader,{children:(0,a.jsxs)(i.TableRow,{children:[(0,a.jsx)(i.TableHead,{children:"App"}),(0,a.jsx)(i.TableHead,{children:"Client ID"}),(0,a.jsx)(i.TableHead,{className:"text-right",children:"Active Grants"}),(0,a.jsx)(i.TableHead,{})]})}),(0,a.jsx)(i.TableBody,{children:e.top_oauth_apps.map(e=>(0,a.jsxs)(i.TableRow,{children:[(0,a.jsx)(i.TableCell,{className:"font-medium",children:(0,a.jsx)(p.default,{href:`/apps?client_id=${encodeURIComponent(e.client_id)}`,className:"hover:underline text-primary",children:e.app_display_name||"Unknown"})}),(0,a.jsx)(i.TableCell,{children:(0,a.jsx)("code",{className:"text-xs",children:e.client_id?.substring(0,30)})}),(0,a.jsx)(i.TableCell,{className:"text-right font-bold",children:e.grant_count}),(0,a.jsx)(i.TableCell,{children:(0,a.jsx)(p.default,{href:`/apps?client_id=${encodeURIComponent(e.client_id)}`,className:"text-sm text-primary hover:underline",children:"Details â†’"})})]},e.client_id))})]})})]}),e?.risky_cases&&e.risky_cases.length>0&&(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsx)(s.CardTitle,{className:"text-base",children:"Most Risky Cases"})}),(0,a.jsx)(s.CardContent,{children:(0,a.jsxs)(i.Table,{children:[(0,a.jsx)(i.TableHeader,{children:(0,a.jsxs)(i.TableRow,{children:[(0,a.jsx)(i.TableHead,{children:"Case"}),(0,a.jsx)(i.TableHead,{children:"Email"}),(0,a.jsx)(i.TableHead,{children:"Employee"}),(0,a.jsx)(i.TableHead,{children:"Findings"}),(0,a.jsx)(i.TableHead,{children:"Critical"})]})}),(0,a.jsx)(i.TableBody,{children:e.risky_cases.map(e=>(0,a.jsxs)(i.TableRow,{children:[(0,a.jsx)(i.TableCell,{children:(0,a.jsx)(p.default,{href:`/cases/${e.case_name}`,className:"text-primary hover:underline",children:e.case_name})}),(0,a.jsx)(i.TableCell,{children:(0,a.jsx)(p.default,{href:`/employees?email=${encodeURIComponent(e.primary_email)}`,className:"hover:underline",children:e.primary_email})}),(0,a.jsx)(i.TableCell,{children:e.employee_name?(0,a.jsx)(p.default,{href:`/employees?email=${encodeURIComponent(e.primary_email)}`,className:"hover:underline",children:e.employee_name}):"-"}),(0,a.jsx)(i.TableCell,{children:(0,a.jsxs)(p.default,{href:`/findings?case=${e.case_name}`,className:"hover:underline",children:[e.finding_count," finding(s)"]})}),(0,a.jsx)(i.TableCell,{children:(0,a.jsx)(l.Badge,{variant:e.critical_count>0?"destructive":"secondary",children:e.critical_count})})]},e.case_name))})]})})]})]})}function y({label:e,value:r,color:t,href:l}){return(0,a.jsx)(p.default,{href:l,children:(0,a.jsx)(s.Card,{className:"cursor-pointer hover:bg-accent/50 transition-colors",children:(0,a.jsxs)(s.CardContent,{className:"p-4 text-center",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:e}),(0,a.jsx)("p",{className:`text-2xl font-bold ${{blue:"text-blue-500",red:"text-red-500",orange:"text-orange-500",yellow:"text-yellow-500",gray:"text-muted-foreground",green:"text-green-500"}[t]||""}`,children:r??0})]})})})}e.s(["default",()=>v],27671)}]);