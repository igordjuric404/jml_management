(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70756,e=>{"use strict";let t=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],70756)},57428,e=>{"use strict";var t=e.i(43476),a=e.i(78784),s=e.i(71645),r=e.i(20783),n=e.i(30030),l=e.i(81140),i=e.i(69340),c=e.i(99682),d=e.i(35804),o=e.i(96626),u=e.i(48425),x="Checkbox",[h,m]=(0,n.createContextScope)(x),[p,j]=h(x);function f(e){let{__scopeCheckbox:a,checked:r,children:n,defaultChecked:l,disabled:c,form:d,name:o,onCheckedChange:u,required:h,value:m="on",internal_do_not_use_render:j}=e,[f,b]=(0,i.useControllableState)({prop:r,defaultProp:l??!1,onChange:u,caller:x}),[v,g]=s.useState(null),[C,k]=s.useState(null),y=s.useRef(!1),N=!v||!!d||!!v.closest("form"),w={checked:f,disabled:c,setChecked:b,control:v,setControl:g,name:o,form:d,value:m,hasConsumerStoppedPropagationRef:y,required:h,defaultChecked:!S(l)&&l,isFormControl:N,bubbleInput:C,setBubbleInput:k};return(0,t.jsx)(p,{scope:a,...w,children:"function"==typeof j?j(w):n})}var b="CheckboxTrigger",v=s.forwardRef(({__scopeCheckbox:e,onKeyDown:a,onClick:n,...i},c)=>{let{control:d,value:o,disabled:x,checked:h,required:m,setControl:p,setChecked:f,hasConsumerStoppedPropagationRef:v,isFormControl:g,bubbleInput:C}=j(b,e),k=(0,r.useComposedRefs)(c,p),y=s.useRef(h);return s.useEffect(()=>{let e=d?.form;if(e){let t=()=>f(y.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[d,f]),(0,t.jsx)(u.Primitive.button,{type:"button",role:"checkbox","aria-checked":S(h)?"mixed":h,"aria-required":m,"data-state":w(h),"data-disabled":x?"":void 0,disabled:x,value:o,...i,ref:k,onKeyDown:(0,l.composeEventHandlers)(a,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,l.composeEventHandlers)(n,e=>{f(e=>!!S(e)||!e),C&&g&&(v.current=e.isPropagationStopped(),v.current||e.stopPropagation())})})});v.displayName=b;var g=s.forwardRef((e,a)=>{let{__scopeCheckbox:s,name:r,checked:n,defaultChecked:l,required:i,disabled:c,value:d,onCheckedChange:o,form:u,...x}=e;return(0,t.jsx)(f,{__scopeCheckbox:s,checked:n,defaultChecked:l,disabled:c,required:i,onCheckedChange:o,name:r,form:u,value:d,internal_do_not_use_render:({isFormControl:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v,{...x,ref:a,__scopeCheckbox:s}),e&&(0,t.jsx)(N,{__scopeCheckbox:s})]})})});g.displayName=x;var C="CheckboxIndicator",k=s.forwardRef((e,a)=>{let{__scopeCheckbox:s,forceMount:r,...n}=e,l=j(C,s);return(0,t.jsx)(o.Presence,{present:r||S(l.checked)||!0===l.checked,children:(0,t.jsx)(u.Primitive.span,{"data-state":w(l.checked),"data-disabled":l.disabled?"":void 0,...n,ref:a,style:{pointerEvents:"none",...e.style}})})});k.displayName=C;var y="CheckboxBubbleInput",N=s.forwardRef(({__scopeCheckbox:e,...a},n)=>{let{control:l,hasConsumerStoppedPropagationRef:i,checked:o,defaultChecked:x,required:h,disabled:m,name:p,value:f,form:b,bubbleInput:v,setBubbleInput:g}=j(y,e),C=(0,r.useComposedRefs)(n,g),k=(0,c.usePrevious)(o),N=(0,d.useSize)(l);s.useEffect(()=>{if(!v)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!i.current;if(k!==o&&e){let a=new Event("click",{bubbles:t});v.indeterminate=S(o),e.call(v,!S(o)&&o),v.dispatchEvent(a)}},[v,k,o,i]);let w=s.useRef(!S(o)&&o);return(0,t.jsx)(u.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:x??w.current,required:h,disabled:m,name:p,value:f,form:b,...a,tabIndex:-1,ref:C,style:{...a.style,...N,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function S(e){return"indeterminate"===e}function w(e){return S(e)?"indeterminate":e?"checked":"unchecked"}N.displayName=y,e.s(["Checkbox",()=>g,"CheckboxIndicator",()=>k,"Indicator",()=>k,"Root",()=>g,"createCheckboxScope",()=>m,"unstable_BubbleInput",()=>N,"unstable_CheckboxBubbleInput",()=>N,"unstable_CheckboxProvider",()=>f,"unstable_CheckboxTrigger",()=>v,"unstable_Provider",()=>f,"unstable_Trigger",()=>v],88474);var _=e.i(88474),_=_,T=e.i(75157);function A({className:e,...s}){return(0,t.jsx)(_.Root,{"data-slot":"checkbox",className:(0,T.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:(0,t.jsx)(_.Indicator,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:(0,t.jsx)(a.CheckIcon,{className:"size-3.5"})})})}e.s(["Checkbox",()=>A],57428)},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},79940,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),r=e.i(90472),n=e.i(15288),l=e.i(19455),i=e.i(87486),c=e.i(84774),d=e.i(67489),o=e.i(57428),u=e.i(31278),x=e.i(70756),h=e.i(71689),m=e.i(22016),p=e.i(1851),j=e.i(92374);let f=["OAuthToken","ASP","LoginEvent","AdminMFA","DWDChange"],b=["Active","Hidden","Revoked","Deleted","Acknowledged"],v={Active:"destructive",Revoked:"secondary",Deleted:"secondary",Hidden:"secondary",Acknowledged:"secondary"},g={Critical:"destructive",High:"destructive",Medium:"default",Low:"secondary"};function C({artifactId:e}){let{data:a,isLoading:s}=(0,r.useArtifactDetail)(e);if(s)return(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)(u.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(!a)return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(m.default,{href:"/artifacts",children:(0,t.jsxs)(l.Button,{variant:"outline",size:"sm",children:[(0,t.jsx)(h.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back to Artifacts"]})}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["Artifact not found: ",e]})]});let c=a.scopes_json?JSON.parse(a.scopes_json):[],d=a.metadata_json?JSON.parse(a.metadata_json):null;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)(m.default,{href:"/artifacts",children:(0,t.jsxs)(l.Button,{variant:"outline",size:"sm",children:[(0,t.jsx)(h.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back to Artifacts"]})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:a.name}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Artifact detail"})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsx)(n.CardTitle,{className:"text-base",children:"Artifact Info"})}),(0,t.jsx)(n.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Type"}),(0,t.jsx)("p",{className:"font-medium",children:a.artifact_type})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Status"}),(0,t.jsx)("p",{children:(0,t.jsx)(i.Badge,{variant:v[a.status]??"secondary",children:a.status})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Risk Level"}),(0,t.jsx)("p",{children:a.risk_level?(0,t.jsx)(i.Badge,{variant:g[a.risk_level]??"secondary",children:a.risk_level}):"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Case"}),(0,t.jsx)("p",{children:a.case?(0,t.jsx)(m.default,{href:`/cases/${a.case}`,className:"text-primary hover:underline",children:a.case}):"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Subject Email"}),(0,t.jsx)("p",{children:(0,t.jsx)(m.default,{href:`/employees?email=${encodeURIComponent(a.subject_email)}`,className:"text-primary hover:underline",children:a.subject_email})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"App"}),(0,t.jsx)("p",{children:a.client_id?(0,t.jsx)(m.default,{href:`/apps?client_id=${encodeURIComponent(a.client_id)}`,className:"text-primary hover:underline",children:a.app_display_name||a.client_id}):a.app_display_name||"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Created"}),(0,t.jsx)("p",{children:a.creation?(0,p.format)(new Date(a.creation),"PPp"):"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Last Modified"}),(0,t.jsx)("p",{children:a.modified?(0,p.format)(new Date(a.modified),"PPp"):"-"})]})]})})]}),c.length>0&&(0,t.jsxs)(n.Card,{children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsx)(n.CardTitle,{className:"text-base",children:"OAuth Scopes"})}),(0,t.jsx)(n.CardContent,{children:(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:c.map(e=>(0,t.jsx)(i.Badge,{variant:"outline",className:"text-xs font-mono",children:e},e))})})]}),d&&(0,t.jsxs)(n.Card,{children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsx)(n.CardTitle,{className:"text-base",children:"Metadata"})}),(0,t.jsx)(n.CardContent,{children:(0,t.jsx)("pre",{className:"text-sm bg-muted rounded-md p-4 overflow-x-auto",children:JSON.stringify(d,null,2)})})]})]})}function k(){let e=(0,s.useRouter)(),{sortConfig:h,onSort:k,sortData:y}=(0,j.useSort)(),N=(0,s.useSearchParams)(),S=N.get("artifact"),[w,_]=(0,a.useState)(N.get("type")??"all"),[T,A]=(0,a.useState)(N.get("status")??"all"),[P,R]=(0,a.useState)(new Set),I=(0,a.useMemo)(()=>{let e={};return w&&"all"!==w&&(e.artifact_type=w),T&&"all"!==T&&(e.status=T),Object.keys(e).length?e:void 0},[w,T]),{data:H,isLoading:L}=(0,r.useArtifacts)(I),B=(0,r.useRemediateArtifacts)(),E=(0,a.useMemo)(()=>H?.filter(e=>"Active"===e.status)??[],[H]);return S?(0,t.jsx)(C,{artifactId:S}):L?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)(u.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Access Artifacts"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"OAuth tokens, ASPs, login events, and other access mechanisms"})]}),P.size>0&&(0,t.jsxs)(l.Button,{variant:"destructive",onClick:()=>{let e=Array.from(P);0!==e.length&&B.mutate(e,{onSuccess:()=>R(new Set)})},disabled:B.isPending,children:[B.isPending?(0,t.jsx)(u.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,t.jsx)(x.Lock,{className:"mr-2 h-4 w-4"}),"Remediate (",P.size," selected)"]})]}),(0,t.jsxs)(n.Card,{children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,t.jsx)(n.CardTitle,{className:"text-base",children:"Artifacts"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(d.Select,{value:w,onValueChange:_,children:[(0,t.jsx)(d.SelectTrigger,{className:"w-[140px]",children:(0,t.jsx)(d.SelectValue,{placeholder:"Type"})}),(0,t.jsxs)(d.SelectContent,{children:[(0,t.jsx)(d.SelectItem,{value:"all",children:"All types"}),f.map(e=>(0,t.jsx)(d.SelectItem,{value:e,children:e},e))]})]}),(0,t.jsxs)(d.Select,{value:T,onValueChange:A,children:[(0,t.jsx)(d.SelectTrigger,{className:"w-[120px]",children:(0,t.jsx)(d.SelectValue,{placeholder:"Status"})}),(0,t.jsxs)(d.SelectContent,{children:[(0,t.jsx)(d.SelectItem,{value:"all",children:"All status"}),b.map(e=>(0,t.jsx)(d.SelectItem,{value:e,children:e},e))]})]})]})]}),(0,t.jsx)(n.CardContent,{children:(0,t.jsxs)(c.Table,{children:[(0,t.jsx)(c.TableHeader,{children:(0,t.jsxs)(c.TableRow,{children:[(0,t.jsx)(c.TableHead,{className:"w-10",children:(0,t.jsx)(o.Checkbox,{checked:E.length>0&&E.every(e=>P.has(e.name)),onCheckedChange:()=>{P.size===E.length?R(new Set):R(new Set(E.map(e=>e.name)))}})}),(0,t.jsx)(j.SortableTableHead,{column:"name",label:"Name",sortConfig:h,onSort:k}),(0,t.jsx)(j.SortableTableHead,{column:"case",label:"Case",sortConfig:h,onSort:k}),(0,t.jsx)(j.SortableTableHead,{column:"artifact_type",label:"Type",sortConfig:h,onSort:k}),(0,t.jsx)(j.SortableTableHead,{column:"subject_email",label:"Subject Email",sortConfig:h,onSort:k}),(0,t.jsx)(j.SortableTableHead,{column:"status",label:"Status",sortConfig:h,onSort:k}),(0,t.jsx)(j.SortableTableHead,{column:"app_display_name",label:"App Name",sortConfig:h,onSort:k}),(0,t.jsx)(j.SortableTableHead,{column:"risk_level",label:"Risk Level",sortConfig:h,onSort:k}),(0,t.jsx)(j.SortableTableHead,{column:"creation",label:"Created",sortConfig:h,onSort:k})]})}),(0,t.jsx)(c.TableBody,{children:(H?y(H):[]).map(a=>(0,t.jsxs)(c.TableRow,{className:"cursor-pointer",onClick:()=>e.push(`/artifacts?artifact=${encodeURIComponent(a.name)}`),children:[(0,t.jsx)(c.TableCell,{onClick:e=>e.stopPropagation(),children:"Active"===a.status&&(0,t.jsx)(o.Checkbox,{checked:P.has(a.name),onCheckedChange:()=>{var e;return e=a.name,void R(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})}})}),(0,t.jsx)(c.TableCell,{className:"font-medium",children:(0,t.jsx)(m.default,{href:`/artifacts?artifact=${encodeURIComponent(a.name)}`,className:"text-primary hover:underline",onClick:e=>e.stopPropagation(),children:a.name})}),(0,t.jsx)(c.TableCell,{children:(0,t.jsx)(m.default,{href:`/cases/${a.case}`,className:"text-primary hover:underline",onClick:e=>e.stopPropagation(),children:a.case})}),(0,t.jsx)(c.TableCell,{children:a.artifact_type}),(0,t.jsx)(c.TableCell,{children:(0,t.jsx)(m.default,{href:`/employees?email=${encodeURIComponent(a.subject_email)}`,className:"text-primary hover:underline",onClick:e=>e.stopPropagation(),children:a.subject_email})}),(0,t.jsx)(c.TableCell,{children:(0,t.jsx)(i.Badge,{variant:v[a.status]??"secondary",children:a.status})}),(0,t.jsx)(c.TableCell,{children:a.client_id?(0,t.jsx)(m.default,{href:`/apps?client_id=${encodeURIComponent(a.client_id)}`,className:"text-primary hover:underline",onClick:e=>e.stopPropagation(),children:a.app_display_name||a.client_id}):a.app_display_name||"-"}),(0,t.jsx)(c.TableCell,{children:a.risk_level?(0,t.jsx)(i.Badge,{variant:g[a.risk_level]??"secondary",children:a.risk_level}):"-"}),(0,t.jsx)(c.TableCell,{children:a.creation?(0,p.format)(new Date(a.creation),"PP"):"-"})]},a.name))})]})})]})]})}function y(){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)(u.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),children:(0,t.jsx)(k,{})})}e.s(["default",()=>y])}]);