(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var s=e.i(43476),i=e.i(75157);function t({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"card",className:(0,i.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function n({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,i.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function r({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,i.cn)("leading-none font-semibold",e),...t})}function a({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,i.cn)("text-muted-foreground text-sm",e),...t})}function c({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,i.cn)("px-6",e),...t})}e.s(["Card",()=>t,"CardContent",()=>c,"CardDescription",()=>a,"CardHeader",()=>n,"CardTitle",()=>r])},87486,e=>{"use strict";var s=e.i(43476),i=e.i(25913),t=e.i(86011),n=e.i(75157);let r=(0,i.cva)("inline-flex items-center justify-center rounded-full border border-transparent px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border-border text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",ghost:"[a&]:hover:bg-accent [a&]:hover:text-accent-foreground",link:"text-primary underline-offset-4 [a&]:hover:underline"}},defaultVariants:{variant:"default"}});function a({className:e,variant:i="default",asChild:a=!1,...c}){let d=a?t.Slot.Root:"span";return(0,s.jsx)(d,{"data-slot":"badge","data-variant":i,className:(0,n.cn)(r({variant:i}),e),...c})}e.s(["Badge",()=>a])},1251,e=>{"use strict";var s=e.i(43476),i=e.i(71645),t=e.i(22016),n=e.i(15288),r=e.i(87486),a=e.i(60289),c=e.i(78894),d=e.i(98919),o=e.i(78583),l=e.i(75254);let h=(0,l.default)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]),g=(0,l.default)("plug",[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M17 8a1 1 0 0 1 1 1v4a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1z",key:"1xoxul"}],["path",{d:"M9 8V2",key:"14iosj"}]]);var m=e.i(63059),u=e.i(10980);let p=[{id:"architecture",title:"Architecture",icon:a.LayoutDashboard,description:"System components, DocTypes, and data flow",subsections:["Overview","DocTypes","Data Flow","Deployment"]},{id:"findings",title:"Findings",icon:c.AlertTriangle,description:"Policy violations, severity levels, and finding types",subsections:["Finding Types","Severity Levels","Evidence","Lifecycle"]},{id:"access-artifacts",title:"Access Artifacts",icon:d.Shield,description:"OAuth tokens, ASPs, login events, and risk assessment",subsections:["Artifact Types","Risk Levels","Scopes","Discovery"]},{id:"audit-log",title:"Audit Log",icon:o.FileText,description:"Immutable event records and action tracking",subsections:["Action Types","Entries","Filtering"]},{id:"remediation",title:"Remediation",icon:h,description:"Automated and manual remediation workflows",subsections:["Full Bundle","Standalone Actions","Scheduling","Bulk Operations"]},{id:"integrations",title:"Integrations",icon:g,description:"HRMS, Google Workspace, Frappe Scheduler",subsections:["HRMS Employee","Google Workspace","Frappe Scheduler","Webhooks"]}],x={architecture:{Overview:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"The OAuth Gap Monitor (OGM) is a decoupled system designed to detect and remediate lingering access after employee offboarding. It comprises two primary components:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Frappe App"})," — frontend UI, database, REST API, and business logic. Hosts the OGM Settings, Offboarding Cases, Access Artifacts, Findings, and the Unified Audit Log."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"External Scanner Service"})," — Python-based worker that connects to Google Workspace APIs to discover OAuth tokens, ASPs, login events, and other access mechanisms. Runs as a background job via the Frappe scheduler."]})]}),(0,s.jsx)("p",{children:"The Next.js management dashboard (this application) provides a modern web interface that communicates with the Frappe backend via REST API, offering real-time visibility into the offboarding security posture."})]}),DocTypes:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"The system is built around five core DocTypes:"}),(0,s.jsx)("div",{className:"grid gap-3 not-prose",children:[{name:"Offboarding Case",href:"/cases",desc:"Tracks an employee offboarding event through its lifecycle: Draft → Scheduled → Scanned → Gaps Found → Remediated → Closed."},{name:"Access Artifact",href:"/artifacts",desc:"Concrete access mechanisms discovered during scans: OAuth tokens, ASPs, login events, admin MFA settings, and DWD changes."},{name:"Finding",href:"/findings",desc:"Policy violations generated from artifacts: LingeringOAuthGrant, LingeringASP, PostOffboardLogin, AdminMFAWeak, DWDHighRisk, OffboardingNotEnforced."},{name:"Unified Audit Log Entry",href:"/audit-log",desc:"Immutable record of every scan, remediation, and administrative action performed in the system."},{name:"OGM Settings",href:"/settings",desc:"Singleton configuration for automation toggles, scan intervals, remediation defaults, and notification preferences."}].map(e=>(0,s.jsx)(n.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(t.default,{href:e.href,className:"font-semibold text-primary hover:underline",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.desc})]}),(0,s.jsx)(m.ChevronRight,{className:"h-4 w-4 text-muted-foreground mt-1 shrink-0"})]})},e.name))})]}),"Data Flow":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"The typical data flow for an offboarding event:"}),(0,s.jsxs)("ol",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Employee status change"})," in HRMS triggers a webhook or is detected by the scheduler."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Offboarding Case"})," is auto-created (if ",(0,s.jsx)("code",{children:"auto_create_case_on_leave"})," is enabled)."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Scan"})," runs automatically or manually, discovering access artifacts."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Findings"})," are generated from artifacts that violate security policies."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Remediation"})," is triggered (auto or manual), revoking tokens, deleting ASPs, signing out sessions."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Audit log"})," records every action throughout the process."]})]})]}),Deployment:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"The management dashboard supports two deployment modes:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Cloudflare Workers"})," — production deployment via ",(0,s.jsx)("code",{children:"opennextjs-cloudflare"}),". Uses Wrangler for deployment and supports edge computing."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Standard Next.js"})," — development mode with ",(0,s.jsx)("code",{children:"next dev"}),". Supports mock provider for offline development."]})]}),(0,s.jsxs)("p",{children:["The Frappe backend runs as a standard Frappe site with the ",(0,s.jsx)("code",{children:"oauth_gap_monitor"})," app installed."]})]})},findings:{"Finding Types":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Each finding type represents a specific policy violation:"}),(0,s.jsx)("div",{className:"grid gap-3 not-prose",children:[{type:"LingeringOAuthGrant",sev:"High/Critical",desc:"OAuth tokens remain active after offboarding. The employee can still access Google services through authorized third-party apps.",action:"Revoke All OAuth Grants or Full Bundle"},{type:"LingeringASP",sev:"Medium",desc:"Application-Specific Passwords remain active, allowing email access through legacy mail clients.",action:"Delete ASPs or Full Bundle"},{type:"PostOffboardLogin",sev:"High",desc:"A login event was detected from the employee's account after their offboarding date.",action:"Sign Out User or Full Bundle"},{type:"PostOffboardSuspiciousLogin",sev:"Critical",desc:"A suspicious login (unusual IP, device, or location) was detected post-offboarding.",action:"Sign Out User + Investigation"},{type:"AdminMFAWeak",sev:"Critical",desc:"An admin account lacks strong two-factor authentication (only SMS or no 2FA).",action:"Manual — enforce hardware security key"},{type:"DWDHighRisk",sev:"Critical",desc:"Domain-Wide Delegation grant to a service account with sensitive scopes (admin, directory, gmail.send).",action:"Manual — review and restrict DWD scopes"},{type:"OffboardingNotEnforced",sev:"High",desc:"The employee's account has not been suspended or deleted after offboarding.",action:"Manual — suspend in Admin Console"}].map(e=>(0,s.jsxs)(n.Card,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("code",{className:"text-sm font-semibold",children:e.type}),(0,s.jsx)(r.Badge,{variant:e.sev.includes("Critical")?"destructive":"default",className:"text-xs",children:e.sev})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.desc}),(0,s.jsxs)("p",{className:"text-sm mt-1",children:[(0,s.jsx)("strong",{children:"Remediation:"})," ",e.action]})]},e.type))})]}),"Severity Levels":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Findings are classified into four severity levels:"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-3 not-prose",children:[{level:"Critical",color:"destructive",desc:"Immediate action required. Active admin-level access or suspicious post-offboard activity."},{level:"High",color:"default",desc:"Urgent. Lingering OAuth grants with sensitive scopes or post-offboard logins.",className:"bg-orange-500/90 text-white"},{level:"Medium",color:"default",desc:"Moderate risk. ASPs or tokens with limited scopes still active.",className:"bg-yellow-500/90 text-black"},{level:"Low",color:"secondary",desc:"Low risk. Read-only access or tokens for non-sensitive services."}].map(e=>(0,s.jsxs)(n.Card,{className:"p-4",children:[(0,s.jsx)(r.Badge,{variant:e.color,className:e.className,children:e.level}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:e.desc})]},e.level))})]}),Evidence:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Each finding can include evidence entries that provide detailed context:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Evidence type"}),' — the category (e.g., "OAuth Token", "Login Event", "ASP")']}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Detail"})," — specific information like client IDs, IP addresses, timestamps, or scope lists"]})]}),(0,s.jsx)("p",{children:"Evidence links findings to specific access artifacts, enabling targeted remediation."})]}),Lifecycle:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Finding lifecycle states:"}),(0,s.jsxs)("ol",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Open"})," — newly discovered, requires attention"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Remediated"})," — the underlying access has been revoked/deleted"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Closed"})," — resolved and acknowledged"]})]}),(0,s.jsx)("p",{children:'When all findings for a case are remediated or closed, the case status automatically transitions to "Remediated".'})]})},"access-artifacts":{"Artifact Types":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Five types of access artifacts are tracked:"}),(0,s.jsx)("div",{className:"grid gap-3 not-prose",children:[{type:"OAuthToken",desc:"Third-party application OAuth grants. Each token has scopes defining what the app can access (Drive, Gmail, Calendar, Admin, etc.)."},{type:"ASP",desc:"Application-Specific Passwords for legacy mail clients (Thunderbird, Outlook, Apple Mail). Provide full email access without OAuth."},{type:"LoginEvent",desc:"Detected login activities. Includes IP address, user agent, and timestamp. Flagged when occurring after offboarding date."},{type:"AdminMFA",desc:"Admin Console MFA settings. Flagged when admin accounts lack hardware security keys or have only SMS-based verification."},{type:"DWDChange",desc:"Domain-Wide Delegation changes. Service accounts with broad scopes that could access user data across the organization."}].map(e=>(0,s.jsxs)(n.Card,{className:"p-4",children:[(0,s.jsx)("code",{className:"text-sm font-semibold",children:e.type}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.desc})]},e.type))})]}),"Risk Levels":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Artifacts are assigned risk levels based on the sensitivity of their access:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Critical"})," — Admin-level access, sensitive scopes (admin.directory, gmail.send, DWD)"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"High"})," — Broad data access (Drive read/write, Gmail, Contacts)"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Medium"})," — Limited but notable access (Calendar, Tasks, profile)"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Low"})," — Read-only or minimal scope access (userinfo.profile, drive.readonly)"]})]})]}),Scopes:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"OAuth scopes define the level of access granted to third-party applications. Common scopes include:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("code",{children:"drive"})," / ",(0,s.jsx)("code",{children:"drive.file"})," — Google Drive access"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("code",{children:"gmail.readonly"})," / ",(0,s.jsx)("code",{children:"gmail.send"})," — Gmail access"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("code",{children:"calendar"})," / ",(0,s.jsx)("code",{children:"calendar.readonly"})," — Calendar access"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("code",{children:"admin.directory.user"})," — Admin Directory access (high risk)"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("code",{children:"contacts"})," — Contacts access"]})]}),(0,s.jsx)("p",{children:'Scopes are classified as "read" or "write" level. Write-level scopes (send, modify, compose, admin, manage) are considered higher risk.'})]}),Discovery:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Artifacts are discovered through two mechanisms:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Case scan"})," — targets a specific employee, querying Google Workspace APIs for their OAuth tokens, ASPs, and recent login activity."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"System scan"}),' — broad scan that discovers "hidden" artifacts not yet assigned to a case and creates cases automatically for offboarded employees.']})]})]})},"audit-log":{"Action Types":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"The audit log tracks these action types:"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 not-prose",children:["CaseCreated","ScanStarted","ScanFinished","RemediationStarted","RemediationCompleted","TokenRevoked","ASPDeleted","UserSignedOut","GlobalAppRemoval","SettingsUpdated"].map(e=>(0,s.jsx)(n.Card,{className:"p-3",children:(0,s.jsx)("code",{className:"text-sm",children:e})},e))})]}),Entries:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Each audit log entry records:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Actor"}),' — who performed the action (user or "Scheduler")']}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Action type"})," — the category of action"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Target email"})," — the employee or system target"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Result"})," — Success or Failure"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Request/Response JSON"})," — raw data for forensic review"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Timestamp"})," — exact time of the action"]})]}),(0,s.jsxs)("p",{children:["Audit log entries are ",(0,s.jsx)("strong",{children:"immutable"})," — they cannot be edited or deleted once created."]})]}),Filtering:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"The audit log can be filtered by:"}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"Action type (scan, remediation, etc.)"}),(0,s.jsx)("li",{children:"Target email"}),(0,s.jsx)("li",{children:"Date range"}),(0,s.jsx)("li",{children:"Actor"})]}),(0,s.jsx)("p",{children:"The most recent 100 entries are loaded by default, with older entries available via pagination."})]})},remediation:{"Full Bundle":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:["The ",(0,s.jsx)("strong",{children:"Full Remediation Bundle"})," executes all automated remediation steps in sequence:"]}),(0,s.jsxs)("ol",{children:[(0,s.jsx)("li",{children:"Revoke all OAuth tokens for the employee"}),(0,s.jsx)("li",{children:"Delete all Application-Specific Passwords"}),(0,s.jsx)("li",{children:"Sign out all active sessions"}),(0,s.jsx)("li",{children:"Close all open findings"}),(0,s.jsx)("li",{children:'Update case status to "Remediated"'})]}),(0,s.jsx)("p",{children:"This is the recommended action for complete offboarding cleanup. Available from the case detail page."})]}),"Standalone Actions":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Individual remediation actions can be triggered separately:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Revoke OAuth Grants"})," — revokes all OAuth tokens, closes LingeringOAuthGrant findings"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Delete ASPs"})," — deletes all Application-Specific Passwords, closes LingeringASP findings"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Sign Out User"})," — terminates all active sessions, closes PostOffboardLogin findings"]})]}),(0,s.jsx)("p",{children:"Standalone actions are useful when only specific types of access need to be addressed."})]}),Scheduling:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Cases can have scheduled remediation:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:["Set a ",(0,s.jsx)("strong",{children:"scheduled_remediation_date"})," on the case"]}),(0,s.jsx)("li",{children:"The scheduler checks for due remediations at the configured interval"}),(0,s.jsx)("li",{children:"When the date arrives, full bundle remediation is executed automatically"}),(0,s.jsx)("li",{children:"7-day and 1-day notification reminders are sent if configured"})]}),(0,s.jsx)("p",{children:'Use "Run Scheduled Now" on a case detail page to execute scheduled remediation immediately.'})]}),"Bulk Operations":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Bulk remediation options:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Case-level bulk"})," — select multiple artifacts within a case and remediate them together"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Artifact page bulk"})," — select artifacts across cases from the artifacts list page"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Employee revoke"})," — revoke all access for an employee across all their cases"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Global app removal"})," — revoke a specific app for all users organization-wide"]})]})]})},integrations:{"HRMS Employee":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"OGM integrates with Frappe HRMS for employee lifecycle events:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:["When an employee's status changes to ",(0,s.jsx)("strong",{children:'"Left"'}),", an Offboarding Case is auto-created (if ",(0,s.jsx)("code",{children:"auto_create_case_on_leave"})," is enabled)."]}),(0,s.jsx)("li",{children:"Employee data (name, email, department, designation) is synchronized from HRMS."}),(0,s.jsx)("li",{children:"Department transfers can trigger security reviews."})]})]}),"Google Workspace":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"The scanner service connects to Google Workspace Admin SDK to:"}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"List OAuth tokens granted to third-party apps"}),(0,s.jsx)("li",{children:"Enumerate Application-Specific Passwords"}),(0,s.jsx)("li",{children:"Query login/audit events from the Reports API"}),(0,s.jsx)("li",{children:"Check admin account MFA settings"}),(0,s.jsx)("li",{children:"Review Domain-Wide Delegation configurations"})]}),(0,s.jsx)("p",{children:"Authentication uses a service account with appropriate admin scopes."})]}),"Frappe Scheduler":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"The background scheduler runs four task types:"}),(0,s.jsxs)("ol",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Background scan"})," — system-wide scan at configurable intervals"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Remediation check"})," — processes scheduled remediations that are due"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Daily case scan"})," — re-scans Draft and Scheduled cases once per day"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Notifications"})," — sends reminder emails for upcoming scheduled remediations"]})]}),(0,s.jsxs)("p",{children:["Run with ",(0,s.jsx)("code",{children:"npx tsx scripts/scheduler.ts"})," for continuous operation, or ",(0,s.jsx)("code",{children:"--once"})," for a single pass."]})]}),Webhooks:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Future integration points (planned):"}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"Slack/Teams notifications for new findings"}),(0,s.jsx)("li",{children:"SIEM integration for audit log streaming"}),(0,s.jsx)("li",{children:"Custom webhook endpoints for third-party integrations"})]})]})}};function f(){let e,r,a,c,[d,o]=(0,i.useState)(p[0].id),[l,h]=(0,i.useState)(p[0].subsections[0]),g=p.find(e=>e.id===d),f=x[d]?.[l];return(0,s.jsxs)("div",{className:"flex gap-8 max-w-7xl mx-auto",children:[(0,s.jsx)("aside",{className:"w-64 shrink-0 hidden md:block",children:(0,s.jsxs)("div",{className:"sticky top-0 space-y-1 max-h-[calc(100vh-8rem)] overflow-y-auto pr-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4 pb-3 border-b",children:[(0,s.jsx)(u.BookOpen,{className:"h-5 w-5 text-primary"}),(0,s.jsx)("h2",{className:"font-semibold text-lg",children:"Documentation"})]}),p.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("button",{onClick:()=>{o(e.id),h(e.subsections[0])},className:`flex items-center gap-2 w-full text-left px-3 py-2 rounded-md text-sm transition-colors ${d===e.id?"bg-primary text-primary-foreground font-medium":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"}`,children:[(0,s.jsx)(e.icon,{className:"h-4 w-4 shrink-0"}),e.title]}),d===e.id&&(0,s.jsx)("div",{className:"ml-6 mt-1 space-y-0.5 mb-2",children:e.subsections.map(e=>(0,s.jsx)("button",{onClick:()=>h(e),className:`block w-full text-left px-3 py-1.5 rounded-md text-sm transition-colors ${l===e?"bg-accent text-accent-foreground font-medium":"text-muted-foreground hover:bg-accent/50"}`,children:e},e))})]},e.id))]})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-2",children:[(0,s.jsx)(t.default,{href:"/docs",className:"hover:text-foreground",children:"Docs"}),(0,s.jsx)(m.ChevronRight,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:g.title}),(0,s.jsx)(m.ChevronRight,{className:"h-3 w-3"}),(0,s.jsx)("span",{className:"text-foreground",children:l})]}),(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:l}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2 text-lg",children:g.description})]}),(0,s.jsx)(n.Card,{children:(0,s.jsx)(n.CardContent,{className:"pt-8 pb-8 px-8",children:(0,s.jsx)("div",{className:"prose prose-neutral dark:prose-invert max-w-none prose-headings:scroll-mt-20 prose-p:leading-7 prose-li:leading-7 prose-ul:space-y-1 prose-ol:space-y-1 prose-code:text-primary prose-code:bg-muted prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded-md prose-code:text-sm prose-code:before:content-none prose-code:after:content-none",children:f})})}),(0,s.jsx)("div",{className:"mt-6 flex items-center justify-between",children:(e=[],p.forEach(s=>s.subsections.forEach(i=>e.push({section:s.id,sub:i}))),a=(r=e.findIndex(e=>e.section===d&&e.sub===l))>0?e[r-1]:null,c=r<e.length-1?e[r+1]:null,(0,s.jsxs)(s.Fragment,{children:[a?(0,s.jsxs)("button",{onClick:()=>{o(a.section),h(a.sub)},className:"text-sm text-muted-foreground hover:text-foreground",children:["← ",a.sub]}):(0,s.jsx)("div",{}),c?(0,s.jsxs)("button",{onClick:()=>{o(c.section),h(c.sub)},className:"text-sm text-muted-foreground hover:text-foreground",children:[c.sub," →"]}):(0,s.jsx)("div",{})]}))})]})]})}e.s(["default",()=>f],1251)}]);