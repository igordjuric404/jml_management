(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";let s=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>s],71689)},32580,e=>{"use strict";var s=e.i(43476),a=e.i(71645),l=e.i(18566),n=e.i(90472),i=e.i(15288),r=e.i(87486),d=e.i(19455),t=e.i(31278),c=e.i(71689),o=e.i(98919),x=e.i(84774),m=e.i(67489),h=e.i(22016),j=e.i(1851),u=e.i(92374);let g=["Critical","High","Medium","Low"],f=["LingeringOAuthGrant","LingeringASP","PostOffboardLogin","PostOffboardSuspiciousLogin","AdminMFAWeak","DWDHighRisk","OffboardingNotEnforced"],p={Critical:"destructive",High:"outline",Medium:"default",Low:"secondary"};function b({severity:e}){let a=p[e]??"secondary";return(0,s.jsx)(r.Badge,{variant:a,className:"High"===e?"bg-orange-500/90 text-white border-orange-600":"Medium"===e?"bg-yellow-500/90 text-black border-yellow-600":"Low"===e?"bg-gray-500/90 text-white border-gray-600":void 0,children:e})}function C({findingId:e}){let{data:a,isLoading:l}=(0,n.useFindingDetail)(e),m=(0,n.useRemediateFinding)();return l?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)(t.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):a?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(h.default,{href:"/findings",children:(0,s.jsxs)(d.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(c.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back to Findings"]})}),!a.closed_at&&(0,s.jsxs)(d.Button,{variant:"destructive",onClick:()=>m.mutate(a.name),disabled:m.isPending,children:[m.isPending?(0,s.jsx)(t.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(o.Shield,{className:"mr-2 h-4 w-4"}),"Remediate Finding"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:a.name}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Finding detail"})]}),(0,s.jsxs)(i.Card,{children:[(0,s.jsx)(i.CardHeader,{children:(0,s.jsx)(i.CardTitle,{className:"text-base",children:"Finding Info"})}),(0,s.jsx)(i.CardContent,{children:(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Type"}),(0,s.jsx)("p",{className:"font-medium",children:a.finding_type})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Severity"}),(0,s.jsx)("p",{children:(0,s.jsx)(b,{severity:a.severity})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Status"}),(0,s.jsx)("p",{children:(0,s.jsx)(r.Badge,{variant:a.closed_at?"secondary":"default",children:a.closed_at?"Closed":"Open"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Case"}),(0,s.jsx)("p",{children:(0,s.jsx)(h.default,{href:`/cases/${a.case}`,className:"text-primary hover:underline",children:a.case})})]})]})})]}),(0,s.jsxs)(i.Card,{children:[(0,s.jsx)(i.CardHeader,{children:(0,s.jsx)(i.CardTitle,{className:"text-base",children:"Summary"})}),(0,s.jsx)(i.CardContent,{children:(0,s.jsx)("p",{className:"text-sm leading-relaxed",children:a.summary})})]}),a.recommended_action&&(0,s.jsxs)(i.Card,{children:[(0,s.jsx)(i.CardHeader,{children:(0,s.jsx)(i.CardTitle,{className:"text-base",children:"Recommended Action"})}),(0,s.jsx)(i.CardContent,{children:(0,s.jsx)("p",{className:"text-sm leading-relaxed",children:a.recommended_action})})]}),a.evidence&&a.evidence.length>0&&(0,s.jsxs)(i.Card,{children:[(0,s.jsx)(i.CardHeader,{children:(0,s.jsx)(i.CardTitle,{className:"text-base",children:"Evidence"})}),(0,s.jsx)(i.CardContent,{children:(0,s.jsxs)(x.Table,{children:[(0,s.jsx)(x.TableHeader,{children:(0,s.jsxs)(x.TableRow,{children:[(0,s.jsx)(x.TableHead,{children:"Type"}),(0,s.jsx)(x.TableHead,{children:"Detail"})]})}),(0,s.jsx)(x.TableBody,{children:a.evidence.map(e=>(0,s.jsxs)(x.TableRow,{children:[(0,s.jsx)(x.TableCell,{className:"font-medium",children:e.evidence_type}),(0,s.jsx)(x.TableCell,{children:e.detail})]},e.name))})]})})]}),(0,s.jsxs)(i.Card,{children:[(0,s.jsx)(i.CardHeader,{children:(0,s.jsx)(i.CardTitle,{className:"text-base",children:"Metadata"})}),(0,s.jsx)(i.CardContent,{children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Created"}),(0,s.jsx)("p",{children:a.creation?(0,j.format)(new Date(a.creation),"PPp"):"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Last Modified"}),(0,s.jsx)("p",{children:a.modified?(0,j.format)(new Date(a.modified),"PPp"):"-"})]}),a.closed_at&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Closed At"}),(0,s.jsx)("p",{children:(0,j.format)(new Date(a.closed_at),"PPp")})]})]})})]})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(h.default,{href:"/findings",children:(0,s.jsxs)(d.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(c.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back to Findings"]})}),(0,s.jsxs)("p",{className:"text-muted-foreground",children:["Finding not found: ",e]})]})}function v(){let e=(0,l.useRouter)(),{sortConfig:d,onSort:c,sortData:o}=(0,u.useSort)(),p=(0,l.useSearchParams)(),v=p.get("finding"),[y,N]=(0,a.useState)(p.get("severity")??"all"),[T,S]=(0,a.useState)(p.get("type")??"all"),w=(0,a.useMemo)(()=>{let e={};return y&&"all"!==y&&(e.severity=y),T&&"all"!==T&&(e.finding_type=T),Object.keys(e).length?e:void 0},[y,T]),{data:H,isLoading:P}=(0,n.useFindings)(w);return v?(0,s.jsx)(C,{findingId:v}):P?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)(t.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Findings"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Policy violations and security gaps from scans"})]}),(0,s.jsxs)(i.Card,{children:[(0,s.jsxs)(i.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,s.jsx)(i.CardTitle,{className:"text-base",children:"All Findings"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(m.Select,{value:y,onValueChange:N,children:[(0,s.jsx)(m.SelectTrigger,{className:"w-[120px]",children:(0,s.jsx)(m.SelectValue,{placeholder:"Severity"})}),(0,s.jsxs)(m.SelectContent,{children:[(0,s.jsx)(m.SelectItem,{value:"all",children:"All severity"}),g.map(e=>(0,s.jsx)(m.SelectItem,{value:e,children:e},e))]})]}),(0,s.jsxs)(m.Select,{value:T,onValueChange:S,children:[(0,s.jsx)(m.SelectTrigger,{className:"w-[180px]",children:(0,s.jsx)(m.SelectValue,{placeholder:"Type"})}),(0,s.jsxs)(m.SelectContent,{children:[(0,s.jsx)(m.SelectItem,{value:"all",children:"All types"}),f.map(e=>(0,s.jsx)(m.SelectItem,{value:e,children:e},e))]})]})]})]}),(0,s.jsx)(i.CardContent,{children:(0,s.jsxs)(x.Table,{children:[(0,s.jsx)(x.TableHeader,{children:(0,s.jsxs)(x.TableRow,{children:[(0,s.jsx)(u.SortableTableHead,{column:"name",label:"Name",sortConfig:d,onSort:c}),(0,s.jsx)(u.SortableTableHead,{column:"case",label:"Case",sortConfig:d,onSort:c}),(0,s.jsx)(u.SortableTableHead,{column:"finding_type",label:"Type",sortConfig:d,onSort:c}),(0,s.jsx)(u.SortableTableHead,{column:"severity",label:"Severity",sortConfig:d,onSort:c}),(0,s.jsx)(u.SortableTableHead,{column:"summary",label:"Summary",sortConfig:d,onSort:c}),(0,s.jsx)(u.SortableTableHead,{column:"closed_at",label:"Status",sortConfig:d,onSort:c}),(0,s.jsx)(u.SortableTableHead,{column:"creation",label:"Created",sortConfig:d,onSort:c})]})}),(0,s.jsx)(x.TableBody,{children:(H?o(H):[]).map(a=>(0,s.jsxs)(x.TableRow,{className:"cursor-pointer",onClick:()=>e.push(`/findings?finding=${encodeURIComponent(a.name)}`),children:[(0,s.jsx)(x.TableCell,{className:"font-medium",children:(0,s.jsx)(h.default,{href:`/findings?finding=${encodeURIComponent(a.name)}`,className:"text-primary hover:underline",onClick:e=>e.stopPropagation(),children:a.name})}),(0,s.jsx)(x.TableCell,{children:(0,s.jsx)(h.default,{href:`/cases/${a.case}`,className:"text-primary hover:underline",onClick:e=>e.stopPropagation(),children:a.case})}),(0,s.jsx)(x.TableCell,{children:a.finding_type}),(0,s.jsx)(x.TableCell,{children:(0,s.jsx)(b,{severity:a.severity})}),(0,s.jsx)(x.TableCell,{className:"max-w-md truncate",children:a.summary}),(0,s.jsx)(x.TableCell,{children:(0,s.jsx)(r.Badge,{variant:a.closed_at?"secondary":"default",children:a.closed_at?"Closed":"Open"})}),(0,s.jsx)(x.TableCell,{children:a.creation?(0,j.format)(new Date(a.creation),"PP"):"-"})]},a.name))})]})})]})]})}function y(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)(t.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),children:(0,s.jsx)(v,{})})}e.s(["default",()=>y])}]);