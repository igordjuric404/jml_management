(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32580,e=>{"use strict";var l=e.i(43476),a=e.i(71645),s=e.i(18566),i=e.i(90472),r=e.i(15288),n=e.i(87486),t=e.i(31278),d=e.i(84774),c=e.i(67489),o=e.i(22016),h=e.i(1851);let x=["Critical","High","Medium","Low"],u=["LingeringOAuthGrant","LingeringASP","PostOffboardLogin","PostOffboardSuspiciousLogin","AdminMFAWeak","DWDHighRisk","OffboardingNotEnforced"],m={Critical:"destructive",High:"outline",Medium:"default",Low:"secondary"};function j({severity:e}){let a=m[e]??"secondary";return(0,l.jsx)(n.Badge,{variant:a,className:"High"===e?"bg-orange-500/90 text-white border-orange-600":"Medium"===e?"bg-yellow-500/90 text-black border-yellow-600":"Low"===e?"bg-gray-500/90 text-white border-gray-600":void 0,children:e})}function g(){let e=(0,s.useSearchParams)(),[m,g]=(0,a.useState)(e.get("severity")??"all"),[f,b]=(0,a.useState)(e.get("type")??"all"),y=(0,a.useMemo)(()=>{let e={};return m&&"all"!==m&&(e.severity=m),f&&"all"!==f&&(e.finding_type=f),Object.keys(e).length?e:void 0},[m,f]),{data:p,isLoading:v}=(0,i.useFindings)(y);return v?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)(t.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"Findings"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"Policy violations and security gaps from scans"})]}),(0,l.jsxs)(r.Card,{children:[(0,l.jsxs)(r.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,l.jsx)(r.CardTitle,{className:"text-base",children:"All Findings"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(c.Select,{value:m,onValueChange:g,children:[(0,l.jsx)(c.SelectTrigger,{className:"w-[120px]",children:(0,l.jsx)(c.SelectValue,{placeholder:"Severity"})}),(0,l.jsxs)(c.SelectContent,{children:[(0,l.jsx)(c.SelectItem,{value:"all",children:"All severity"}),x.map(e=>(0,l.jsx)(c.SelectItem,{value:e,children:e},e))]})]}),(0,l.jsxs)(c.Select,{value:f,onValueChange:b,children:[(0,l.jsx)(c.SelectTrigger,{className:"w-[180px]",children:(0,l.jsx)(c.SelectValue,{placeholder:"Type"})}),(0,l.jsxs)(c.SelectContent,{children:[(0,l.jsx)(c.SelectItem,{value:"all",children:"All types"}),u.map(e=>(0,l.jsx)(c.SelectItem,{value:e,children:e},e))]})]})]})]}),(0,l.jsx)(r.CardContent,{children:(0,l.jsxs)(d.Table,{children:[(0,l.jsx)(d.TableHeader,{children:(0,l.jsxs)(d.TableRow,{children:[(0,l.jsx)(d.TableHead,{children:"Name"}),(0,l.jsx)(d.TableHead,{children:"Case"}),(0,l.jsx)(d.TableHead,{children:"Type"}),(0,l.jsx)(d.TableHead,{children:"Severity"}),(0,l.jsx)(d.TableHead,{children:"Summary"}),(0,l.jsx)(d.TableHead,{children:"Status"}),(0,l.jsx)(d.TableHead,{children:"Created"})]})}),(0,l.jsx)(d.TableBody,{children:p?.map(e=>(0,l.jsxs)(d.TableRow,{children:[(0,l.jsx)(d.TableCell,{className:"font-medium",children:(0,l.jsx)(o.default,{href:`/findings?finding=${encodeURIComponent(e.name)}`,className:"text-primary hover:underline",children:e.name})}),(0,l.jsx)(d.TableCell,{children:(0,l.jsx)(o.default,{href:`/cases/${e.case}`,className:"text-primary hover:underline",children:e.case})}),(0,l.jsx)(d.TableCell,{children:e.finding_type}),(0,l.jsx)(d.TableCell,{children:(0,l.jsx)(j,{severity:e.severity})}),(0,l.jsx)(d.TableCell,{className:"max-w-md truncate",children:e.summary}),(0,l.jsx)(d.TableCell,{children:(0,l.jsx)(n.Badge,{variant:e.closed_at?"secondary":"default",children:e.closed_at?"Closed":"Open"})}),(0,l.jsx)(d.TableCell,{children:e.creation?(0,h.format)(new Date(e.creation),"PP"):"-"})]},e.name))})]})})]})]})}function f(){return(0,l.jsx)(a.Suspense,{fallback:(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)(t.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),children:(0,l.jsx)(g,{})})}e.s(["default",()=>f])}]);