(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var i=e.i(43476),s=e.i(75157);function n({className:e,...n}){return(0,i.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...n})}function r({className:e,...n}){return(0,i.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...n})}function t({className:e,...n}){return(0,i.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",e),...n})}function a({className:e,...n}){return(0,i.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",e),...n})}function d({className:e,...n}){return(0,i.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",e),...n})}e.s(["Card",()=>n,"CardContent",()=>d,"CardDescription",()=>a,"CardHeader",()=>r,"CardTitle",()=>t])},1251,e=>{"use strict";var i=e.i(43476),s=e.i(71645),n=e.i(22016),r=e.i(15288);let t=[{id:"architecture",title:"Architecture"},{id:"findings",title:"Findings"},{id:"access-artifacts",title:"Access Artifacts"},{id:"audit-log",title:"Audit Log"},{id:"remediation",title:"Remediation"},{id:"integrations",title:"Integrations"}];function a(){let[e,a]=(0,s.useState)(t[0].id);return(0,i.jsxs)("div",{className:"flex gap-8",children:[(0,i.jsx)("aside",{className:"w-56 shrink-0 hidden md:block",children:(0,i.jsx)("nav",{className:"sticky top-6 space-y-1",children:t.map(s=>(0,i.jsx)("button",{onClick:()=>{a(s.id),document.getElementById(s.id)?.scrollIntoView()},className:`block w-full text-left px-3 py-2 rounded-md text-sm ${e===s.id?"bg-primary text-primary-foreground":"hover:bg-accent"}`,children:s.title},s.id))})}),(0,i.jsxs)("div",{className:"flex-1 space-y-8",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-2xl font-bold",children:"Documentation"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"OAuth Gap Monitor — system architecture and concepts"})]}),(0,i.jsx)("section",{id:"architecture",children:(0,i.jsxs)(r.Card,{children:[(0,i.jsx)(r.CardHeader,{children:(0,i.jsx)(r.CardTitle,{children:"Architecture"})}),(0,i.jsxs)(r.CardContent,{className:"prose dark:prose-invert max-w-none",children:[(0,i.jsxs)("p",{children:["The OAuth Gap Monitor is a decoupled system comprising a"," ",(0,i.jsx)("strong",{children:"Frappe App"})," (frontend, database, API) and an"," ",(0,i.jsx)("strong",{children:"External Scanner Service"})," (Python worker)."]}),(0,i.jsx)("p",{children:"Key DocTypes:"}),(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:[(0,i.jsx)(n.default,{href:"/cases",className:"text-primary hover:underline",children:"Offboarding Case"}),"— Represents an employee offboarding event. Tracks status (Draft → Scheduled → Scanned → Gaps Found → Remediated)."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)(n.default,{href:"/artifacts",className:"text-primary hover:underline",children:"Access Artifact"}),"— OAuth tokens, ASPs, login events, and other access mechanisms."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)(n.default,{href:"/findings",className:"text-primary hover:underline",children:"Finding"}),"— Policy violations (e.g., LingeringOAuthGrant, PostOffboardLogin)."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)(n.default,{href:"/audit-log",className:"text-primary hover:underline",children:"Unified Audit Log Entry"}),"— Immutable record of all scan and remediation actions."]})]})]})]})}),(0,i.jsx)("section",{id:"findings",children:(0,i.jsxs)(r.Card,{children:[(0,i.jsx)(r.CardHeader,{children:(0,i.jsx)(r.CardTitle,{children:"Findings"})}),(0,i.jsxs)(r.CardContent,{className:"prose dark:prose-invert max-w-none",children:[(0,i.jsx)("p",{children:"Findings are policy violations detected by the scanner. Each type has a severity and recommended remediation."}),(0,i.jsx)("p",{children:"Finding types:"}),(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"LingeringOAuthGrant"})," — OAuth tokens remain after offboarding. Remediation:"," ",(0,i.jsx)(n.default,{href:"/cases",className:"text-primary hover:underline",children:"Revoke All OAuth Grants"})," or Full Bundle."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"LingeringASP"})," — Application-Specific Passwords remain. Remediation: Delete ASPs or Full Bundle."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"PostOffboardLogin"})," / ",(0,i.jsx)("strong",{children:"PostOffboardSuspiciousLogin"})," — Login detected after offboarding. Remediation: Sign Out User or Full Bundle."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"OffboardingNotEnforced"})," — User not suspended. Requires manual suspension in Admin Console."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"AdminMFAWeak"})," — Admin without 2SV enforced. Manual fix in Admin Console."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"DWDHighRisk"})," — Domain-wide delegation with sensitive scopes. Manual review."]})]}),(0,i.jsx)(n.default,{href:"/findings",className:"text-primary hover:underline",children:"View all findings →"})]})]})}),(0,i.jsx)("section",{id:"access-artifacts",children:(0,i.jsxs)(r.Card,{children:[(0,i.jsx)(r.CardHeader,{children:(0,i.jsx)(r.CardTitle,{children:"Access Artifacts"})}),(0,i.jsxs)(r.CardContent,{className:"prose dark:prose-invert max-w-none",children:[(0,i.jsx)("p",{children:"Artifacts are concrete access mechanisms: OAuth tokens, ASPs, login events, etc."}),(0,i.jsx)("p",{children:"Artifact types: OAuthToken, ASP, LoginEvent, AdminMFA, DWDChange."}),(0,i.jsx)("p",{children:"Artifacts provide the raw evidence; Findings are conclusions drawn from them. One Finding may reference multiple Artifacts."}),(0,i.jsx)(n.default,{href:"/artifacts",className:"text-primary hover:underline",children:"View all artifacts →"})]})]})}),(0,i.jsx)("section",{id:"audit-log",children:(0,i.jsxs)(r.Card,{children:[(0,i.jsx)(r.CardHeader,{children:(0,i.jsx)(r.CardTitle,{children:"Audit Log"})}),(0,i.jsxs)(r.CardContent,{className:"prose dark:prose-invert max-w-none",children:[(0,i.jsx)("p",{children:"The audit log is an immutable record of who did what, to whom, when, and the result."}),(0,i.jsx)("p",{children:"Action types: ScanStarted, ScanFinished, RemediationStarted, RemediationCompleted, TokenRevoked, ASPDeleted, UserSignedOut, GlobalAppRemoval, etc."}),(0,i.jsx)(n.default,{href:"/audit-log",className:"text-primary hover:underline",children:"View audit log →"})]})]})}),(0,i.jsx)("section",{id:"remediation",children:(0,i.jsxs)(r.Card,{children:[(0,i.jsx)(r.CardHeader,{children:(0,i.jsx)(r.CardTitle,{children:"Remediation"})}),(0,i.jsxs)(r.CardContent,{className:"prose dark:prose-invert max-w-none",children:[(0,i.jsxs)("p",{children:["The ",(0,i.jsx)("strong",{children:"Full Remediation Bundle"})," executes all automated steps:"]}),(0,i.jsxs)("ol",{children:[(0,i.jsx)("li",{children:"Revoke all OAuth tokens"}),(0,i.jsx)("li",{children:"Delete all ASPs"}),(0,i.jsx)("li",{children:"Sign out all sessions"}),(0,i.jsx)("li",{children:"Close all findings"}),(0,i.jsx)("li",{children:"Update case status"})]}),(0,i.jsxs)("p",{children:["Standalone actions: Revoke OAuth Grants, Delete ASPs, Sign Out User. Available from ",(0,i.jsx)(n.default,{href:"/cases",className:"text-primary hover:underline",children:"case detail"}),"."]})]})]})}),(0,i.jsx)("section",{id:"integrations",children:(0,i.jsxs)(r.Card,{children:[(0,i.jsx)(r.CardHeader,{children:(0,i.jsx)(r.CardTitle,{children:"Integrations"})}),(0,i.jsxs)(r.CardContent,{className:"prose dark:prose-invert max-w-none",children:[(0,i.jsx)("p",{children:"OGM integrates with:"}),(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"HRMS Employee"})," — Auto-creates ",(0,i.jsx)(n.default,{href:"/cases",className:"text-primary hover:underline",children:"Offboarding Cases"})," when employee status changes to Left."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Frappe Scheduler"})," — Background jobs for scanning, remediation, notifications."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Google Workspace APIs"})," — Directory, Reports, Admin SDK for token/ASP management."]})]})]})]})})]})]})}e.s(["default",()=>a])}]);