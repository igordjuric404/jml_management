(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var t=e.i(43476),r=e.i(75157);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function a({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function n({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",e),...s})}function i({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...s})}function o({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>o,"CardDescription",()=>i,"CardHeader",()=>a,"CardTitle",()=>n])},31278,e=>{"use strict";var t=e.i(17521);e.s(["Loader2",()=>t.default])},90472,e=>{"use strict";let t;var r=e.i(75555),s=e.i(40143),a=e.i(86491),n=e.i(15823),i=e.i(93803),o=e.i(19273),u=e.i(80166),l=class extends n.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#r=(0,i.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#s=void 0;#a=void 0;#n=void 0;#i;#o;#r;#t;#u;#l;#c;#d;#h;#m;#f=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#s.addObserver(this),c(this.#s,this.options)?this.#p():this.updateResult(),this.#y())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return d(this.#s,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return d(this.#s,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#g(),this.#b(),this.#s.removeObserver(this)}setOptions(e){let t=this.options,r=this.#s;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,o.resolveEnabled)(this.options.enabled,this.#s))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#v(),this.#s.setOptions(this.options),t._defaulted&&!(0,o.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#s,observer:this});let s=this.hasListeners();s&&h(this.#s,r,this.options,t)&&this.#p(),this.updateResult(),s&&(this.#s!==r||(0,o.resolveEnabled)(this.options.enabled,this.#s)!==(0,o.resolveEnabled)(t.enabled,this.#s)||(0,o.resolveStaleTime)(this.options.staleTime,this.#s)!==(0,o.resolveStaleTime)(t.staleTime,this.#s))&&this.#x();let a=this.#R();s&&(this.#s!==r||(0,o.resolveEnabled)(this.options.enabled,this.#s)!==(0,o.resolveEnabled)(t.enabled,this.#s)||a!==this.#m)&&this.#S(a)}getOptimisticResult(e){var t,r;let s=this.#e.getQueryCache().build(this.#e,e),a=this.createResult(s,e);return t=this,r=a,(0,o.shallowEqualObjects)(t.getCurrentResult(),r)||(this.#n=a,this.#o=this.options,this.#i=this.#s.state),a}getCurrentResult(){return this.#n}trackResult(e,t){return new Proxy(e,{get:(e,r)=>(this.trackProp(r),t?.(r),"promise"===r&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#r.status||this.#r.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,r))})}trackProp(e){this.#f.add(e)}getCurrentQuery(){return this.#s}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),r=this.#e.getQueryCache().build(this.#e,t);return r.fetch().then(()=>this.createResult(r,t))}fetch(e){return this.#p({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#n))}#p(e){this.#v();let t=this.#s.fetch(this.options,e);return e?.throwOnError||(t=t.catch(o.noop)),t}#x(){this.#g();let e=(0,o.resolveStaleTime)(this.options.staleTime,this.#s);if(o.isServer||this.#n.isStale||!(0,o.isValidTimeout)(e))return;let t=(0,o.timeUntilStale)(this.#n.dataUpdatedAt,e);this.#d=u.timeoutManager.setTimeout(()=>{this.#n.isStale||this.updateResult()},t+1)}#R(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#s):this.options.refetchInterval)??!1}#S(e){this.#b(),this.#m=e,!o.isServer&&!1!==(0,o.resolveEnabled)(this.options.enabled,this.#s)&&(0,o.isValidTimeout)(this.#m)&&0!==this.#m&&(this.#h=u.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||r.focusManager.isFocused())&&this.#p()},this.#m))}#y(){this.#x(),this.#S(this.#R())}#g(){this.#d&&(u.timeoutManager.clearTimeout(this.#d),this.#d=void 0)}#b(){this.#h&&(u.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let r,s=this.#s,n=this.options,u=this.#n,l=this.#i,d=this.#o,f=e!==s?e.state:this.#a,{state:p}=e,y={...p},g=!1;if(t._optimisticResults){let r=this.hasListeners(),i=!r&&c(e,t),o=r&&h(e,s,t,n);(i||o)&&(y={...y,...(0,a.fetchState)(p.data,e.options)}),"isRestoring"===t._optimisticResults&&(y.fetchStatus="idle")}let{error:b,errorUpdatedAt:v,status:x}=y;r=y.data;let R=!1;if(void 0!==t.placeholderData&&void 0===r&&"pending"===x){let e;u?.isPlaceholderData&&t.placeholderData===d?.placeholderData?(e=u.data,R=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#c?.state.data,this.#c):t.placeholderData,void 0!==e&&(x="success",r=(0,o.replaceData)(u?.data,e,t),g=!0)}if(t.select&&void 0!==r&&!R)if(u&&r===l?.data&&t.select===this.#u)r=this.#l;else try{this.#u=t.select,r=t.select(r),r=(0,o.replaceData)(u?.data,r,t),this.#l=r,this.#t=null}catch(e){this.#t=e}this.#t&&(b=this.#t,r=this.#l,v=Date.now(),x="error");let S="fetching"===y.fetchStatus,w="pending"===x,C="error"===x,j=w&&S,M=void 0!==r,T={status:x,fetchStatus:y.fetchStatus,isPending:w,isSuccess:"success"===x,isError:C,isInitialLoading:j,isLoading:j,data:r,dataUpdatedAt:y.dataUpdatedAt,error:b,errorUpdatedAt:v,failureCount:y.fetchFailureCount,failureReason:y.fetchFailureReason,errorUpdateCount:y.errorUpdateCount,isFetched:y.dataUpdateCount>0||y.errorUpdateCount>0,isFetchedAfterMount:y.dataUpdateCount>f.dataUpdateCount||y.errorUpdateCount>f.errorUpdateCount,isFetching:S,isRefetching:S&&!w,isLoadingError:C&&!M,isPaused:"paused"===y.fetchStatus,isPlaceholderData:g,isRefetchError:C&&M,isStale:m(e,t),refetch:this.refetch,promise:this.#r,isEnabled:!1!==(0,o.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=void 0!==T.data,r="error"===T.status&&!t,a=e=>{r?e.reject(T.error):t&&e.resolve(T.data)},n=()=>{a(this.#r=T.promise=(0,i.pendingThenable)())},o=this.#r;switch(o.status){case"pending":e.queryHash===s.queryHash&&a(o);break;case"fulfilled":(r||T.data!==o.value)&&n();break;case"rejected":r&&T.error===o.reason||n()}}return T}updateResult(){let e=this.#n,t=this.createResult(this.#s,this.options);if(this.#i=this.#s.state,this.#o=this.options,void 0!==this.#i.data&&(this.#c=this.#s),(0,o.shallowEqualObjects)(t,e))return;this.#n=t;let r=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,r="function"==typeof t?t():t;if("all"===r||!r&&!this.#f.size)return!0;let s=new Set(r??this.#f);return this.options.throwOnError&&s.add("error"),Object.keys(this.#n).some(t=>this.#n[t]!==e[t]&&s.has(t))};this.#w({listeners:r()})}#v(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#s)return;let t=this.#s;this.#s=e,this.#a=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#y()}#w(e){s.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#n)}),this.#e.getQueryCache().notify({query:this.#s,type:"observerResultsUpdated"})})}};function c(e,t){return!1!==(0,o.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&d(e,t,t.refetchOnMount)}function d(e,t,r){if(!1!==(0,o.resolveEnabled)(t.enabled,e)&&"static"!==(0,o.resolveStaleTime)(t.staleTime,e)){let s="function"==typeof r?r(e):r;return"always"===s||!1!==s&&m(e,t)}return!1}function h(e,t,r,s){return(e!==t||!1===(0,o.resolveEnabled)(s.enabled,e))&&(!r.suspense||"error"!==e.state.status)&&m(e,r)}function m(e,t){return!1!==(0,o.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,o.resolveStaleTime)(t.staleTime,e))}e.i(47167);var f=e.i(71645),p=e.i(12598);e.i(43476);var y=f.createContext((t=!1,{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t})),g=f.createContext(!1);g.Provider;var b=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function v(e,t){return function(e,t,r){let a,n=f.useContext(g),i=f.useContext(y),u=(0,p.useQueryClient)(r),l=u.defaultQueryOptions(e);u.getDefaultOptions().queries?._experimental_beforeQuery?.(l);let c=u.getQueryCache().get(l.queryHash);if(l._optimisticResults=n?"isRestoring":"optimistic",l.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=l.staleTime;l.staleTime="function"==typeof t?(...r)=>e(t(...r)):e(t),"number"==typeof l.gcTime&&(l.gcTime=Math.max(l.gcTime,1e3))}a=c?.state.error&&"function"==typeof l.throwOnError?(0,o.shouldThrowError)(l.throwOnError,[c.state.error,c]):l.throwOnError,(l.suspense||l.experimental_prefetchInRender||a)&&!i.isReset()&&(l.retryOnMount=!1),f.useEffect(()=>{i.clearReset()},[i]);let d=!u.getQueryCache().get(l.queryHash),[h]=f.useState(()=>new t(u,l)),m=h.getOptimisticResult(l),v=!n&&!1!==e.subscribed;if(f.useSyncExternalStore(f.useCallback(e=>{let t=v?h.subscribe(s.notifyManager.batchCalls(e)):o.noop;return h.updateResult(),t},[h,v]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),f.useEffect(()=>{h.setOptions(l)},[l,h]),l?.suspense&&m.isPending)throw b(l,h,i);if((({result:e,errorResetBoundary:t,throwOnError:r,query:s,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(a&&void 0===e.data||(0,o.shouldThrowError)(r,[e.error,s])))({result:m,errorResetBoundary:i,throwOnError:l.throwOnError,query:c,suspense:l.suspense}))throw m.error;if(u.getDefaultOptions().queries?._experimental_afterQuery?.(l,m),l.experimental_prefetchInRender&&!o.isServer&&m.isLoading&&m.isFetching&&!n){let e=d?b(l,h,i):c?.promise;e?.catch(o.noop).finally(()=>{h.updateResult()})}return l.notifyOnChangeProps?m:h.trackResult(m)}(e,l,t)}var x=e.i(14272),R=n,S=class extends R.Subscribable{#e;#n=void 0;#C;#j;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#M()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,o.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#C,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.hashKey)(t.mutationKey)!==(0,o.hashKey)(this.options.mutationKey)?this.reset():this.#C?.state.status==="pending"&&this.#C.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#C?.removeObserver(this)}onMutationUpdate(e){this.#M(),this.#w(e)}getCurrentResult(){return this.#n}reset(){this.#C?.removeObserver(this),this.#C=void 0,this.#M(),this.#w()}mutate(e,t){return this.#j=t,this.#C?.removeObserver(this),this.#C=this.#e.getMutationCache().build(this.#e,this.options),this.#C.addObserver(this),this.#C.execute(e)}#M(){let e=this.#C?.state??(0,x.getDefaultState)();this.#n={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#w(e){s.notifyManager.batch(()=>{if(this.#j&&this.hasListeners()){let t=this.#n.variables,r=this.#n.context,s={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#j.onSuccess?.(e.data,t,r,s)}catch(e){Promise.reject(e)}try{this.#j.onSettled?.(e.data,null,t,r,s)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#j.onError?.(e.error,t,r,s)}catch(e){Promise.reject(e)}try{this.#j.onSettled?.(void 0,e.error,t,r,s)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#n)})})}};function w(e,t){let r=(0,p.useQueryClient)(t),[a]=f.useState(()=>new S(r,e));f.useEffect(()=>{a.setOptions(e)},[a,e]);let n=f.useSyncExternalStore(f.useCallback(e=>a.subscribe(s.notifyManager.batchCalls(e)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),i=f.useCallback((e,t)=>{a.mutate(e,t).catch(o.noop)},[a]);if(n.error&&(0,o.shouldThrowError)(a.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:i,mutateAsync:n.mutate}}var C=e.i(46696);async function j(e,t){let r=await fetch(e,t),s=await r.json();if("error"===s.status)throw Error(s.error||"API error");return s.data}async function M(e,t){return j(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}async function T(e,t){return j(e,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}function Q(){return v({queryKey:["dashboard"],queryFn:()=>j("/api/dashboard")})}function D(){return v({queryKey:["cases"],queryFn:()=>j("/api/cases")})}function O(e){return v({queryKey:["cases",e],queryFn:()=>j(`/api/cases/${e}`),enabled:!!e})}function q(){let e=(0,p.useQueryClient)();return w({mutationFn:e=>M("/api/cases/from-employee",{employee_id:e}),onSuccess:()=>{e.invalidateQueries({queryKey:["cases"]}),e.invalidateQueries({queryKey:["dashboard"]}),e.invalidateQueries({queryKey:["employees"]}),C.toast.success("Case created from employee")},onError:e=>C.toast.error(e.message)})}function E(e){let t=(0,p.useQueryClient)();return w({mutationFn:()=>M(`/api/cases/${e}/scan`,{}),onSuccess:()=>{t.invalidateQueries({queryKey:["cases",e]}),t.invalidateQueries({queryKey:["dashboard"]}),C.toast.success("Scan triggered")},onError:e=>C.toast.error(e.message)})}function F(e){let t=(0,p.useQueryClient)();return w({mutationFn:t=>M(`/api/cases/${e}/remediate`,t),onSuccess:r=>{t.invalidateQueries({queryKey:["cases"]}),t.invalidateQueries({queryKey:["cases",e]}),t.invalidateQueries({queryKey:["dashboard"]}),C.toast.success(`Remediation completed: ${r.artifacts_remediated||r.revoked||r.deleted||0} item(s)`)},onError:e=>C.toast.error(e.message)})}function I(e){let t=(0,p.useQueryClient)();return w({mutationFn:()=>M(`/api/cases/${e}/scheduled-remediation`,{}),onSuccess:()=>{t.invalidateQueries({queryKey:["cases",e]}),t.invalidateQueries({queryKey:["cases"]}),t.invalidateQueries({queryKey:["dashboard"]}),C.toast.success("Scheduled remediation completed")},onError:e=>C.toast.error(e.message)})}function k(e){let t=(0,p.useQueryClient)();return w({mutationFn:t=>M(`/api/cases/${e}/bulk-remediate`,{artifact_names:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["cases",e]}),t.invalidateQueries({queryKey:["cases"]}),t.invalidateQueries({queryKey:["dashboard"]}),C.toast.success("Bulk remediation completed")},onError:e=>C.toast.error(e.message)})}function N(){let e=(0,p.useQueryClient)();return w({mutationFn:()=>M("/api/scan",{}),onSuccess:()=>{e.invalidateQueries({queryKey:["dashboard"]}),e.invalidateQueries({queryKey:["cases"]}),C.toast.success("System scan queued")},onError:e=>C.toast.error(e.message)})}function P(e){let t=new URLSearchParams(e);return v({queryKey:["artifacts",e],queryFn:()=>j(`/api/artifacts?${t.toString()}`)})}function K(){let e=(0,p.useQueryClient)();return w({mutationFn:e=>M("/api/artifacts",{docnames:e}),onSuccess:()=>{e.invalidateQueries({queryKey:["artifacts"]}),e.invalidateQueries({queryKey:["cases"]}),e.invalidateQueries({queryKey:["dashboard"]}),C.toast.success("Artifacts remediated")},onError:e=>C.toast.error(e.message)})}function A(e){let t=new URLSearchParams(e);return v({queryKey:["findings",e],queryFn:()=>j(`/api/findings?${t.toString()}`)})}function W(){return v({queryKey:["employees"],queryFn:()=>j("/api/employees")})}function U(e){return v({queryKey:["employees",e],queryFn:()=>j(`/api/employees/${e}`),enabled:!!e})}function _(e){let t=(0,p.useQueryClient)();return w({mutationFn:t=>M(`/api/employees/${e}/revoke`,{scope:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["employees"]}),t.invalidateQueries({queryKey:["dashboard"]}),C.toast.success("Employee access revoked")},onError:e=>C.toast.error(e.message)})}function H(){return v({queryKey:["apps"],queryFn:()=>j("/api/apps")})}function X(e){return v({queryKey:["apps",e],queryFn:()=>j(`/api/apps/${encodeURIComponent(e)}`),enabled:!!e})}function z(){let e=(0,p.useQueryClient)();return w({mutationFn:e=>M(`/api/apps/${encodeURIComponent(e.clientId)}/global-remove`,{app_name:e.appName}),onSuccess:()=>{e.invalidateQueries({queryKey:["apps"]}),e.invalidateQueries({queryKey:["dashboard"]}),C.toast.success("App globally revoked")},onError:e=>C.toast.error(e.message)})}function L(e){let t=(0,p.useQueryClient)();return w({mutationFn:t=>M(`/api/apps/${encodeURIComponent(e)}/revoke-users`,{artifact_names:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["apps",e]}),t.invalidateQueries({queryKey:["dashboard"]}),C.toast.success("App revoked for selected users")},onError:e=>C.toast.error(e.message)})}function $(e){let t=(0,p.useQueryClient)();return w({mutationFn:t=>M(`/api/apps/${encodeURIComponent(e)}/restore-users`,{artifact_names:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["apps",e]}),t.invalidateQueries({queryKey:["dashboard"]}),C.toast.success("App restored for selected users")},onError:e=>C.toast.error(e.message)})}function B(e){let t=(0,p.useQueryClient)();return w({mutationFn:t=>M(`/api/apps/${encodeURIComponent(e)}/update-scopes`,{artifact_name:t.artifactName,scopes:t.scopes}),onSuccess:()=>{t.invalidateQueries({queryKey:["apps",e]}),C.toast.success("Scopes updated")},onError:e=>C.toast.error(e.message)})}function Y(){return v({queryKey:["scan-history"],queryFn:()=>j("/api/scan/history")})}function J(){return v({queryKey:["audit-log"],queryFn:()=>j("/api/audit-log")})}function V(){return v({queryKey:["settings"],queryFn:()=>j("/api/settings")})}function G(){let e=(0,p.useQueryClient)();return w({mutationFn:e=>T("/api/settings",e),onSuccess:()=>{e.invalidateQueries({queryKey:["settings"]}),C.toast.success("Settings updated")},onError:e=>C.toast.error(e.message)})}function Z(){return w({mutationFn:e=>M("/api/chat",{message:e}),onError:e=>C.toast.error(e.message)})}e.s(["useAppDetail",()=>X,"useArtifacts",()=>P,"useAuditLog",()=>J,"useBulkRemediate",()=>k,"useCaseDetail",()=>O,"useCases",()=>D,"useChatMutation",()=>Z,"useCreateCaseFromEmployee",()=>q,"useDashboard",()=>Q,"useEmployeeDetail",()=>U,"useEmployees",()=>W,"useFindings",()=>A,"useGlobalAppRemoval",()=>z,"useOAuthApps",()=>H,"useRemediateArtifacts",()=>K,"useRemediation",()=>F,"useRestoreAppForUsers",()=>$,"useRevokeAppForUsers",()=>L,"useRevokeEmployeeAccess",()=>_,"useRunScheduledRemediation",()=>I,"useScanHistory",()=>Y,"useSettings",()=>V,"useSystemScan",()=>N,"useTriggerScan",()=>E,"useUpdateScopes",()=>B,"useUpdateSettings",()=>G],90472)},87486,e=>{"use strict";var t=e.i(43476),r=e.i(25913),s=e.i(86011),a=e.i(75157);let n=(0,r.cva)("inline-flex items-center justify-center rounded-full border border-transparent px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border-border text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",ghost:"[a&]:hover:bg-accent [a&]:hover:text-accent-foreground",link:"text-primary underline-offset-4 [a&]:hover:underline"}},defaultVariants:{variant:"default"}});function i({className:e,variant:r="default",asChild:i=!1,...o}){let u=i?s.Slot.Root:"span";return(0,t.jsx)(u,{"data-slot":"badge","data-variant":r,className:(0,a.cn)(n({variant:r}),e),...o})}e.s(["Badge",()=>i])},84774,e=>{"use strict";var t=e.i(43476),r=e.i(75157);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,r.cn)("w-full caption-bottom text-sm",e),...s})})}function a({className:e,...s}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,r.cn)("[&_tr]:border-b",e),...s})}function n({className:e,...s}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,r.cn)("[&_tr:last-child]:border-0",e),...s})}function i({className:e,...s}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,r.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...s})}function o({className:e,...s}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,r.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function u({className:e,...s}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,r.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}e.s(["Table",()=>s,"TableBody",()=>n,"TableCell",()=>u,"TableHead",()=>o,"TableHeader",()=>a,"TableRow",()=>i])},77241,34662,e=>{"use strict";let t=Symbol.for("constructDateFrom");function r(e,r){return"function"==typeof e?e(r):e&&"object"==typeof e&&t in e?e[t](r):e instanceof Date?new e.constructor(r):new Date(r)}e.s(["constructFromSymbol",0,t,"millisecondsInDay",0,864e5,"millisecondsInWeek",0,6048e5,"minutesInDay",0,1440,"minutesInMonth",0,43200],34662),e.s(["constructFrom",()=>r],77241)},55545,55024,e=>{"use strict";var t;let r={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function s(e){return (t={})=>{let r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}let a={date:s({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:s({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:s({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},n={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function i(e){return(t,r)=>{let s;if("formatting"===(r?.context?String(r.context):"standalone")&&e.formattingValues){let t=e.defaultFormattingWidth||e.defaultWidth,a=r?.width?String(r.width):t;s=e.formattingValues[a]||e.formattingValues[t]}else{let t=e.defaultWidth,a=r?.width?String(r.width):e.defaultWidth;s=e.values[a]||e.values[t]}return s[e.argumentCallback?e.argumentCallback(t):t]}}let o={ordinalNumber:(e,t)=>{let r=Number(e),s=r%100;if(s>20||s<10)switch(s%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:i({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:i({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:i({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:i({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:i({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function u(e){return(t,r={})=>{let s,a=r.width,n=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],i=t.match(n);if(!i)return null;let o=i[0],u=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(u)?function(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}(u,e=>e.test(o)):function(e,t){for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}(u,e=>e.test(o));return s=e.valueCallback?e.valueCallback(l):l,{value:s=r.valueCallback?r.valueCallback(s):s,rest:t.slice(o.length)}}}let l={ordinalNumber:(t={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,r={})=>{let s=e.match(t.matchPattern);if(!s)return null;let a=s[0],n=e.match(t.parsePattern);if(!n)return null;let i=t.valueCallback?t.valueCallback(n[0]):n[0];return{value:i=r.valueCallback?r.valueCallback(i):i,rest:e.slice(a.length)}}),era:u({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:u({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:u({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:u({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:u({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};e.s(["defaultLocale",0,{code:"en-US",formatDistance:(e,t,s)=>{let a,n=r[e];if(a="string"==typeof n?n:1===t?n.one:n.other.replace("{{count}}",t.toString()),s?.addSuffix)if(s.comparison&&s.comparison>0)return"in "+a;else return a+" ago";return a},formatLong:a,formatRelative:(e,t,r,s)=>n[e],localize:o,match:l,options:{weekStartsOn:0,firstWeekContainsDate:1}}],55545);let c={};function d(){return c}e.s(["getDefaultOptions",()=>d],55024)},99151,81092,45110,e=>{"use strict";var t=e.i(77241);function r(e,r){return(0,t.constructFrom)(r||e,e)}function s(e){let t=r(e),s=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return s.setUTCFullYear(t.getFullYear()),e-s}function a(e,...r){let s=t.constructFrom.bind(null,e||r.find(e=>"object"==typeof e));return r.map(s)}e.s(["toDate",()=>r],81092),e.s(["getTimezoneOffsetInMilliseconds",()=>s],99151),e.s(["normalizeDates",()=>a],45110)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},50554,e=>{"use strict";var t=e.i(43476),r=e.i(90472),s=e.i(15288),a=e.i(87486),n=e.i(84774),i=e.i(31278),o=e.i(55436);let u=(0,e.i(75254).default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);var l=e.i(78894),c=e.i(27516),d=e.i(22016),h=e.i(77241),m=e.i(55545),f=e.i(55024),p=e.i(99151),y=e.i(45110),g=e.i(81092);function b(e,t){let r=(0,g.toDate)(e)-(0,g.toDate)(t);return r<0?-1:r>0?1:r}var v=e.i(34662);function x(){let{data:e,isLoading:x}=(0,r.useScanHistory)();if(x)return(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)(i.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})});let R=e?.length??0,S=e?.filter(e=>"manual"===e.trigger).length??0,w=e?.filter(e=>"automatic"===e.trigger).length??0,C=e?.filter(e=>(e.open_findings??0)>0||(e.active_artifacts??0)>0).length??0;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Scan History"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"History of all scan runs and their results"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsx)(s.Card,{children:(0,t.jsx)(s.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c.History,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:R}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Scans"})]})]})})}),(0,t.jsx)(s.Card,{children:(0,t.jsx)(s.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.Search,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:S}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manual"})]})]})})}),(0,t.jsx)(s.Card,{children:(0,t.jsx)(s.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:w}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Automatic"})]})]})})}),(0,t.jsx)(s.Card,{children:(0,t.jsx)(s.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.AlertTriangle,{className:"h-5 w-5 text-destructive"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:C}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Found Issues"})]})]})})})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsx)(s.CardHeader,{children:(0,t.jsx)(s.CardTitle,{className:"text-base",children:"Scan Runs"})}),(0,t.jsx)(s.CardContent,{children:(0,t.jsxs)(n.Table,{children:[(0,t.jsx)(n.TableHeader,{children:(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableHead,{children:"Time"}),(0,t.jsx)(n.TableHead,{children:"Case"}),(0,t.jsx)(n.TableHead,{children:"Email"}),(0,t.jsx)(n.TableHead,{children:"Trigger"}),(0,t.jsx)(n.TableHead,{children:"Result"}),(0,t.jsx)(n.TableHead,{children:"Status"}),(0,t.jsx)(n.TableHead,{children:"Artifacts"}),(0,t.jsx)(n.TableHead,{children:"Findings"})]})}),(0,t.jsx)(n.TableBody,{children:e?.map(e=>{var r,s;return(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableCell,{children:(r=new Date(e.started_at),s={addSuffix:!0},function(e,t,r){var s;let a,n=(0,f.getDefaultOptions)(),i=r?.locale??n.locale??m.defaultLocale,o=b(e,t);if(isNaN(o))throw RangeError("Invalid time value");let u=Object.assign({},r,{addSuffix:r?.addSuffix,comparison:o}),[l,c]=(0,y.normalizeDates)(r?.in,...o>0?[t,e]:[e,t]),d=(s=void 0,e=>{let t=(s?Math[s]:Math.trunc)(e);return 0===t?0:t})(((0,g.toDate)(c)-(0,g.toDate)(l))/1e3),h=Math.round((d-((0,p.getTimezoneOffsetInMilliseconds)(c)-(0,p.getTimezoneOffsetInMilliseconds)(l))/1e3)/60);if(h<2)if(r?.includeSeconds)if(d<5)return i.formatDistance("lessThanXSeconds",5,u);else if(d<10)return i.formatDistance("lessThanXSeconds",10,u);else if(d<20)return i.formatDistance("lessThanXSeconds",20,u);else if(d<40)return i.formatDistance("halfAMinute",0,u);else if(d<60)return i.formatDistance("lessThanXMinutes",1,u);else return i.formatDistance("xMinutes",1,u);else if(0===h)return i.formatDistance("lessThanXMinutes",1,u);else return i.formatDistance("xMinutes",h,u);if(h<45)return i.formatDistance("xMinutes",h,u);if(h<90)return i.formatDistance("aboutXHours",1,u);if(h<v.minutesInDay){let e=Math.round(h/60);return i.formatDistance("aboutXHours",e,u)}if(h<2520)return i.formatDistance("xDays",1,u);else if(h<v.minutesInMonth){let e=Math.round(h/v.minutesInDay);return i.formatDistance("xDays",e,u)}else if(h<2*v.minutesInMonth)return a=Math.round(h/v.minutesInMonth),i.formatDistance("aboutXMonths",a,u);if((a=function(e,t,r){var s,a;let n,i,o,u,[l,c,d]=(0,y.normalizeDates)(void 0,e,e,t),h=b(c,d),m=Math.abs(function(e,t,r){let[s,a]=(0,y.normalizeDates)(void 0,e,t);return 12*(s.getFullYear()-a.getFullYear())+(s.getMonth()-a.getMonth())}(c,d));if(m<1)return 0;1===c.getMonth()&&c.getDate()>27&&c.setDate(30),c.setMonth(c.getMonth()-h*m);let f=b(c,d)===-h;+(n=(0,g.toDate)(l,void 0),s=void 0,(i=(0,g.toDate)(n,s?.in)).setHours(23,59,59,999),i)==+(a=void 0,u=(o=(0,g.toDate)(n,a?.in)).getMonth(),o.setFullYear(o.getFullYear(),u+1,0),o.setHours(23,59,59,999),o)&&1===m&&1===b(l,d)&&(f=!1);let p=h*(m-f);return 0===p?0:p}(c,l))<12){let e=Math.round(h/v.minutesInMonth);return i.formatDistance("xMonths",e,u)}{let e=a%12,t=Math.trunc(a/12);return e<3?i.formatDistance("aboutXYears",t,u):e<9?i.formatDistance("overXYears",t,u):i.formatDistance("almostXYears",t+1,u)}}(r,(0,h.constructFrom)(r,Date.now()),s))}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(d.default,{href:`/cases/${e.case}`,className:"text-primary hover:underline",children:e.case})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(d.default,{href:`/employees?email=${encodeURIComponent(e.target_email)}`,className:"text-primary hover:underline",children:e.target_email})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(a.Badge,{variant:"manual"===e.trigger?"default":"secondary",children:e.trigger})}),(0,t.jsx)(n.TableCell,{children:e.result}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(a.Badge,{variant:"secondary",children:e.new_status??"-"})}),(0,t.jsx)(n.TableCell,{children:e.active_artifacts??0}),(0,t.jsx)(n.TableCell,{children:e.findings_link?(0,t.jsx)(d.default,{href:e.findings_link,className:"text-primary hover:underline",children:e.open_findings??0}):e.open_findings??0})]},e.scan_id)})})]})})]})]})}e.s(["default",()=>x],50554)}]);