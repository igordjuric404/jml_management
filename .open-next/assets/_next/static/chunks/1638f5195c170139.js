(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var t=e.i(43476),s=e.i(75157);function r({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...r})}function a({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...r})}function i({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",e),...r})}function n({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",e),...r})}function o({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",e),...r})}e.s(["Card",()=>r,"CardContent",()=>o,"CardDescription",()=>n,"CardHeader",()=>a,"CardTitle",()=>i])},31278,e=>{"use strict";var t=e.i(17521);e.s(["Loader2",()=>t.default])},90472,e=>{"use strict";let t;var s=e.i(75555),r=e.i(40143),a=e.i(86491),i=e.i(15823),n=e.i(93803),o=e.i(19273),u=e.i(80166),l=class extends i.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#s=(0,n.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#r=void 0;#a=void 0;#i=void 0;#n;#o;#s;#t;#u;#l;#c;#d;#h;#p;#y=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#r.addObserver(this),c(this.#r,this.options)?this.#f():this.updateResult(),this.#m())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return d(this.#r,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return d(this.#r,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#v(),this.#r.removeObserver(this)}setOptions(e){let t=this.options,s=this.#r;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,o.resolveEnabled)(this.options.enabled,this.#r))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#g(),this.#r.setOptions(this.options),t._defaulted&&!(0,o.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#r,observer:this});let r=this.hasListeners();r&&h(this.#r,s,this.options,t)&&this.#f(),this.updateResult(),r&&(this.#r!==s||(0,o.resolveEnabled)(this.options.enabled,this.#r)!==(0,o.resolveEnabled)(t.enabled,this.#r)||(0,o.resolveStaleTime)(this.options.staleTime,this.#r)!==(0,o.resolveStaleTime)(t.staleTime,this.#r))&&this.#x();let a=this.#R();r&&(this.#r!==s||(0,o.resolveEnabled)(this.options.enabled,this.#r)!==(0,o.resolveEnabled)(t.enabled,this.#r)||a!==this.#p)&&this.#C(a)}getOptimisticResult(e){var t,s;let r=this.#e.getQueryCache().build(this.#e,e),a=this.createResult(r,e);return t=this,s=a,(0,o.shallowEqualObjects)(t.getCurrentResult(),s)||(this.#i=a,this.#o=this.options,this.#n=this.#r.state),a}getCurrentResult(){return this.#i}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),t?.(s),"promise"===s&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#s.status||this.#s.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,s))})}trackProp(e){this.#y.add(e)}getCurrentQuery(){return this.#r}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),s=this.#e.getQueryCache().build(this.#e,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#f({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#f(e){this.#g();let t=this.#r.fetch(this.options,e);return e?.throwOnError||(t=t.catch(o.noop)),t}#x(){this.#b();let e=(0,o.resolveStaleTime)(this.options.staleTime,this.#r);if(o.isServer||this.#i.isStale||!(0,o.isValidTimeout)(e))return;let t=(0,o.timeUntilStale)(this.#i.dataUpdatedAt,e);this.#d=u.timeoutManager.setTimeout(()=>{this.#i.isStale||this.updateResult()},t+1)}#R(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#r):this.options.refetchInterval)??!1}#C(e){this.#v(),this.#p=e,!o.isServer&&!1!==(0,o.resolveEnabled)(this.options.enabled,this.#r)&&(0,o.isValidTimeout)(this.#p)&&0!==this.#p&&(this.#h=u.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||s.focusManager.isFocused())&&this.#f()},this.#p))}#m(){this.#x(),this.#C(this.#R())}#b(){this.#d&&(u.timeoutManager.clearTimeout(this.#d),this.#d=void 0)}#v(){this.#h&&(u.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let s,r=this.#r,i=this.options,u=this.#i,l=this.#n,d=this.#o,y=e!==r?e.state:this.#a,{state:f}=e,m={...f},b=!1;if(t._optimisticResults){let s=this.hasListeners(),n=!s&&c(e,t),o=s&&h(e,r,t,i);(n||o)&&(m={...m,...(0,a.fetchState)(f.data,e.options)}),"isRestoring"===t._optimisticResults&&(m.fetchStatus="idle")}let{error:v,errorUpdatedAt:g,status:x}=m;s=m.data;let R=!1;if(void 0!==t.placeholderData&&void 0===s&&"pending"===x){let e;u?.isPlaceholderData&&t.placeholderData===d?.placeholderData?(e=u.data,R=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#c?.state.data,this.#c):t.placeholderData,void 0!==e&&(x="success",s=(0,o.replaceData)(u?.data,e,t),b=!0)}if(t.select&&void 0!==s&&!R)if(u&&s===l?.data&&t.select===this.#u)s=this.#l;else try{this.#u=t.select,s=t.select(s),s=(0,o.replaceData)(u?.data,s,t),this.#l=s,this.#t=null}catch(e){this.#t=e}this.#t&&(v=this.#t,s=this.#l,g=Date.now(),x="error");let C="fetching"===m.fetchStatus,j="pending"===x,Q="error"===x,T=j&&C,S=void 0!==s,O={status:x,fetchStatus:m.fetchStatus,isPending:j,isSuccess:"success"===x,isError:Q,isInitialLoading:T,isLoading:T,data:s,dataUpdatedAt:m.dataUpdatedAt,error:v,errorUpdatedAt:g,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>y.dataUpdateCount||m.errorUpdateCount>y.errorUpdateCount,isFetching:C,isRefetching:C&&!j,isLoadingError:Q&&!S,isPaused:"paused"===m.fetchStatus,isPlaceholderData:b,isRefetchError:Q&&S,isStale:p(e,t),refetch:this.refetch,promise:this.#s,isEnabled:!1!==(0,o.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=void 0!==O.data,s="error"===O.status&&!t,a=e=>{s?e.reject(O.error):t&&e.resolve(O.data)},i=()=>{a(this.#s=O.promise=(0,n.pendingThenable)())},o=this.#s;switch(o.status){case"pending":e.queryHash===r.queryHash&&a(o);break;case"fulfilled":(s||O.data!==o.value)&&i();break;case"rejected":s&&O.error===o.reason||i()}}return O}updateResult(){let e=this.#i,t=this.createResult(this.#r,this.options);if(this.#n=this.#r.state,this.#o=this.options,void 0!==this.#n.data&&(this.#c=this.#r),(0,o.shallowEqualObjects)(t,e))return;this.#i=t;let s=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!this.#y.size)return!0;let r=new Set(s??this.#y);return this.options.throwOnError&&r.add("error"),Object.keys(this.#i).some(t=>this.#i[t]!==e[t]&&r.has(t))};this.#j({listeners:s()})}#g(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#r)return;let t=this.#r;this.#r=e,this.#a=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#m()}#j(e){r.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#r,type:"observerResultsUpdated"})})}};function c(e,t){return!1!==(0,o.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&d(e,t,t.refetchOnMount)}function d(e,t,s){if(!1!==(0,o.resolveEnabled)(t.enabled,e)&&"static"!==(0,o.resolveStaleTime)(t.staleTime,e)){let r="function"==typeof s?s(e):s;return"always"===r||!1!==r&&p(e,t)}return!1}function h(e,t,s,r){return(e!==t||!1===(0,o.resolveEnabled)(r.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&p(e,s)}function p(e,t){return!1!==(0,o.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,o.resolveStaleTime)(t.staleTime,e))}e.i(47167);var y=e.i(71645),f=e.i(12598);e.i(43476);var m=y.createContext((t=!1,{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t})),b=y.createContext(!1);b.Provider;var v=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function g(e,t){return function(e,t,s){let a,i=y.useContext(b),n=y.useContext(m),u=(0,f.useQueryClient)(s),l=u.defaultQueryOptions(e);u.getDefaultOptions().queries?._experimental_beforeQuery?.(l);let c=u.getQueryCache().get(l.queryHash);if(l._optimisticResults=i?"isRestoring":"optimistic",l.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=l.staleTime;l.staleTime="function"==typeof t?(...s)=>e(t(...s)):e(t),"number"==typeof l.gcTime&&(l.gcTime=Math.max(l.gcTime,1e3))}a=c?.state.error&&"function"==typeof l.throwOnError?(0,o.shouldThrowError)(l.throwOnError,[c.state.error,c]):l.throwOnError,(l.suspense||l.experimental_prefetchInRender||a)&&!n.isReset()&&(l.retryOnMount=!1),y.useEffect(()=>{n.clearReset()},[n]);let d=!u.getQueryCache().get(l.queryHash),[h]=y.useState(()=>new t(u,l)),p=h.getOptimisticResult(l),g=!i&&!1!==e.subscribed;if(y.useSyncExternalStore(y.useCallback(e=>{let t=g?h.subscribe(r.notifyManager.batchCalls(e)):o.noop;return h.updateResult(),t},[h,g]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),y.useEffect(()=>{h.setOptions(l)},[l,h]),l?.suspense&&p.isPending)throw v(l,h,n);if((({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(a&&void 0===e.data||(0,o.shouldThrowError)(s,[e.error,r])))({result:p,errorResetBoundary:n,throwOnError:l.throwOnError,query:c,suspense:l.suspense}))throw p.error;if(u.getDefaultOptions().queries?._experimental_afterQuery?.(l,p),l.experimental_prefetchInRender&&!o.isServer&&p.isLoading&&p.isFetching&&!i){let e=d?v(l,h,n):c?.promise;e?.catch(o.noop).finally(()=>{h.updateResult()})}return l.notifyOnChangeProps?p:h.trackResult(p)}(e,l,t)}var x=e.i(14272),R=i,C=class extends R.Subscribable{#e;#i=void 0;#Q;#T;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#S()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,o.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#Q,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.hashKey)(t.mutationKey)!==(0,o.hashKey)(this.options.mutationKey)?this.reset():this.#Q?.state.status==="pending"&&this.#Q.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#Q?.removeObserver(this)}onMutationUpdate(e){this.#S(),this.#j(e)}getCurrentResult(){return this.#i}reset(){this.#Q?.removeObserver(this),this.#Q=void 0,this.#S(),this.#j()}mutate(e,t){return this.#T=t,this.#Q?.removeObserver(this),this.#Q=this.#e.getMutationCache().build(this.#e,this.options),this.#Q.addObserver(this),this.#Q.execute(e)}#S(){let e=this.#Q?.state??(0,x.getDefaultState)();this.#i={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#j(e){r.notifyManager.batch(()=>{if(this.#T&&this.hasListeners()){let t=this.#i.variables,s=this.#i.context,r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#T.onSuccess?.(e.data,t,s,r)}catch(e){Promise.reject(e)}try{this.#T.onSettled?.(e.data,null,t,s,r)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#T.onError?.(e.error,t,s,r)}catch(e){Promise.reject(e)}try{this.#T.onSettled?.(void 0,e.error,t,s,r)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#i)})})}};function j(e,t){let s=(0,f.useQueryClient)(t),[a]=y.useState(()=>new C(s,e));y.useEffect(()=>{a.setOptions(e)},[a,e]);let i=y.useSyncExternalStore(y.useCallback(e=>a.subscribe(r.notifyManager.batchCalls(e)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),n=y.useCallback((e,t)=>{a.mutate(e,t).catch(o.noop)},[a]);if(i.error&&(0,o.shouldThrowError)(a.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:n,mutateAsync:i.mutate}}var Q=e.i(46696);async function T(e,t){let s=await fetch(e,t),r=await s.json();if("error"===r.status)throw Error(r.error||"API error");return r.data}async function S(e,t){return T(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}async function O(e,t){return T(e,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}function w(){return g({queryKey:["dashboard"],queryFn:()=>T("/api/dashboard")})}function E(){return g({queryKey:["cases"],queryFn:()=>T("/api/cases")})}function q(e){return g({queryKey:["cases",e],queryFn:()=>T(`/api/cases/${e}`),enabled:!!e})}function _(){let e=(0,f.useQueryClient)();return j({mutationFn:e=>S("/api/cases/from-employee",{employee_id:e}),onSuccess:()=>{e.invalidateQueries({queryKey:["cases"]}),e.invalidateQueries({queryKey:["dashboard"]}),e.invalidateQueries({queryKey:["employees"]}),Q.toast.success("Case created from employee")},onError:e=>Q.toast.error(e.message)})}function k(e){let t=(0,f.useQueryClient)();return j({mutationFn:()=>S(`/api/cases/${e}/scan`,{}),onSuccess:()=>{t.invalidateQueries({queryKey:["cases",e]}),t.invalidateQueries({queryKey:["dashboard"]}),Q.toast.success("Scan triggered")},onError:e=>Q.toast.error(e.message)})}function I(e){let t=(0,f.useQueryClient)();return j({mutationFn:t=>S(`/api/cases/${e}/remediate`,t),onSuccess:s=>{t.invalidateQueries({queryKey:["cases"]}),t.invalidateQueries({queryKey:["cases",e]}),t.invalidateQueries({queryKey:["dashboard"]}),Q.toast.success(`Remediation completed: ${s.artifacts_remediated||s.revoked||s.deleted||0} item(s)`)},onError:e=>Q.toast.error(e.message)})}function F(e){let t=(0,f.useQueryClient)();return j({mutationFn:()=>S(`/api/cases/${e}/scheduled-remediation`,{}),onSuccess:()=>{t.invalidateQueries({queryKey:["cases",e]}),t.invalidateQueries({queryKey:["cases"]}),t.invalidateQueries({queryKey:["dashboard"]}),Q.toast.success("Scheduled remediation completed")},onError:e=>Q.toast.error(e.message)})}function K(e){let t=(0,f.useQueryClient)();return j({mutationFn:t=>S(`/api/cases/${e}/bulk-remediate`,{artifact_names:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["cases",e]}),t.invalidateQueries({queryKey:["cases"]}),t.invalidateQueries({queryKey:["dashboard"]}),Q.toast.success("Bulk remediation completed")},onError:e=>Q.toast.error(e.message)})}function N(){let e=(0,f.useQueryClient)();return j({mutationFn:()=>S("/api/scan",{}),onSuccess:()=>{e.invalidateQueries({queryKey:["dashboard"]}),e.invalidateQueries({queryKey:["cases"]}),Q.toast.success("System scan queued")},onError:e=>Q.toast.error(e.message)})}function M(e){let t=new URLSearchParams(e);return g({queryKey:["artifacts",e],queryFn:()=>T(`/api/artifacts?${t.toString()}`)})}function A(){let e=(0,f.useQueryClient)();return j({mutationFn:e=>S("/api/artifacts",{docnames:e}),onSuccess:()=>{e.invalidateQueries({queryKey:["artifacts"]}),e.invalidateQueries({queryKey:["cases"]}),e.invalidateQueries({queryKey:["dashboard"]}),Q.toast.success("Artifacts remediated")},onError:e=>Q.toast.error(e.message)})}function U(e){let t=new URLSearchParams(e);return g({queryKey:["findings",e],queryFn:()=>T(`/api/findings?${t.toString()}`)})}function D(){return g({queryKey:["employees"],queryFn:()=>T("/api/employees")})}function P(e){return g({queryKey:["employees",e],queryFn:()=>T(`/api/employees/${e}`),enabled:!!e})}function H(e){let t=(0,f.useQueryClient)();return j({mutationFn:t=>S(`/api/employees/${e}/revoke`,{scope:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["employees"]}),t.invalidateQueries({queryKey:["dashboard"]}),Q.toast.success("Employee access revoked")},onError:e=>Q.toast.error(e.message)})}function L(){return g({queryKey:["apps"],queryFn:()=>T("/api/apps")})}function $(e){return g({queryKey:["apps",e],queryFn:()=>T(`/api/apps/${encodeURIComponent(e)}`),enabled:!!e})}function B(){let e=(0,f.useQueryClient)();return j({mutationFn:e=>S(`/api/apps/${encodeURIComponent(e.clientId)}/global-remove`,{app_name:e.appName}),onSuccess:()=>{e.invalidateQueries({queryKey:["apps"]}),e.invalidateQueries({queryKey:["dashboard"]}),Q.toast.success("App globally revoked")},onError:e=>Q.toast.error(e.message)})}function z(e){let t=(0,f.useQueryClient)();return j({mutationFn:t=>S(`/api/apps/${encodeURIComponent(e)}/revoke-users`,{artifact_names:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["apps",e]}),t.invalidateQueries({queryKey:["dashboard"]}),Q.toast.success("App revoked for selected users")},onError:e=>Q.toast.error(e.message)})}function G(e){let t=(0,f.useQueryClient)();return j({mutationFn:t=>S(`/api/apps/${encodeURIComponent(e)}/restore-users`,{artifact_names:t}),onSuccess:()=>{t.invalidateQueries({queryKey:["apps",e]}),t.invalidateQueries({queryKey:["dashboard"]}),Q.toast.success("App restored for selected users")},onError:e=>Q.toast.error(e.message)})}function W(e){let t=(0,f.useQueryClient)();return j({mutationFn:t=>S(`/api/apps/${encodeURIComponent(e)}/update-scopes`,{artifact_name:t.artifactName,scopes:t.scopes}),onSuccess:()=>{t.invalidateQueries({queryKey:["apps",e]}),Q.toast.success("Scopes updated")},onError:e=>Q.toast.error(e.message)})}function V(){return g({queryKey:["scan-history"],queryFn:()=>T("/api/scan/history")})}function J(){return g({queryKey:["audit-log"],queryFn:()=>T("/api/audit-log")})}function X(){return g({queryKey:["settings"],queryFn:()=>T("/api/settings")})}function Y(){let e=(0,f.useQueryClient)();return j({mutationFn:e=>O("/api/settings",e),onSuccess:()=>{e.invalidateQueries({queryKey:["settings"]}),Q.toast.success("Settings updated")},onError:e=>Q.toast.error(e.message)})}function Z(){return j({mutationFn:e=>S("/api/chat",{message:e}),onError:e=>Q.toast.error(e.message)})}e.s(["useAppDetail",()=>$,"useArtifacts",()=>M,"useAuditLog",()=>J,"useBulkRemediate",()=>K,"useCaseDetail",()=>q,"useCases",()=>E,"useChatMutation",()=>Z,"useCreateCaseFromEmployee",()=>_,"useDashboard",()=>w,"useEmployeeDetail",()=>P,"useEmployees",()=>D,"useFindings",()=>U,"useGlobalAppRemoval",()=>B,"useOAuthApps",()=>L,"useRemediateArtifacts",()=>A,"useRemediation",()=>I,"useRestoreAppForUsers",()=>G,"useRevokeAppForUsers",()=>z,"useRevokeEmployeeAccess",()=>H,"useRunScheduledRemediation",()=>F,"useScanHistory",()=>V,"useSettings",()=>X,"useSystemScan",()=>N,"useTriggerScan",()=>k,"useUpdateScopes",()=>W,"useUpdateSettings",()=>Y],90472)},87486,e=>{"use strict";var t=e.i(43476),s=e.i(25913),r=e.i(86011),a=e.i(75157);let i=(0,s.cva)("inline-flex items-center justify-center rounded-full border border-transparent px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border-border text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",ghost:"[a&]:hover:bg-accent [a&]:hover:text-accent-foreground",link:"text-primary underline-offset-4 [a&]:hover:underline"}},defaultVariants:{variant:"default"}});function n({className:e,variant:s="default",asChild:n=!1,...o}){let u=n?r.Slot.Root:"span";return(0,t.jsx)(u,{"data-slot":"badge","data-variant":s,className:(0,a.cn)(i({variant:s}),e),...o})}e.s(["Badge",()=>n])},84774,e=>{"use strict";var t=e.i(43476),s=e.i(75157);function r({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",e),...r})})}function a({className:e,...r}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",e),...r})}function i({className:e,...r}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",e),...r})}function n({className:e,...r}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...r})}function o({className:e,...r}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}function u({className:e,...r}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}e.s(["Table",()=>r,"TableBody",()=>i,"TableCell",()=>u,"TableHead",()=>o,"TableHeader",()=>a,"TableRow",()=>n])},70756,e=>{"use strict";let t=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],70756)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},27671,e=>{"use strict";var t=e.i(43476),s=e.i(90472),r=e.i(15288),a=e.i(19455),i=e.i(87486),n=e.i(84774),o=e.i(78894),u=e.i(75505),l=e.i(61911),c=e.i(95444),d=e.i(27516),h=e.i(78583),p=e.i(55436);let y=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var f=e.i(31278),m=e.i(70756),b=e.i(22016);let v=[{label:"Offboarding Cases",href:"/cases",icon:u.FolderOpen},{label:"Employees",href:"/employees",icon:l.Users},{label:"Access Artifacts",href:"/artifacts",icon:m.Lock},{label:"Findings",href:"/findings",icon:o.AlertTriangle},{label:"OAuth Apps",href:"/apps",icon:c.Grid3X3},{label:"Scan History",href:"/scan-history",icon:d.History},{label:"Audit Log",href:"/audit-log",icon:h.FileText}];function g(){let{data:e,isLoading:o,refetch:u}=(0,s.useDashboard)(),l=(0,s.useSystemScan)();if(o)return(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)(f.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})});let c=e?.kpis;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"OAuth Gap Monitor Dashboard"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Overview of access security posture"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(a.Button,{variant:"outline",size:"sm",onClick:()=>u(),children:[(0,t.jsx)(y,{className:"mr-2 h-4 w-4"}),"Refresh"]}),(0,t.jsxs)(a.Button,{size:"sm",onClick:()=>{confirm("Run a system-wide scan to discover new lingering access?")&&l.mutate()},disabled:l.isPending,children:[l.isPending?(0,t.jsx)(f.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,t.jsx)(p.Search,{className:"mr-2 h-4 w-4"}),"Scan System"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,t.jsx)(x,{label:"Pending Scan",value:c?.pending_scan,color:"blue",href:"/cases?status=Draft"}),(0,t.jsx)(x,{label:"Critical Gaps",value:c?.critical_gaps,color:"red",href:"/findings?severity=Critical"}),(0,t.jsx)(x,{label:"OAuth Grants (7d)",value:c?.oauth_grants_7d,color:"orange",href:"/artifacts?type=OAuthToken"}),(0,t.jsx)(x,{label:"OAuth Grants (30d)",value:c?.oauth_grants_30d,color:"yellow",href:"/artifacts?type=OAuthToken"}),(0,t.jsx)(x,{label:"Post-offboard Logins",value:c?.post_offboard_logins_7d,color:"red",href:"/findings?type=PostOffboardLogin"}),(0,t.jsx)(x,{label:"Total Cases",value:c?.total_cases,color:"gray",href:"/cases"})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{className:"text-base",children:"Quick Links"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-2",children:v.map(e=>(0,t.jsx)(b.default,{href:e.href,children:(0,t.jsxs)(a.Button,{variant:"outline",size:"sm",className:"w-full justify-start",children:[(0,t.jsx)(e.icon,{className:"mr-2 h-4 w-4"}),e.label]})},e.href))})})]}),e?.top_oauth_apps&&e.top_oauth_apps.length>0&&(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{className:"text-base",children:"Top Lingering OAuth Apps"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsxs)(n.Table,{children:[(0,t.jsx)(n.TableHeader,{children:(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableHead,{children:"App"}),(0,t.jsx)(n.TableHead,{children:"Client ID"}),(0,t.jsx)(n.TableHead,{className:"text-right",children:"Active Grants"}),(0,t.jsx)(n.TableHead,{})]})}),(0,t.jsx)(n.TableBody,{children:e.top_oauth_apps.map(e=>(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableCell,{className:"font-medium",children:(0,t.jsx)(b.default,{href:`/apps?client_id=${encodeURIComponent(e.client_id)}`,className:"hover:underline text-primary",children:e.app_display_name||"Unknown"})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)("code",{className:"text-xs",children:e.client_id?.substring(0,30)})}),(0,t.jsx)(n.TableCell,{className:"text-right font-bold",children:e.grant_count}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(b.default,{href:`/apps?client_id=${encodeURIComponent(e.client_id)}`,className:"text-sm text-primary hover:underline",children:"Details â†’"})})]},e.client_id))})]})})]}),e?.risky_cases&&e.risky_cases.length>0&&(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{className:"text-base",children:"Most Risky Cases"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsxs)(n.Table,{children:[(0,t.jsx)(n.TableHeader,{children:(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableHead,{children:"Case"}),(0,t.jsx)(n.TableHead,{children:"Email"}),(0,t.jsx)(n.TableHead,{children:"Employee"}),(0,t.jsx)(n.TableHead,{children:"Findings"}),(0,t.jsx)(n.TableHead,{children:"Critical"})]})}),(0,t.jsx)(n.TableBody,{children:e.risky_cases.map(e=>(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(b.default,{href:`/cases/${e.case_name}`,className:"text-primary hover:underline",children:e.case_name})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(b.default,{href:`/employees?email=${encodeURIComponent(e.primary_email)}`,className:"hover:underline",children:e.primary_email})}),(0,t.jsx)(n.TableCell,{children:e.employee_name?(0,t.jsx)(b.default,{href:`/employees?email=${encodeURIComponent(e.primary_email)}`,className:"hover:underline",children:e.employee_name}):"-"}),(0,t.jsx)(n.TableCell,{children:(0,t.jsxs)(b.default,{href:`/findings?case=${e.case_name}`,className:"hover:underline",children:[e.finding_count," finding(s)"]})}),(0,t.jsx)(n.TableCell,{children:(0,t.jsx)(i.Badge,{variant:e.critical_count>0?"destructive":"secondary",children:e.critical_count})})]},e.case_name))})]})})]})]})}function x({label:e,value:s,color:a,href:i}){return(0,t.jsx)(b.default,{href:i,children:(0,t.jsx)(r.Card,{className:"cursor-pointer hover:bg-accent/50 transition-colors",children:(0,t.jsxs)(r.CardContent,{className:"p-4 text-center",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:e}),(0,t.jsx)("p",{className:`text-2xl font-bold ${{blue:"text-blue-500",red:"text-red-500",orange:"text-orange-500",yellow:"text-yellow-500",gray:"text-muted-foreground",green:"text-green-500"}[a]||""}`,children:s??0})]})})})}e.s(["default",()=>g],27671)}]);